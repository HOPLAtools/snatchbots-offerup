// ==UserScript==
// @name         [DEV] Offerup Phones.Trade Bot
// @namespace    http://tampermonkey.net/
// @version      24.1127.737
// @description  try to take over the world!
// @author       You
// @match        https://offerup.com/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=offerup.com
// @grant        GM.getValue
// @grant        GM.setValue
// @grant        GM_addElement
// @grant        GM_addStyle
// @run-at document-end
// @require https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js
// @require https://cdnjs.cloudflare.com/ajax/libs/dialog-polyfill/0.5.6/dialog-polyfill.min.js
// @require https://code.getmdl.io/1.3.0/material.min.js
// @require https://cdn.trackjs.com/agent/v3/latest/t.js
// @require https://login.hopla.to/js/hopla-login.js
// @updateURL https://raw.githubusercontent.com/HOPLAtools/snatchbots-offerup/development/index.js
// @downloadURL https://raw.githubusercontent.com/HOPLAtools/snatchbots-offerup/development/index.js
// ==/UserScript==

(function() {
  'use strict';

  

/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={8927:(e,t)=>{async function n(){const e=function(){const e=window.location.href.match(/inbox\/message\/(\d+)/);if(e&&e.length>1)return e[1]}(),t=await async function(e){const t=await fetch("https://offerup.com/api/graphql",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9","content-type":"application/json","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36","sec-ch-ua":'"Google Chrome";v="93", " Not;A Brand";v="99", "Chromium";v="93"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkZvcnQgTGF1ZGVyZGFsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMzMyMlwiLFwibG9uZ2l0dWRlXCI6LTgwLjI3NjgsXCJsYXRpdHVkZVwiOjI2LjE0ODZ9In0.Tjhlca2iBpxc6-SCQFImXWks2GnHjXnczrLRnDDbXOo","x-ou-d-token":"web-052d0185d991b73f7eb7bd5fda75c0cfbbf2f95bb2f392f52630a64b","x-ou-f-token":"74e5e1d98ea7ec925d75f015a16b3f3c","x-request-id":"504b9a10-8d47-4c8e-afa1-6bfd89b94453"},referrer:`https://offerup.com/inbox/message/${e}?alertId=2890122750`,referrerPolicy:"strict-origin-when-cross-origin",body:`{"operationName":"GetChatById","variables":{"id":"${e}"},"query":"query GetChatById($id: String!, $before: String) {\\n  chat: discussion(data: {discussionId: $id, before: $before}) {\\n    itemId\\n    sellerId\\n    buyerId\\n    deactivatedUserId\\n    dateCreated\\n    lastPostDate\\n    readStatus {\\n      userId\\n      lastReadDate\\n      __typename\\n    }\\n    visualTags {\\n      tag\\n      type\\n      displayText\\n      __typename\\n    }\\n    messages {\\n      id\\n      recipientId\\n      senderId\\n      text\\n      sendDateString\\n      metadataType\\n      metadata {\\n        photos {\\n          small {\\n            url\\n            width\\n            height\\n            __typename\\n          }\\n          medium {\\n            url\\n            width\\n            height\\n            __typename\\n          }\\n          large {\\n            url\\n            width\\n            height\\n            __typename\\n          }\\n          __typename\\n        }\\n        messageUrl\\n        systemMessageContext {\\n          iconUrl\\n          actions {\\n            actionPath\\n            externalURL\\n            actionText\\n            __typename\\n          }\\n          titleText\\n          bodyText\\n          __typename\\n        }\\n        place {\\n          name\\n          formattedAddress\\n          placeId\\n          longitude\\n          latitude\\n          __typename\\n        }\\n        messageButtonText\\n        messageTitle\\n        __typename\\n      }\\n      __typename\\n    }\\n    listing {\\n      id\\n      listingId\\n      title\\n      price\\n      originalPrice\\n      isFirmOnPrice\\n      state\\n      category {\\n        id\\n        name\\n        levelOneName\\n        levelTwoName\\n        levelThreeName\\n        __typename\\n      }\\n      photos {\\n        uuid\\n        detail {\\n          url\\n          width\\n          height\\n          __typename\\n        }\\n        detailSquare {\\n          url\\n          width\\n          height\\n          __typename\\n        }\\n        __typename\\n      }\\n      fulfillmentDetails {\\n        buyItNowEnabled\\n        shippingEnabled\\n        localPickupEnabled\\n        shippingPrice\\n        estimatedDeliveryDateStart\\n        estimatedDeliveryDateEnd\\n        sellerPaysShipping\\n        shippingParcelId\\n        canShipToBuyer\\n        __typename\\n      }\\n      __typename\\n    }\\n    otherUserProfile {\\n      userId\\n      avatars {\\n        squareImage\\n        __typename\\n      }\\n      isTruyouVerified\\n      name\\n      dateJoined\\n      publicLocationName\\n      ratingSummary {\\n        count\\n        average\\n        __typename\\n      }\\n      c2cPhoneNumber {\\n        countryCode\\n        nationalNumber\\n        __typename\\n      }\\n      isAutosDealer\\n      isSubPrimeDealer\\n      isTruyouVerified\\n      websiteLink\\n      publicLocation {\\n        formattedAddress\\n        name\\n        latitude\\n        longitude\\n        __typename\\n      }\\n      __typename\\n    }\\n    otherUserRelationship {\\n      following\\n      blocked\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n"}`,method:"POST",mode:"cors",credentials:"include"}).then((e=>e.json()));return t&&t.data&&t.data.chat&&t.data.chat.itemId}(e);return t}window.getChatId=n,t.t=n},4484:(e,t,n)=>{"use strict";n.r(t),n.d(t,{_apiSendBug:()=>o});var i=n(2617),a=n(2287),s=n(4246);function o(e){const t=(new Date).getTime();e.log_id=t;try{e.email||(e.email=(0,i.getUserEmail)())}catch(e){console.error("failed to add email to log.")}return window.tabId&&(e.tabId=window.tabId),window.taEmail&&(e.partner_email=window.taEmail),e.extension_version=window.extension_version,async function t(n){return fetch("https://cloudlogging.hopla.workers.dev/log?function=offerupbot",{method:"POST",body:JSON.stringify(e),mode:"no-cors"}).then((async e=>(0,a.handleFetchErrors)(e))).then((e=>e.text())).catch((async e=>(console.error("Fetch Failed (_apiSendBug)",e,n),n&&n>6?"":(await(0,s.sleep)(1e4),n||(n=0),t(n+=1)))))}().catch((e=>(console.error("Fetch Failed (_apiSendBug)",e),"")))}},9088:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addAllUserListingsToSkipList:()=>o});var i=n(9217),a=n(3539),s=n(3613);async function o(e,t,n,o){const r=await(0,i.apiOfferUp)().getUserListings(e);if(r){const i=r.filter((e=>e.listingId)).map((e=>e.listingId));if(o){const e=i.indexOf(o);e>-1&&i.splice(e,1)}return(0,a.CONSOLE_MESSAGE)("custom",`Adding ${i.length} listings of ${t} (${e}) to skip list.`),(0,s.skips)().saveToSkipListingBatch(i,n)}}},9217:(e,t,n)=>{"use strict";n.r(t),n.d(t,{apiOfferUp:()=>h});var i=n(1203),a=n(3539),s=n(3177),o=n(4246),r=n(4484),l=n(2287),d=n(425),c=n(6849),u=n(7367);function p(e,t){return window.countDownId=Math.random(),m(e,t,window.countDownId),new Promise((t=>{window.countDownId="",setTimeout((()=>{t()}),1e3*e)}))}function m(e,t,n){window.isRun&&(e<=1||n===window.countDownId&&((new Date).getTime(),e<=1||setTimeout((()=>{m(e-1,t,n)}),1e3)))}var g=n(869);function h(e){return{sendMessage:async function(t,n,c,p,m){if(!n)return;if(!t)return;if(i.debug_disableMessages)return;let g=await async function e(i){return fetch("https://offerup.com/api/graphql",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0",Accept:"*/*","Accept-Language":"en-US,en;q=0.5","content-type":"application/json","x-ou-d-token":"web-8a263c39445e93084073408011803c17b413d18fa91fafb9f64f706f","x-ou-f-token":"6af29b25b551922205a90937fd164603",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkZvcnQgTGF1ZGVyZGFsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMzMyMlwiLFwibG9uZ2l0dWRlXCI6LTgwLjI3NjgsXCJsYXRpdHVkZVwiOjI2LjE0ODZ9In0.Tjhlca2iBpxc6-SCQFImXWks2GnHjXnczrLRnDDbXOo","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0","Proxy-Authorization":"Basic dHJhZGVhcHBsZXM6YXBwbGVzdHJhZGU2OQ=="},referrer:`https://offerup.com/item/detail/${t}`,body:`{"operationName":"StartChat","variables":{"listingId":"${t}","text":"${n}","suggestedMessageUuid":"8E8F653A-F693-476C-8E33-6DA990D81763"},"query":"mutation StartChat($listingId: ID!, $text: String!, $suggestedMessageUuid: String) {\\n  postFirstMessage(\\n    data: {itemId: $listingId, text: $text, suggestedMessageUuid: $suggestedMessageUuid}\\n  ) {\\n    id: discussionId\\n    __typename\\n  }\\n}\\n"}`,method:"POST",mode:"cors"}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).catch((async t=>(console.error("Fetch Failed (sendMessage)",t,i),i&&i>6?"":(await(0,d.retryDelayWithMessage)(`Failed to send message. API failed: ${t}`),i||(i=0),e(i+=1)))))}().catch((e=>(console.error("Fetch Failed",e),"")));if(!g)return"STOP-Failed to send message.";const{error:f,responseText:_}=await async function(e){if(!e)return{responseText:e};if(e&&e.includes("INTERNAL_SERVER_ERROR")){const e=60*(0,s.randomIntFromInterval)(i.botRetryDelay[0],i.botRetryDelay[1])*1e3,t=(new Date).getTime()+e;return(0,a.CONSOLE_MESSAGE)("timeout",{message:"Encountered INTERNAL_SERVER_ERROR.",hh:moment(t).format("HH"),mm:moment(t).format("mm"),ss:moment(t).format("ss")}),await(0,o.sleep)(t),{error:"internal-server-error"}}return e.match&&e.match(/currently serve areas outside of the US/i)?(console.error("Proxy Failed - Got Error: Currently serve areas outside of the US"),(0,a.CONSOLE_MESSAGE)("custom","Proxy Failed - Got Error: Currently serve areas outside of the US"),await(0,o.sleep)(6e4),{error:"proxy-failed"}):e.includes("Before you can send a message, please verify your mobile number")?(console.error("User is not verified. Requires mobile verification"),(0,a.CONSOLE_MESSAGE)("custom","User is not verified. Requires mobile verification"),await(0,o.sleep)(6e5),{error:"mobile-verification-required"}):e.includes("Verification Required")?(console.error("Verification required! Verify via app and restart the bot."),window.isKO=!0,(0,a.CONSOLE_MESSAGE)("custom","Verification required! Verify via app and restart the bot."),alert("Verification required! Verify via app and restart the bot."),await(0,o.sleep)(59994e4),window.isKO=!1,console.error("Failed to send message",e),(0,r._apiSendBug)({msg:"Failed to send message to user",apiresponse:e}),window.isKO=!0,await(0,o.sleep)(60*i.waitIfSpamDetected*1e3),window.isKO=!1,{error:"verification-required"}):{}}(g);if(f)return"";if(g&&g.includes("Conversation limit reached")){(0,u.stats)().addKo(),localStorage.setItem("tsSpamDetected",(new Date).getTime()+60*i.waitIfSpamDetected*1e3),console.error("Conversation limit has been reached.");const s=(new Date).getTime()+60*i.waitIfSpamDetected*1e3;if((0,a.CONSOLE_MESSAGE)("halted_soft",{hh:moment(s).format("HH"),mm:moment(s).format("mm"),ss:moment(s).format("ss")}),window.isKO=!0,await(0,o.sleep)(60*i.waitIfSpamDetected*1e3),window.isKO=!1,!window.isRun)return;if(e!==window.runningInstanceId)return;return h().sendMessage(t,n,c,p,m)}if(g&&g.includes("have blocked the other user in the thread"))return(0,a.CONSOLE_MESSAGE)("thread_removed",{listing_id:t,listing_name:c,owner_id:p,owner_name:m}),"STOP";if(g&&g.includes("looks like a recent message from you might violate our Community Guidelines."))return alert("BOT Paused! One of your template messages might have been flagged by OfferUp. Please check your messages and try again."),(0,a.CONSOLE_MESSAGE)("spam_detected",{listing_id:t,listing_name:c,owner_id:p,owner_name:m}),"STOP";if(g&&g.includes("user in this thread has been blocked by OfferUp"))return(0,a.CONSOLE_MESSAGE)("other_user_blocked_by_offerup",{listing_id:t,listing_name:c,owner_id:p,owner_name:m}),"STOP";if(g&&g.includes("errors"))console.error("Failed to send message",g),(0,r._apiSendBug)({msg:"Failed to send message to user",apiresponse:g}),window.isKO=!0,await(0,o.sleep)(60*i.waitIfSpamDetected*1e3),window.isKO=!1;else{if(g&&g.includes("postFirstMessage"))return g=JSON.parse(g),g.data.postFirstMessage.id;console.error("Unhandled sendmessage response",g),(0,r._apiSendBug)({msg:"Unhandled message response",apiresponse:g||""}),await(0,o.sleep)(60*i.waitIfSpamDetected*1e3)}},deleteMessageByChatId:async function(e,t){if(t||(t=0),e)return t&&console.log({error:`Successfully deleted conversation after ${t} retries.`,postResponseId}),async function t(n){return fetch("https://offerup.com/api/graphql",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9","content-type":"application/json","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36","sec-ch-ua":'" Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkZvcnQgTGF1ZGVyZGFsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMzMyMlwiLFwibG9uZ2l0dWRlXCI6LTgwLjI3NjgsXCJsYXRpdHVkZVwiOjI2LjE0ODZ9In0.Tjhlca2iBpxc6-SCQFImXWks2GnHjXnczrLRnDDbXOo","x-ou-d-token":"web-052d0185d991b73f7eb7bd5fda75c0cfbbf2f95bb2f392f52630a64b","x-ou-f-token":"74e5e1d98ea7ec925d75f015a16b3f3c","x-request-id":"9d22b385-ea56-4954-b533-89b7c6be1829"},referrer:"https://offerup.com/inbox",referrerPolicy:"strict-origin-when-cross-origin",body:`{"operationName":"ArchiveChats","variables":{"ids":["${e}"]},"query":"mutation ArchiveChats($ids: [String!]!) {\\n  archiveAlerts(alertIds: $ids)\\n}\\n"}`,method:"POST",mode:"cors",credentials:"include"}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).catch((async e=>(console.error("Fetch Failed (deleteMessage)",e,n),n&&n>6?"":(await(0,d.retryDelayWithMessage)(`Failed to delete message. API failed: ${e}`),n||(n=0),t(n+=1)))))}().then((e=>{if(e&&e.includes("archiveAlerts"))return!0})).catch((e=>(console.error("Fetch Failed",e),"")));console.error("chatId cannot be empty!",e)},deleteMessage:async function(e,t){t||(t=0);const n=await async function(){return await async function e(t){return fetch("https://offerup.com/api/graphql",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9","content-type":"application/json","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36","sec-ch-ua":'" Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkZvcnQgTGF1ZGVyZGFsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMzMyMlwiLFwibG9uZ2l0dWRlXCI6LTgwLjI3NjgsXCJsYXRpdHVkZVwiOjI2LjE0ODZ9In0.Tjhlca2iBpxc6-SCQFImXWks2GnHjXnczrLRnDDbXOo","x-ou-d-token":"web-052d0185d991b73f7eb7bd5fda75c0cfbbf2f95bb2f392f52630a64b","x-ou-f-token":"74e5e1d98ea7ec925d75f015a16b3f3c","x-request-id":"2b410a33-b5a6-455c-9093-a66e91d83e2d"},referrer:"https://offerup.com/item/detail/1236460483",referrerPolicy:"strict-origin-when-cross-origin",body:'{"operationName":"GetChats","variables":{},"query":"query GetChats {\\n  getChats: alertsWithAds(type: INBOX) {\\n    chats: alertsWithAds {\\n      ... on Alert {\\n        contentThumbnails\\n        id\\n        read\\n        seen\\n        type\\n        title\\n        notificationText\\n        dateAdded\\n        objectId\\n        visualTags {\\n          tag\\n          type\\n          displayText\\n          __typename\\n        }\\n        sender {\\n          id\\n          profile {\\n            firstName\\n            isTruyouVerified\\n            isAutosDealer\\n            avatars {\\n              squareImage\\n              __typename\\n            }\\n            notActive\\n            __typename\\n          }\\n          __typename\\n        }\\n        __typename\\n      }\\n      ... on BingAd {\\n        ouAdId\\n        itemName\\n        imageUrl\\n        sellerName\\n        price\\n        lowPrice\\n        impressionFeedbackUrl\\n        contentUrl\\n        adNetwork\\n        adExperimentId\\n        adRequestId\\n        experimentDataHash\\n        __typename\\n      }\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n"}',method:"POST",mode:"cors",credentials:"include"}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).catch((async n=>(console.error("Fetch Failed (getChatId)",n,t),t&&t>6?"":(await(0,d.retryDelayWithMessage)(`Failed to delete message message. API failed: ${n}`),t||(t=0),e(t+=1)))))}().then((async e=>{try{return e&&e.match&&e.match(/currently serve areas outside of the US/i)?{error:"Proxy Failed",error_code:"proxy-failed"}:JSON.parse(e)}catch(t){return await(0,c.Z)({error:"Failed to parse deleteMessage api response.",x:e}),{}}})).then((t=>{if(t&&"proxy-failed"===t.error_code)return console.error("Proxy Failed - Got Error: Currently serve areas outside of the US"),"";if(t&&t.data&&t.data.getChats&&t.data.getChats.chats)for(const n of t.data.getChats.chats)if(Number(n.objectId)===Number(e))return n.id}))}();return n?(t&&console.log({error:`Successfully deleted conversation after ${t} retries.`,postResponseId:e}),async function e(t){return fetch("https://offerup.com/api/graphql",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9","content-type":"application/json","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36","sec-ch-ua":'" Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkZvcnQgTGF1ZGVyZGFsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMzMyMlwiLFwibG9uZ2l0dWRlXCI6LTgwLjI3NjgsXCJsYXRpdHVkZVwiOjI2LjE0ODZ9In0.Tjhlca2iBpxc6-SCQFImXWks2GnHjXnczrLRnDDbXOo","x-ou-d-token":"web-052d0185d991b73f7eb7bd5fda75c0cfbbf2f95bb2f392f52630a64b","x-ou-f-token":"74e5e1d98ea7ec925d75f015a16b3f3c","x-request-id":"9d22b385-ea56-4954-b533-89b7c6be1829"},referrer:"https://offerup.com/inbox",referrerPolicy:"strict-origin-when-cross-origin",body:`{"operationName":"ArchiveChats","variables":{"ids":["${n}"]},"query":"mutation ArchiveChats($ids: [String!]!) {\\n  archiveAlerts(alertIds: $ids)\\n}\\n"}`,method:"POST",mode:"cors",credentials:"include"}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).catch((async n=>(console.error("Fetch Failed (deleteMessage)",n,t),t&&t>6?"":(await(0,d.retryDelayWithMessage)(`Failed to delete message. API failed: ${n}`),t||(t=0),e(t+=1)))))}().then((e=>{if(e&&e.includes("archiveAlerts"))return!0})).catch((e=>(console.error("Fetch Failed",e),"")))):(t+=1)<2?(await p(60,"Wait 60 seconds before retrying to delete conversation."),h().deleteMessage(e,t)):void console.error({error:"Failed to get chat id to delete after 5 retries.",postResponseId:e})},countConversations:async function(){try{async function e(t){return fetch("https://offerup.com/api/graphql",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9","content-type":"application/json","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.164 Safari/537.36","sec-ch-ua":'" Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkZvcnQgTGF1ZGVyZGFsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMzMyMlwiLFwibG9uZ2l0dWRlXCI6LTgwLjI3NjgsXCJsYXRpdHVkZVwiOjI2LjE0ODZ9In0.Tjhlca2iBpxc6-SCQFImXWks2GnHjXnczrLRnDDbXOo","x-ou-d-token":"web-052d0185d991b73f7eb7bd5fda75c0cfbbf2f95bb2f392f52630a64b","x-ou-f-token":"74e5e1d98ea7ec925d75f015a16b3f3c","x-request-id":"80707cf9-26e1-4dbb-b3b3-3bf45c711c5f"},referrer:"https://offerup.com/inbox",referrerPolicy:"strict-origin-when-cross-origin",body:'{"operationName":"GetChats","variables":{},"query":"query GetChats {\\n  getChats: alertsWithAds(type: INBOX) {\\n    chats: alertsWithAds {\\n      ... on Alert {\\n        contentThumbnails\\n        id\\n        read\\n        seen\\n        type\\n        title\\n        notificationText\\n        dateAdded\\n        objectId\\n        visualTags {\\n          tag\\n          type\\n          displayText\\n          __typename\\n        }\\n        sender {\\n          id\\n          profile {\\n            firstName\\n            isTruyouVerified\\n            isAutosDealer\\n            avatars {\\n              squareImage\\n              __typename\\n            }\\n            notActive\\n            __typename\\n          }\\n          __typename\\n        }\\n        __typename\\n      }\\n      ... on BingAd {\\n        ouAdId\\n        itemName\\n        imageUrl\\n        sellerName\\n        price\\n        lowPrice\\n        impressionFeedbackUrl\\n        contentUrl\\n        adNetwork\\n        adExperimentId\\n        adRequestId\\n        experimentDataHash\\n        __typename\\n      }\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n"}',method:"POST",mode:"cors",credentials:"include"}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).then((e=>(t>0&&(0,a.CONSOLE_MESSAGE)("custom",`Successfully recovered counting conversations api after ${t} tries.`),e))).catch((async n=>(console.error("Fetch Failed (countConversations)",n,t),t&&t>6?"":(await(0,d.retryDelayWithMessage)(`Failed to count conversations. API failed: ${n}`),t||(t=0),e(t+=1)))))}const t=await e().then((async e=>{try{return e&&e.match&&e.match(/currently serve areas outside of the US/i)?{error:"Proxy Failed",error_code:"proxy-failed"}:JSON.parse(e)}catch(t){return await(0,c.Z)({error:"Failed to parse countConversations api response.",x:e}),{}}}));if(t&&"proxy-failed"===t.error_code)return console.error("Proxy Failed - Got Error: Currently serve areas outside of the US"),"";if(t&&t.data&&t.data.getChats&&t.data.getChats.chats)return t.data.getChats.chats.length}catch(n){return 0}},getInboxThreads:async function(){try{async function e(t){return fetch("https://offerup.com/api/graphql",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9","content-type":"application/json","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.164 Safari/537.36","sec-ch-ua":'" Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkZvcnQgTGF1ZGVyZGFsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMzMyMlwiLFwibG9uZ2l0dWRlXCI6LTgwLjI3NjgsXCJsYXRpdHVkZVwiOjI2LjE0ODZ9In0.Tjhlca2iBpxc6-SCQFImXWks2GnHjXnczrLRnDDbXOo","x-ou-d-token":"web-052d0185d991b73f7eb7bd5fda75c0cfbbf2f95bb2f392f52630a64b","x-ou-f-token":"74e5e1d98ea7ec925d75f015a16b3f3c","x-request-id":"80707cf9-26e1-4dbb-b3b3-3bf45c711c5f"},referrer:"https://offerup.com/inbox",referrerPolicy:"strict-origin-when-cross-origin",body:'{"operationName":"GetChats","variables":{},"query":"query GetChats {\\n  getChats: alertsWithAds(type: INBOX) {\\n    chats: alertsWithAds {\\n      ... on Alert {\\n        contentThumbnails\\n        id\\n        read\\n        seen\\n        type\\n        title\\n        notificationText\\n        dateAdded\\n        objectId\\n        visualTags {\\n          tag\\n          type\\n          displayText\\n          __typename\\n        }\\n        sender {\\n          id\\n          profile {\\n            firstName\\n            isTruyouVerified\\n            isAutosDealer\\n            avatars {\\n              squareImage\\n              __typename\\n            }\\n            notActive\\n            __typename\\n          }\\n          __typename\\n        }\\n        __typename\\n      }\\n      ... on BingAd {\\n        ouAdId\\n        itemName\\n        imageUrl\\n        sellerName\\n        price\\n        lowPrice\\n        impressionFeedbackUrl\\n        contentUrl\\n        adNetwork\\n        adExperimentId\\n        adRequestId\\n        experimentDataHash\\n        __typename\\n      }\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n"}',method:"POST",mode:"cors",credentials:"include"}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).then((e=>(t>0&&(0,a.CONSOLE_MESSAGE)("custom",`Successfully recovered counting conversations api after ${t} tries.`),e))).catch((async n=>(console.error("Fetch Failed (countConversations)",n,t),t&&t>6?"":(await(0,d.retryDelayWithMessage)(`Failed to count conversations. API failed: ${n}`),t||(t=0),e(t+=1)))))}const t=await e().then((async e=>{try{return e&&e.match&&e.match(/currently serve areas outside of the US/i)?{error:"Proxy Failed",error_code:"proxy-failed"}:JSON.parse(e)}catch(t){return await(0,c.Z)({error:"Failed to parse countConversations api response.",x:e}),{}}}));if(t&&"proxy-failed"===t.error_code)return console.error("Proxy Failed - Got Error: Currently serve areas outside of the US"),"";if(t&&t.data&&t.data.getChats&&t.data.getChats.chats)return t.data.getChats.chats}catch(n){return 0}},fetchListings:async function(e,t){let n=document.querySelector("#listing_min_price").value,i=document.querySelector("#listing_max_price").value,a="",s=[],o="",r=!1;if(String(e).startsWith("k/")){r=!0,a=function(e){if(!e)return"";let t=String(e).split("?")[0];return String(t).replace("k/","").replace(/\//g,".")}(e),s=(0,g.i8)(e);const t=(0,g.UO)(e);console.log("urlParams",t),t.PRICE_MAX&&(i=t.PRICE_MAX),t.PRICE_MIN&&(n=t.PRICE_MIN),t.q&&(o=t.q)}else o=e;let u=[{key:"SORT",value:"-posted"},{key:"zipcode",value:t},{key:"platform",value:"web"},{key:"limit",value:"100"},{key:"searchSessionId",value:"82eb4f89-a745-4cee-a5c1-bd0ccb73a34e"}];o&&u.push({key:"q",value:o}),u=u.concat(s),a&&u.push({key:"cid",value:a}),n&&u.push({key:"PRICE_MIN",value:n}),i&&u.push({key:"PRICE_MAX",value:i});const p={operationName:r?"GetModularFeed":"GetSearchFeed",query:r?"query GetModularFeed($searchParams: [SearchParam], $debug: Boolean = false) {\n        modularFeed(params: $searchParams, debug: $debug) {\n          analyticsData {\n            requestId\n            searchPerformedEventUniqueId\n            searchSessionId\n            __typename\n          }\n          categoryInfo {\n            categoryId\n            isForcedCategory\n            __typename\n          }\n          feedAdditions\n          filters {\n            ...modularFilterNumericRange\n            ...modularFilterSelectionList\n            __typename\n          }\n          legacyFeedOptions {\n            ...legacyFeedOptionListSelection\n            ...legacyFeedOptionNumericRange\n            __typename\n          }\n          looseTiles {\n            ...modularTileBanner\n            ...modularTileBingAd\n            ...modularTileGoogleDisplayAd\n            ...modularTileJob\n            ...modularTileEmptyState\n            ...modularTileListing\n            ...modularTileLocalDisplayAd\n            ...modularTileSearchAlert\n            ...modularTileSellerAd\n            ...modularModuleTileAdsPostXAd\n            __typename\n          }\n          modules {\n            ...modularGridModule\n            __typename\n          }\n          pageCursor\n          query {\n            ...modularQueryInfo\n            __typename\n          }\n          requestTimeMetadata {\n            resolverComputationTimeSeconds\n            serviceRequestTimeSeconds\n            totalResolverTimeSeconds\n            __typename\n          }\n          searchAlert {\n            alertId\n            alertStatus\n            searchAlertCount\n            __typename\n          }\n          personalizationPath\n          debugInformation @include(if: $debug) {\n            rankedListings {\n              listingId\n              attributes {\n                key\n                value\n                __typename\n              }\n              __typename\n            }\n            lastViewedItems {\n              listingId\n              attributes {\n                key\n                value\n                __typename\n              }\n              __typename\n            }\n            categoryAffinities {\n              affinity\n              count\n              decay\n              affinityOwner\n              __typename\n            }\n            rankingStats {\n              key\n              value\n              __typename\n            }\n            __typename\n          }\n          __typename\n        }\n      }\n      \n      fragment modularFilterNumericRange on ModularFeedNumericRangeFilter {\n        isExpandedHighlight\n        lowerBound {\n          ...modularFilterNumericRangeBound\n          __typename\n        }\n        shortcutLabel\n        shortcutRank\n        subTitle\n        targetName\n        title\n        type\n        upperBound {\n          ...modularFilterNumericRangeBound\n          __typename\n        }\n        __typename\n      }\n      \n      fragment modularFilterNumericRangeBound on ModularFeedNumericRangeFilterNumericRangeBound {\n        label\n        limit\n        placeholderText\n        targetName\n        value\n        __typename\n      }\n      \n      fragment modularFilterSelectionList on ModularFeedSelectionListFilter {\n        targetName\n        title\n        subTitle\n        shortcutLabel\n        shortcutRank\n        type\n        isExpandedHighlight\n        options {\n          ...modularFilterSelectionListOption\n          __typename\n        }\n        __typename\n      }\n      \n      fragment modularFilterSelectionListOption on ModularFeedSelectionListFilterOption {\n        isDefault\n        isSelected\n        label\n        subLabel\n        value\n        __typename\n      }\n      \n      fragment legacyFeedOptionListSelection on FeedOptionListSelection {\n        label\n        labelShort\n        name\n        options {\n          default\n          label\n          labelShort\n          selected\n          subLabel\n          value\n          __typename\n        }\n        position\n        queryParam\n        type\n        __typename\n      }\n      \n      fragment legacyFeedOptionNumericRange on FeedOptionNumericRange {\n        label\n        labelShort\n        leftQueryParam\n        lowerBound\n        name\n        options {\n          currentValue\n          label\n          textHint\n          __typename\n        }\n        position\n        rightQueryParam\n        type\n        units\n        upperBound\n        __typename\n      }\n      \n      fragment modularTileBanner on ModularFeedTileBanner {\n        tileId\n        tileType\n        title\n        __typename\n      }\n      \n      fragment modularTileBingAd on ModularFeedTileBingAd {\n        tileId\n        bingAd {\n          ouAdId\n          adExperimentId\n          adNetwork\n          adRequestId\n          adTileType\n          adSettings {\n            repeatClickRefractoryPeriodMillis\n            __typename\n          }\n          bingClientId\n          clickFeedbackUrl\n          clickReturnUrl\n          contentUrl\n          deepLinkEnabled\n          experimentDataHash\n          image {\n            height\n            url\n            width\n            __typename\n          }\n          impressionFeedbackUrl\n          impressionUrls\n          viewableImpressionUrls\n          installmentInfo {\n            amount\n            description\n            downPayment\n            __typename\n          }\n          itemName\n          lowPrice\n          price\n          searchId\n          sellerName\n          templateFields {\n            key\n            value\n            __typename\n          }\n          __typename\n        }\n        tileType\n        __typename\n      }\n      \n      fragment modularTileGoogleDisplayAd on ModularFeedTileGoogleDisplayAd {\n        tileId\n        googleDisplayAd {\n          ouAdId\n          additionalSizes\n          adExperimentId\n          adHeight\n          adNetwork\n          adPage\n          adRequestId\n          adTileType\n          adWidth\n          adaptive\n          channel\n          clickFeedbackUrl\n          clientId\n          contentUrl\n          customTargeting {\n            key\n            values\n            __typename\n          }\n          displayAdType\n          errorDrawable {\n            actionPath\n            listImage {\n              height\n              url\n              width\n              __typename\n            }\n            __typename\n          }\n          experimentDataHash\n          formatIds\n          impressionFeedbackUrl\n          personalizationProperties {\n            key\n            values\n            __typename\n          }\n          prebidConfigs {\n            key\n            values {\n              timeout\n              tamSlotUUID\n              liftoffPlacementIDs\n              __typename\n            }\n            __typename\n          }\n          renderLocation\n          searchId\n          searchQuery\n          templateId\n          __typename\n        }\n        tileType\n        __typename\n      }\n      \n      fragment modularTileJob on ModularFeedTileJob {\n        tileId\n        tileType\n        job {\n          address {\n            city\n            state\n            zipcode\n            __typename\n          }\n          companyName\n          datePosted\n          image {\n            height\n            url\n            width\n            __typename\n          }\n          industry\n          jobId\n          jobListingUrl\n          jobOwnerId\n          pills {\n            text\n            type\n            __typename\n          }\n          title\n          apply {\n            method\n            value\n            __typename\n          }\n          wageDisplayValue\n          provider\n          __typename\n        }\n        __typename\n      }\n      \n      fragment modularTileEmptyState on ModularFeedTileEmptyState {\n        tileId\n        tileType\n        title\n        description\n        iconType\n        __typename\n      }\n      \n      fragment modularTileListing on ModularFeedTileListing {\n        tileId\n        listing {\n          ...modularListing\n          __typename\n        }\n        tileType\n        __typename\n      }\n      \n      fragment modularListing on ModularFeedListing {\n        listingId\n        conditionText\n        flags\n        image {\n          height\n          url\n          width\n          __typename\n        }\n        isFirmPrice\n        locationName\n        price\n        title\n        vehicleMiles\n        __typename\n      }\n      \n      fragment modularTileLocalDisplayAd on ModularFeedTileLocalDisplayAd {\n        tileId\n        localDisplayAd {\n          ouAdId\n          adExperimentId\n          adNetwork\n          adRequestId\n          adTileType\n          advertiserId\n          businessName\n          callToAction\n          callToActionType\n          clickFeedbackUrl\n          contentUrl\n          experimentDataHash\n          headline\n          image {\n            height\n            url\n            width\n            __typename\n          }\n          impressionFeedbackUrl\n          searchId\n          __typename\n        }\n        tileType\n        __typename\n      }\n      \n      fragment modularTileSearchAlert on ModularFeedTileSearchAlert {\n        tileId\n        tileType\n        title\n        __typename\n      }\n      \n      fragment modularTileSellerAd on ModularFeedTileSellerAd {\n        tileId\n        listing {\n          ...modularListing\n          __typename\n        }\n        sellerAd {\n          ouAdId\n          adId\n          adExperimentId\n          adNetwork\n          adRequestId\n          adTileType\n          clickFeedbackUrl\n          experimentDataHash\n          impressionFeedbackUrl\n          searchId\n          __typename\n        }\n        tileType\n        __typename\n      }\n      \n      fragment modularModuleTileAdsPostXAd on ModularFeedTileAdsPostXAd {\n        ...modularTileAdsPostXAd\n        moduleId\n        moduleRank\n        moduleType\n        __typename\n      }\n      \n      fragment modularTileAdsPostXAd on ModularFeedTileAdsPostXAd {\n        tileId\n        adsPostXAd {\n          ouAdId\n          adExperimentId\n          adNetwork\n          adRequestId\n          adTileType\n          clickFeedbackUrl\n          experimentDataHash\n          impressionFeedbackUrl\n          searchId\n          offer {\n            beacons {\n              noThanksClick\n              close\n              __typename\n            }\n            title\n            description\n            clickUrl\n            image\n            pixel\n            ctaYes\n            ctaNo\n            __typename\n          }\n          __typename\n        }\n        tileType\n        __typename\n      }\n      \n      fragment modularGridModule on ModularFeedModuleGrid {\n        moduleId\n        collection\n        formFactor\n        grid {\n          actionPath\n          tiles {\n            ...modularModuleTileBingAd\n            ...modularModuleTileGoogleDisplayAd\n            ...modularModuleTileListing\n            ...modularModuleTileLocalDisplayAd\n            ...modularModuleTileSellerAd\n            __typename\n          }\n          __typename\n        }\n        moduleType\n        rank\n        rowIndex\n        searchId\n        subTitle\n        title\n        infoActionPath\n        feedIndex\n        __typename\n      }\n      \n      fragment modularModuleTileBingAd on ModularFeedTileBingAd {\n        ...modularTileBingAd\n        moduleId\n        moduleRank\n        moduleType\n        __typename\n      }\n      \n      fragment modularModuleTileGoogleDisplayAd on ModularFeedTileGoogleDisplayAd {\n        ...modularTileGoogleDisplayAd\n        moduleId\n        moduleRank\n        moduleType\n        __typename\n      }\n      \n      fragment modularModuleTileListing on ModularFeedTileListing {\n        ...modularTileListing\n        moduleId\n        moduleRank\n        moduleType\n        __typename\n      }\n      \n      fragment modularModuleTileLocalDisplayAd on ModularFeedTileLocalDisplayAd {\n        ...modularTileLocalDisplayAd\n        moduleId\n        moduleRank\n        moduleType\n        __typename\n      }\n      \n      fragment modularModuleTileSellerAd on ModularFeedTileSellerAd {\n        ...modularTileSellerAd\n        moduleId\n        moduleRank\n        moduleType\n        __typename\n      }\n      \n      fragment modularQueryInfo on ModularFeedQueryInfo {\n        appliedQuery\n        decisionType\n        originalQuery\n        suggestedQuery\n        __typename\n      }":"query GetSearchFeed($searchParams: [SearchParam]) {\n          search(params: $searchParams) {\n            nextPageCursor\n            query\n            feedItems {\n              type\n              tile {\n                ... on Listing {\n                  id\n                  title\n                  state\n                  condition\n                  postDate\n                  photos {\n                    uuid\n                    list {\n                      url\n                      width\n                      height\n                      __typename\n                    }\n                    detail {\n                      url\n                      width\n                      height\n                      __typename\n                    }\n                    small {\n                      url\n                      width\n                      height\n                      __typename\n                    }\n                    squareSmall {\n                      url\n                      width\n                      height\n                      __typename\n                    }\n                    __typename\n                  }\n                  category {\n                    id\n                    __typename\n                  }\n                  locationDetails {\n                    locationName\n                    distance\n                    __typename\n                  }\n                  price\n                  fulfillmentDetails {\n                    shippingEnabled\n                    shippingPrice\n                    sellerPaysShipping\n                    showShippingIconInFeed\n                    __typename\n                  }\n                  vehicleAttributes {\n                    vehicleMiles\n                    vehicleMake\n                    vehicleYear\n                    vehicleModel\n                    __typename\n                  }\n                  showCallForPrice\n                  isMerchantItem\n                  sku\n                  merchantId\n                  __typename\n                }\n                ... on SellerAd {\n                  itemId\n                  ouAdId\n                  adMediationId\n                  adExperimentId\n                  adNetwork\n                  adRequestId\n                  searchId\n                  tileType\n                  type\n                  campaignId\n                  impressionFeedbackUrls\n                  listing {\n                    id\n                    title\n                    condition\n                    postDate\n                    isMerchantItem\n                    photos {\n                      uuid\n                      list {\n                        url\n                        width\n                        height\n                        __typename\n                      }\n                      detail {\n                        url\n                        width\n                        height\n                        __typename\n                      }\n                      small {\n                        url\n                        width\n                        height\n                        __typename\n                      }\n                      __typename\n                    }\n                    locationDetails {\n                      locationName\n                      distance\n                      __typename\n                    }\n                    price\n                    fulfillmentDetails {\n                      shippingEnabled\n                      shippingPrice\n                      sellerPaysShipping\n                      showShippingIconInFeed\n                      __typename\n                    }\n                    vehicleAttributes {\n                      vehicleMiles\n                      __typename\n                    }\n                    showCallForPrice\n                    __typename\n                  }\n                  __typename\n                }\n                ... on BingAd {\n                  ouAdId\n                  adMediationId\n                  adExperimentId\n                  adNetwork\n                  adRequestId\n                  searchId\n                  tileType\n                  type\n                  experimentDataHash\n                  imageUrl\n                  contentUrl\n                  price\n                  priceCurrency\n                  itemName\n                  sellerName\n                  clientImpressionFeedbackUrls\n                  clickReturnUrl\n                  lowPrice\n                  impressionFeedbackUrl\n                  clickFeedbackUrl\n                  imageWidth\n                  imageHeight\n                  rating\n                  numberOfReviews\n                  __typename\n                }\n                ... on GoogleDisplayAd {\n                  ouAdId\n                  adMediationId\n                  adExperimentId\n                  adRequestId\n                  adNetwork\n                  tileType\n                  type\n                  experimentDataHash\n                  errorDrawable {\n                    listImage {\n                      url\n                      width\n                      height\n                      __typename\n                    }\n                    actionPath\n                    __typename\n                  }\n                  clientId\n                  searchId\n                  displayAdType\n                  contentUrl\n                  adWidth\n                  adHeight\n                  additionalSizes\n                  __typename\n                }\n                ... on LocalDisplayAd {\n                  ouAdId\n                  adMediationId\n                  adExperimentId\n                  adRequestId\n                  adNetwork\n                  tileType\n                  type\n                  experimentDataHash\n                  searchId\n                  imageUrl\n                  contentUrl\n                  impressionFeedbackUrl\n                  clickFeedbackUrl\n                  headline\n                  businessName\n                  locationText\n                  callToAction\n                  callToActionType\n                  __typename\n                }\n                __typename\n              }\n              banner {\n                label\n                actionBannerType\n                __typename\n              }\n              __typename\n            }\n            feedOptions {\n              ... on FeedOptionListSelection {\n                position\n                type\n                name\n                label\n                labelShort\n                queryParam\n                options {\n                  label\n                  labelShort\n                  subLabel\n                  value\n                  selected\n                  default\n                  __typename\n                }\n                __typename\n              }\n              ... on FeedOptionNumericRange {\n                position\n                type\n                name\n                label\n                labelShort\n                units\n                lowerBound\n                upperBound\n                leftQueryParam\n                rightQueryParam\n                options {\n                  label\n                  currentValue\n                  textHint\n                  __typename\n                }\n                __typename\n              }\n              __typename\n            }\n            feedPresentation {\n              columnCount\n              showDetailsOnTiles\n              __typename\n            }\n            searchAlert {\n              alertId\n              __typename\n            }\n            searchSuggestion {\n              originalQuery\n              suggestedQuery\n              itemSource\n              __typename\n            }\n            searchData {\n              searchPerformedEventUniqueId\n              searchSessionId\n              __typename\n            }\n            forcedCategory {\n              id\n              __typename\n            }\n            requestTimeMetadata {\n              totalResolverTimeSeconds\n              serviceRequestTimeSeconds\n              resolverComputationTimeSeconds\n              __typename\n            }\n            __typename\n          }\n        }",variables:{debug:!1,searchParams:u}},m=await async function e(t){return fetch("https://offerup.com/api/graphql",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9","content-type":"application/json","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36","ou-experiment-data":'{"datamodel_id":"experimentmodel24"}',"sec-ch-ua":'"Chromium";v="92", " Not A;Brand";v="99", "Google Chrome";v="92"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkphY2tzb252aWxsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMjIwMlwiLFwibG9uZ2l0dWRlXCI6LTgxLjY0OTIsXCJsYXRpdHVkZVwiOjMwLjMyOTh9In0.9dKswdRFV427P3pvAOfIaH8ybQGx9TN3EBEFH3NOSCY","x-ou-d-token":"web-052d0185d991b73f7eb7bd5fda75c0cfbbf2f95bb2f392f52630a64b","x-ou-f-token":"74e5e1d98ea7ec925d75f015a16b3f3c","x-request-id":"52b74dce-6306-4e36-a98a-837248ea416b"},referrer:"https://offerup.com/search?q=iphone+12",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify(p),method:"POST",mode:"cors",credentials:"include"}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).catch((async n=>(console.error("Fetch Failed (fetchListings)",n,t),t&&t>6?"":(await(0,d.retryDelayWithMessage)(`Failed to fetch listingss. API failed: ${n}`),t||(t=0),e(t+=1)))))}().then((async e=>{try{return e&&e.match&&e.match(/currently serve areas outside of the US/i)?{error:"Proxy Failed",error_code:"proxy-failed"}:JSON.parse(e)}catch(t){return console.error(t),await(0,c.Z)({error:"Failed to parse fetchlistings api response.",x:e}),{}}}));return m&&"proxy-failed"===m.error_code?(console.error("Proxy Failed - Got Error: Currently serve areas outside of the US"),[]):m&&m.data&&m.data.search&&m.data.search.feedItems?m.data.search.feedItems.filter((e=>"item"===e.type&&e.tile&&e.tile.title)):m&&m.data&&m.data.modularFeed&&Array.isArray(m.data.modularFeed.looseTiles)?m.data.modularFeed.looseTiles.filter((e=>e.listing)).map((e=>(e.tile=e.listing,delete e.listing,e.tile.id=e.tile.listingId,e))):[]},getUserListings:async function(e){const t=await async function t(n){return fetch("https://offerup.com/api/graphql",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9","content-type":"application/json","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36","sec-ch-ua":'"Google Chrome";v="93", " Not;A Brand";v="99", "Chromium";v="93"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkZvcnQgTGF1ZGVyZGFsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMzMyMlwiLFwibG9uZ2l0dWRlXCI6LTgwLjI3NjgsXCJsYXRpdHVkZVwiOjI2LjE0ODZ9In0.Tjhlca2iBpxc6-SCQFImXWks2GnHjXnczrLRnDDbXOo","x-ou-d-token":"web-052d0185d991b73f7eb7bd5fda75c0cfbbf2f95bb2f392f52630a64b","x-ou-f-token":"74e5e1d98ea7ec925d75f015a16b3f3c","x-request-id":"699815d5-4b0c-48f2-b821-0f7ceb793019"},referrer:"https://offerup.com/item/detail/1267519944?q=iphone+xs",referrerPolicy:"strict-origin-when-cross-origin",body:`{"operationName":"GetProfileUserItems","variables":{"userId":"${e}","limit":20,"pageCursor":null},"query":"query GetProfileUserItems($userId: String!, $pageCursor: String, $limit: Int) {\\n  userListings(userId: $userId, pageCursor: $pageCursor, limit: $limit) {\\n    pageCursor\\n    listings {\\n      id\\n      listingId\\n      title\\n      fulfillmentDetails {\\n  shippingEnabled\\n  shippingPrice\\n  sellerPaysShipping\\n  showShippingIconInFeed\\n  __typename\\n} postDate\\n description\\n price\\n      state\\n      locationDetails {\\n        locationName\\n        __typename\\n      }\\n      photos {\\n        uuid\\n        list {\\n          url\\n          width\\n          height\\n          __typename\\n        }\\n        detail {\\n          url\\n          width\\n          height\\n          __typename\\n        }\\n        __typename\\n      }\\n      vehicleAttributes {\\n        vehicleMiles\\n        __typename\\n      }\\n      owner {\\n        profile {\\n          isSubPrimeDealer\\n          isAutosDealer\\n          __typename\\n        }\\n        __typename\\n      }\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n"}`,method:"POST",mode:"cors",credentials:"include"}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).catch((async e=>(console.error("Fetch Failed (getUserListings)",e,n),n&&n>6?"":(await(0,d.retryDelayWithMessage)(`Failed to get user listings. API failed: ${e}`),n||(n=0),t(n+=1)))))}().then((async e=>{try{return e&&e.match&&e.match(/currently serve areas outside of the US/i)?{error:"Proxy Failed",error_code:"proxy-failed"}:JSON.parse(e)}catch(t){return await(0,c.Z)({error:"Failed to parse getUserListings api response.",x:e}),{}}}));return t&&"proxy-failed"===t.error_code?(console.error("Proxy Failed - Got Error: Currently serve areas outside of the US"),[]):t&&t.data&&t.data.userListings&&t.data.userListings.listings?t.data.userListings.listings.filter((e=>"LISTED"===e.state)):((0,r._apiSendBug)({error:"Failed to get user listings",userid:e,apiResponse:t}),await(0,d.retryDelayWithMessage)("Failed to get user listings."),[])}}}},8809:(e,t,n)=>{"use strict";n.r(t),n.d(t,{attachEvents:()=>G});var i=n(9217),a=n(3539),s=n(3177),o=n(4246);async function r(){"ARCHIVE"===prompt("Are you sure you want to archive all read threads in your marketplace inbox? Type ARCHIVE to confirm:")&&((0,a.CONSOLE_MESSAGE)("custom","Archiving read threads..."),async function(){try{console.log("Starting to archive threads with no unread messages...");const e=document.querySelector("#switch-skipunread").checked,t=document.getElementById("amount_to_archive").value||0;let n=0;const r=await(0,i.apiOfferUp)().getInboxThreads();if(Array.isArray(r)){const l=Number(document.getElementById("archiveolderthan").value);for(let d=0;d<r.length;d++){const c=r[d],u=c.id,p=c.read,m=c.dateAdded;if((p||!e)&&new Date(m)<new Date((new Date).setDate((new Date).getDate()-l))){if(await(0,i.apiOfferUp)().deleteMessageByChatId(u),window.iArchived||(window.iArchived=0),window.iArchived+=1,n+=1,window.iArchived>=t){window.iArchived=0;const e=`Archived ${n} threads of ${r.length} threads.`;return console.log(e),console.log(`Reached max archive of ${t}`),"max archive reached"}console.log(`Archived thread ${u}`),(0,a.CONSOLE_MESSAGE)("custom",`Archived thread ${u}`),await(0,o.sleep)(1e3*(0,s.randomIntFromInterval)(1,3))}}}const l=e?"Finished archiving read threads.":"Finished archiving all threads.";console.log(l),(0,a.CONSOLE_MESSAGE)("custom",l)}catch(e){console.error("Failed to archive threads",e),(0,a.CONSOLE_MESSAGE)("error",e.message)}}())}var l=n(1203),d=n(869),c=n(1023),u=n(4347),p=n(9395);async function m(){if(!window.location.href.includes("item/detail"))return void alert("This is not a listing page. Make sure you are in listing page such as https://offerup.com/item/detail/d2912b65-71d6-34e5-9683-81082c710953");let e;try{e=window.location.href.match(/item\/detail\/([\w-]+)/)[1]}catch(e){return void alert("Error getting listing id from url")}const t=await(0,u.fetchListingDetail)(e).catch((()=>{alert("Error fetching listing details")}));let n=[];const a=t?.owner?.id;if(console.log("ownerid",a),a){const e=await(0,i.apiOfferUp)().getUserListings(a);console.log("ownerListings",e),n=e}return(0,p.r)(t,n)}async function g(){(0,c.showLoading)(!0);const e=await m();let t=e.photos;const n=parseInt(document.getElementById("num_images").value,10);n&&t&&t.length>n&&(t=t.slice(0,n));try{navigator.clipboard.writeText(e.text+"\nPhotos: "+JSON.stringify(t))}catch(e){console.log("Error copying to clipboard",e)}(0,c.showLoading)(!1),await(0,o.sleep)(1e3),alert("Details has beed copied to clipboard")}var h=n(8792);async function f(){const e=await(0,h.gp)("usersskip");return y(e,"Owner Skip List.csv"),e}async function _(){const e=await(0,h.gp)("listings");return y(e,"Listings Skip List.csv"),e}function y(e,t){const n=JSON.stringify(e,null,2),i=new Blob([n],{type:"text/plain"}),a=URL.createObjectURL(i),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download",t),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}function w(e){const t=e.target.textContent;if(window.lastInputId){const e=document.getElementById(window.lastInputId[0]);let n=e.value;n=[n.slice(0,window.lastInputId[1]),t,n.slice(window.lastInputId[1])].join(""),e.value=n,e.parentNode.classList.add("is-focused"),e.focus();const i=window.lastInputId[1]+t.length;e.setSelectionRange(i,i)}}function b(e){let t=e.target.value;t=t.replace(/[^0-9.-]/g,""),e.target.value=t}var v=n(9485),S=n(9309);async function x(){(0,c.showLoading)("Getting listing details..."),(0,a.CONSOLE_MESSAGE)("custom","Getting listing details...");const e=await m();if(!e)return void(0,c.showLoading)(!1);(0,c.showLoading)("Generating message..."),(0,a.CONSOLE_MESSAGE)("custom","Generating message...");const t=await(0,S.generateMessage)(e.text,e.photos);if((0,c.showLoading)(!1),(0,a.CONSOLE_MESSAGE)("custom","Message generated."),"skip"!==t.status){if("message"===t.status){let e=t.message;return Array.isArray(e)&&(e=e.join("\n")),void alert(e)}return"error"===t.status?((0,c.showLoading)(!1),void alert(t.message)):void 0}alert(t.message)}async function I(){"LISTINGS"===prompt("Are you sure you want to purge your listings skip list? Type LISTINGS to confirm:")&&((0,a.CONSOLE_MESSAGE)("custom","Purging listings..."),async function(){const e=await fetch(`https://us-central1-trade-apples.cloudfunctions.net/offerupbot?purge=1&listname=listings&partnerid=${window.taPartnerId}`).then((e=>e.json()));e.success?(0,a.CONSOLE_MESSAGE)("custom","Listings has been successfully purged."):(console.error("Failed to purge listings.",e),(0,a.CONSOLE_MESSAGE)("custom","Failed to purge listings."))}())}async function k(){"OWNERS"===prompt("Are you sure you want to purge your owners skip list? Type OWNERS to confirm:")&&((0,a.CONSOLE_MESSAGE)("custom","Purging owners..."),async function(){const e=await fetch(`https://us-central1-trade-apples.cloudfunctions.net/offerupbot?purge=1&listname=users&partnerid=${window.taPartnerId}`).then((e=>e.json()));e.success?(0,a.CONSOLE_MESSAGE)("custom","Owners has been successfully purged."):(console.error("Failed to purge owners.",e),(0,a.CONSOLE_MESSAGE)("custom","Failed to purge owners."))}())}var E=n(6186),L=(n(9971),n(7426));async function T(e){const t=e.target.id;if(t)if("radio"===e.target.type){const n=e.target.name;localStorage.setItem(`radio_${n}`,t)}else"checkbox"===e.target.type?(localStorage.setItem(`input_${t}`,e.target.checked),"switch-rununtil"===t&&(e.target.checked?(await(0,E.s)("Bot is starting in ",5),window.location.reload()):(unsafeWindow.isRun=0,delete unsafeWindow.runningInstanceId,(0,L.o)(!0),await releaseSubscriptionRunLock(),await(0,E.s)("Bot is stopping in ",5),window.location.reload()))):localStorage.setItem(`input_${t}`,e.target.value)}var A=n(1221);async function M(){window.confirm("Are you sure you want to eject the subscription id?")&&(await(0,A.TQ)({clear:!0}),window.location.reload())}var O=n(8365),F=n(9237),N=n(313),C=n(3613),D=n(1060);async function j(){(0,c.showLoading)(!0);const e=document.getElementById("listing_url").value;if(!e)return(0,c.showLoading)(!1),void alert("Please enter a valid listing URL.");let t="";if(e.includes("offerup.com/item/detail/")){let n=e.match(/item\/detail\/([a-z0-9-]+)/);n&&(t=n[1])}if(!t)return(0,c.showLoading)(!1),void alert("Invalid listing URL. No Listing id found.");const n=await(0,u.fetchListingDetail)(t);if(console.log("listingDetails",n),0===Object.keys(n).length)return(0,c.showLoading)(!1),void alert("Faild to get listing details. Listing not found.");let a=await(0,O.x)(n);const s=await(0,D.KI)(n.title),r=function(e){let t=Number(document.querySelector("#listing_min_price").value)||0,n=Number(document.querySelector("#listing_max_price").value)||214748364700,i=e.price;return"string"==typeof i&&(i=Number(i.replace(/[^0-9\.]+/g,""))),isNaN(i)&&(i=0),i>=t&&i<=n}(n),d=await(0,C.skips)().isSkipListing(t),p=await(0,C.skips)().isSkipMessagedListing(t),m=n&&n.owner&&n.owner.id,g=n&&n.owner&&n.owner.profile&&n.owner.profile.name,h=await(0,C.skips)().isSkipMessagedUser(m),f=await(0,C.skips)().isSkipUser(m),_=await(0,D.AP)(n.description),y=await async function(e){const t=document.getElementById("listing_max_age").value;if(Number(t)<1){const n=100*t;return(0,F.h)(e.postDate)<=n}return(0,F.f)(e.postDate)<=t}(n),w=await async function(e){let t=document.getElementById("skip_profiles_created_after_year");t&&(t=Number(t.value)),t||(t=l.DEFAULT_SKIP_OWNERCREATION_YEAR);const n=e&&e.owner&&e.owner.profile&&e.owner.profile.dateJoined;if(t<=(new Date).getFullYear()&&n){const e=new Date(n).getFullYear();return e&&e>=t}}(n),b=n.title,v=await(0,i.apiOfferUp)().getUserListings(m),S=await(0,N.R)(t,m,g,b,v,!0);console.log("isListingsCountInRange",S),(0,c.showLoading)(!1),await(0,o.sleep)(1e3);let x=`Keyword in title ${a?"✅":"❌"}\n`;x+=`No skipword in title ${s?"❌":"✅"}\n`,x+=`Price in range: ${r?"✅":"❌"}\n`,x+=`Listing not in SkipList ${d?"❌":"✅"}\n`,x+=`Listing not in MessagedList ${p?"❌":"✅"}\n`,x+=`Seller not in SkipList ${f?"❌":"✅"}\n`,x+=`Seller not in MessagedList ${h?"❌":"✅"}\n`,x+=`No skipword in description: ${_?"❌":"✅"}\n`,x+=`Listing age not maxed ${y?"✅":"❌"}\n`;let I=document.getElementById("skip_profiles_created_after_year");I&&(I=Number(I.value)),I||(I=l.DEFAULT_SKIP_OWNERCREATION_YEAR),x+=`Seller profile creation date is < ${I} ${w?"❌":"✅"}\n`,x+=`Owner listings count in range ${S?"✅":"❌"}\n`,alert(x)}var q=n(5836);function R(){!async function(){const{keyword:e,zipcode:t,error:n,isEnd:s}=(0,q.e)();if(n)return void console.error(n);let o=document.querySelector("#ta #searchwithfilters").value;if(!o)return console.error('No "Search With Filters" found.'),void alert('No "Search With Filters" found.');const r=o.trim().split("\n");!async function(e,t){if(!window.isAllowed)return console.error("You are not allowed to use this bot! x("),"not-allowed";(0,a.CONSOLE_MESSAGE)("fetching_listings",{keyword:e},123);const n=await(0,i.apiOfferUp)().fetchListings(e,t);console.log("listings",n),n.map((e=>`${e.tile.title}|${e.tile.price}`)).forEach((e=>console.log(e))),(0,a.CONSOLE_MESSAGE)("custom","Test Finished. Results are in console.")}(r[r.length-1],t)}()}var $=n(7121);function P(e,t){e.target.value<t&&(e.target.value=t)}function U(e,t){e.target.value>t&&(e.target.value=t)}function B(e,t,n){let i=t.value;i=Number(i);let a=e.value;a=Number(a),i-a<n&&(t.value=a+n)}function G(){document.querySelector("#roundupdown").addEventListener("change",window.prefix),document.querySelector("#roundupdown").addEventListener("change",T),document.querySelector("#streak").addEventListener("change",T),document.querySelector("#streaktimeout").addEventListener("change",T),document.querySelector("#followup_after").addEventListener("change",T),document.querySelector("#keywords").addEventListener("change",T),document.querySelector("#keywords").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#searchwithfilters").addEventListener("change",T),document.querySelector("#searchwithfilters").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#title_must_include").addEventListener("change",T),document.querySelector("#title_must_include").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#zipcodes").addEventListener("change",T),document.querySelector("#skipwords_title").addEventListener("change",T),document.querySelector("#skipwords_title").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#skipwords_description").addEventListener("change",T),document.querySelector("#skipwords_description").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#message_1").addEventListener("change",T),document.querySelector("#message_1").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#message_2").addEventListener("change",T),document.querySelector("#message_2").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#message_3").addEventListener("change",T),document.querySelector("#message_3").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#followup_1").addEventListener("change",T),document.querySelector("#followup_1").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#followup_2").addEventListener("change",T),document.querySelector("#followup_2").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#followup_3").addEventListener("change",T),document.querySelector("#followup_3").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#listing_min_price").addEventListener("change",T),document.querySelector("#listing_min_price").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#listing_max_price").addEventListener("change",T),document.querySelector("#listing_max_price").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#owner_min_lists").addEventListener("change",T),document.querySelector("#owner_min_lists").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#owner_min_lists").addEventListener("change",(e=>{!function(e,t){let n=e.target.value,i=t.value;Number(n)>Number(i)&&(t.value=n)}(e,document.querySelector("#owner_max_lists"))})),document.querySelector("#owner_max_lists").addEventListener("change",T),document.querySelector("#owner_max_lists").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#owner_max_lists").addEventListener("change",(e=>{!function(e,t){let n=e.target.value,i=t.value;Number(n)<Number(i)&&(e.target.value=i)}(e,document.querySelector("#owner_min_lists"))})),document.querySelector("#listing_price_delta").addEventListener("change",T),document.querySelector("#listing_price_delta").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#listing_max_age").addEventListener("change",W),document.querySelector("#listing_max_age").addEventListener("change",b),document.querySelector("#listing_max_age").addEventListener("change",T),document.querySelector("#listing_max_age").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#skip_profiles_created_after_year").addEventListener("change",b),document.querySelector("#skip_profiles_created_after_year").addEventListener("change",T),document.querySelector("#skip_profiles_created_after_year").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#runfrom").addEventListener("change",T),document.querySelector("#rununtil").addEventListener("change",T),document.querySelector("#switch-skipshippingenabled").addEventListener("change",T),document.querySelector("#switch-deleteaftersend").addEventListener("change",T),document.querySelector("#switch-rununtil").addEventListener("change",T),document.querySelector("#switch-rununtil").addEventListener("change",(()=>{(0,$.X)(!document.querySelector("#switch-rununtil").checked)})),document.querySelectorAll("#ta .variables .variable").forEach((e=>e.addEventListener("click",w))),document.querySelector("#ta #test_template").addEventListener("click",window.testTemplates),document.querySelector("#copy_search_filters").addEventListener("click",d.H2),document.querySelector("#test_search_filters").addEventListener("click",R),document.querySelector("#ta #restore_defaults").addEventListener("click",window.restoreDefaults),document.querySelector("#purge_listings").addEventListener("click",I),document.querySelector("#purge_owners").addEventListener("click",k),document.querySelector("#archive_all_threads").addEventListener("click",r),document.querySelector("#ta_maximize").addEventListener("click",v.E),document.querySelector("#owner_message_expiry").addEventListener("change",H),document.querySelector("#btn_test_url").addEventListener("click",j),document.querySelector("#download_listings").addEventListener("click",_),document.querySelector("#download_owners").addEventListener("click",f),document.querySelector("#switch-loopsearch").addEventListener("change",T),document.querySelector("#timeout_api_calls_min").addEventListener("change",T),document.querySelector("#timeout_api_calls_min").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_api_calls_min").addEventListener("change",(e=>{P(e,l.apiCallDelay[0]),B(e.target,document.querySelector("#timeout_api_calls_max"),5)})),document.querySelector("#timeout_api_calls_max").addEventListener("change",T),document.querySelector("#timeout_api_calls_max").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_api_calls_max").addEventListener("change",(e=>{U(e,l.apiCallDelay[1]),B(document.querySelector("#timeout_api_calls_min"),e.target,5)})),document.querySelector("#timeout_listings_messaged_min").addEventListener("change",T),document.querySelector("#timeout_listings_messaged_min").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_listings_messaged_min").addEventListener("change",(e=>{P(e,l.userDelay[0]),B(e.target,document.querySelector("#timeout_listings_messaged_max"),10)})),document.querySelector("#timeout_listings_messaged_max").addEventListener("change",T),document.querySelector("#timeout_listings_messaged_max").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_listings_messaged_max").addEventListener("change",(e=>{U(e,l.userDelay[1]),B(document.querySelector("#timeout_listings_messaged_min"),e.target,10)})),document.querySelector("#timeout_streak_min").addEventListener("change",T),document.querySelector("#timeout_streak_min").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_streak_min").addEventListener("change",(e=>{P(e,l.timeout_streak[0]),B(e.target,document.querySelector("#timeout_streak_max"),10)})),document.querySelector("#timeout_streak_max").addEventListener("change",T),document.querySelector("#timeout_streak_max").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_streak_max").addEventListener("change",(e=>{U(e,l.timeout_streak[1]),B(document.querySelector("#timeout_streak_min"),e.target,10)})),document.querySelector("#timeout_end_of_run_min").addEventListener("change",T),document.querySelector("#timeout_end_of_run_min").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_end_of_run_min").addEventListener("change",(e=>{P(e,l.timeout_perpage[0]),B(e.target,document.querySelector("#timeout_end_of_run_max"),10)})),document.querySelector("#timeout_end_of_run_max").addEventListener("change",T),document.querySelector("#timeout_end_of_run_max").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_end_of_run_max").addEventListener("change",(e=>{U(e,l.timeout_perpage[1]),B(document.querySelector("#timeout_end_of_run_min"),e.target,10)})),document.querySelector("#stop_messaging_after").addEventListener("change",T),document.querySelector("#stop_messaging_after").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_between_messages_min").addEventListener("change",T),document.querySelector("#timeout_between_messages_min").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_between_messages_min").addEventListener("change",(e=>{P(e,l.timeout_permessage[0]),B(e.target,document.querySelector("#timeout_between_messages_max"),5)})),document.querySelector("#timeout_between_messages_max").addEventListener("change",T),document.querySelector("#timeout_between_messages_max").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#timeout_between_messages_max").addEventListener("change",(e=>{U(e,l.timeout_permessage[1]),B(document.querySelector("#timeout_between_messages_min"),e.target,5)})),document.querySelector("#archiveolderthan").addEventListener("change",T),document.querySelector("#archiveolderthan").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#amount_to_archive").addEventListener("change",T),document.querySelector("#amount_to_archive").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#switch-skipunread").addEventListener("change",T),document.querySelector("#btn_set_openai_apikey").addEventListener("click",S.setOpenAIApiKey),document.querySelector("#btn_eject_openai_apikey").addEventListener("click",S.ejectOpenAIApikey),document.querySelector("#num_images").addEventListener("change",T),document.querySelector("#num_images").addEventListener("blur",(e=>{window.lastInputId=[e.target.id,e.target.selectionStart]})),document.querySelector("#high").addEventListener("change",T),document.querySelector("#low").addEventListener("change",T),document.querySelector("#switch-enablegpt").addEventListener("change",T),document.querySelector("#btn_openai_test").addEventListener("click",x),document.querySelector("#btn_copylisting_details").addEventListener("click",g),document.querySelector("#btn_eject_subscription").addEventListener("click",M),document.getElementById("login_iframe").onload=function(){console.log("Iframe has loaded successfully!"),(0,c.showLoading)(!1)}}function H(e){e.target.value>14&&(e.target.value=14)}function W(e){e.target.value>14&&(e.target.value=14)}},1334:(e,t,n)=>{"use strict";async function i(e){return GM.getValue(e)}async function a(e,t){return GM.setValue(e,t)}async function s(e){return GM.deleteValue(e)}async function o(){return await GM.listValues()}n.d(t,{FF:()=>o,Q5:()=>a,aD:()=>s,gI:()=>i})},1203:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEFAULT_SKIP_OWNERCREATION_YEAR:()=>g,aNoReasonNeeded:()=>m,apiCallDelay:()=>_,botRetryDelay:()=>f,debug_disableMessages:()=>l,delayPerXMessages:()=>u,disableLogs:()=>d,intervalConversationsCheck:()=>s,listingsPerKeyword:()=>a,losenolead_locationid:()=>v,maxItemsToOfferPartner:()=>o,messageDelay:()=>c,sheet_id:()=>p,showAlerts:()=>r,timeout_permessage:()=>b,timeout_perpage:()=>w,timeout_streak:()=>y,userDelay:()=>h,waitIfSpamDetected:()=>i});const i=1440,a=60,s=10,o=3,r=!1,l=!1,d=!1,c=[3,10],u=10,p="1a6324ea456c27346230df0a70458cc9",m=["listings_messaged","partnermessage","users"],g=2023,h=[20,180],f=[50,70],_=[5,15],y=[20,180],w=[20,180],b=[20,180],v="b6gmn59GxMqRwJSxl2DU"},869:(e,t,n)=>{"use strict";function i(){const e=s(window.location.search);console.log("variables",e);const t=function(){let e=window.location.href,t=e.match(/explore\/(k\/.+)\?/);return t&&t.length>1?t[1]:(t=e.match(/explore\/(k\/.+)\??/),t&&t.length>1?t[1]:"")}();if(!t)return console.error("Failed to get category.",t),void alert("Failed to get category name. make sure you are in a category page. i.e., explore/k/<id>");const n=document.getElementById("searchwithfilters");let i=n.value,a=t+"?"+e.map((e=>`${e.key}=${e.value}`)).join("&");var o,r;"?"===a&&(a=""),i&&(i+="\n"),a&&(i+=a),console.log("valueToAdd",a),console.log("filterValues",i),n.value=i.trim(),function(e){if("createEvent"in document){const t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange");e.parentElement&&e.parentElement.MaterialTextfield&&e.parentElement.MaterialTextfield.change(e.value)}(n),o=document.getElementById("searchwithfilters"),r=new Event("change",{bubbles:!0,cancelable:!0}),o.dispatchEvent(r)}function a(e){e&&!String(e).startsWith("?")&&(e="?"+e.split("?")[1]);const t=new URLSearchParams(e||window.location.search),n={};for(const[e,i]of t.entries())n[e]=i;return n}function s(e){const t=a(e),n=[];for(const e in t)t[e]&&n.push({key:e,value:t[e]});return console.log("variables",n),n}n.d(t,{H2:()=>i,UO:()=>a,i8:()=>s})},6186:(e,t,n)=>{"use strict";async function i(e,t){for(let n=t;n>0;n--)console.log(e,n),CONSOLE_MESSAGE("custom",e+n),await new Promise((e=>setTimeout(e,1e3)))}n.d(t,{s:()=>i})},4904:(e,t,n)=>{"use strict";n.d(t,{TI:()=>l,Xh:()=>d});var i=n(1203),a=n(3539),s=n(3177),o=n(4246);async function r(e,t,n){const i=1e3*(0,s.randomIntFromInterval)(e,t),r=(new Date).getTime()+i;n&&(n+=". ");const l=`${n}Timeout for ${i/1e3} seconds.`;(0,a.CONSOLE_MESSAGE)("timeout",{message:l,hh:moment(r).format("HH"),mm:moment(r).format("mm"),ss:moment(r).format("ss")}),await(0,o.sleep)(i)}async function l(e){let t=document.getElementById("timeout_api_calls_min").value;t||(t=i.apiCallDelay[0]);let n=document.getElementById("timeout_api_calls_max").value;n||(n=i.apiCallDelay[1]),await r(t,n,e)}async function d(e){let t=document.getElementById("timeout_between_messages_min").value;t||(t=i.timeout_permessage[0]);let n=document.getElementById("timeout_between_messages_max").value;n||(n=i.timeout_permessage[1]),await r(t,n,e)}},4347:(e,t,n)=>{"use strict";n.r(t),n.d(t,{fetchListingDetail:()=>o});var i=n(2287),a=n(425),s=n(6849);async function o(e,t){e&&(e=String(e));let n=`{"operationName":"GetListingDetailByListingId","variables":{"isLoggedIn":true,"listingId":"${e}"},"query":"query GetListingDetailByListingId($listingId: ID!, $isLoggedIn: Boolean = false, $deviceLocation: DeviceLocation) {\\n  listing(listingId: $listingId, deviceLocation: $deviceLocation) {\\n    ...listingDetail\\n    __typename\\n  }\\n}\\n\\nfragment listingDetail on Listing {\\n  id\\n  badges\\n  condition\\n  description\\n  discussionCount\\n  distance {\\n    unit\\n    value\\n    __typename\\n  }\\n  extractedAttributes {\\n    attributeName\\n    attributeValue\\n    attributeValueSource\\n    __typename\\n  }\\n  fulfillmentDetails {\\n    buyItNowEnabled\\n    canShipToBuyer\\n    estimatedDeliveryDateEnd\\n    estimatedDeliveryDateStart\\n    localPickupEnabled\\n    sellerPaysShipping\\n    shippingEnabled\\n    shippingParcelId\\n    shippingPrice\\n    showAsShipped\\n    __typename\\n  }\\n  isFirmOnPrice\\n  isLocal\\n  isMerchantItem\\n  lastEdited\\n  listingCategory {\\n    categoryAttributeMap {\\n      attributeName\\n      attributePriority\\n      attributeUILabel\\n      attributeValue\\n      attributeValueSource\\n      __typename\\n    }\\n    categoryV2 {\\n      id\\n      l1Id\\n      l1Name\\n      l2Id\\n      l2Name\\n      l3Id\\n      l3Name\\n      name\\n      __typename\\n    }\\n    __typename\\n  }\\n  listingDetailAds {\\n    adTiles {\\n      ...adsGoogleDisplayAd\\n      __typename\\n    }\\n    placements {\\n      adTileConfigs {\\n        adSize {\\n          additionalSizes\\n          height\\n          width\\n          __typename\\n        }\\n        displayType\\n        renderLocation\\n        __typename\\n      }\\n      adType\\n      quantity\\n      __typename\\n    }\\n    __typename\\n  }\\n  listingId\\n  locationDetails {\\n    distance\\n    latitude\\n    locationName\\n    longitude\\n    __typename\\n  }\\n  merchantId\\n  merchantProfile {\\n    avatar {\\n      small {\\n        url\\n        __typename\\n      }\\n      __typename\\n    }\\n    description\\n    emailAddress\\n    legacyUserOwner\\n    phoneNumber\\n    publicLocationName\\n    storeName\\n    ratingSummary {\\n      average\\n      count\\n      __typename\\n    }\\n    __typename\\n  }\\n  originalPrice\\n  originalTitle\\n  owner {\\n    id\\n    profile {\\n      avatars {\\n        squareImage\\n        __typename\\n      }\\n      c2cPhoneNumber {\\n        countryCode\\n        nationalNumber\\n        __typename\\n      }\\n      clickToCallEnabled\\n      dateJoined\\n      isAutosDealer\\n      isSubPrimeDealer\\n      isTruyouVerified\\n      name\\n      notActive\\n      openingHours {\\n        day\\n        hours\\n        __typename\\n      }\\n      phoneNumber\\n      publicLocation {\\n        formattedAddress\\n        latitude\\n        longitude\\n        name\\n        __typename\\n      }\\n      publicLocationName\\n      itemsPurchased\\n      itemsSold\\n      responseTime\\n      ratingSummary {\\n        average\\n        count\\n        __typename\\n      }\\n      reviews {\\n        attributionIcon\\n        average\\n        readMoreUrl\\n        title\\n        userReviews {\\n          profilePhotoUrl\\n          text\\n          __typename\\n        }\\n        __typename\\n      }\\n      websiteLink\\n      __typename\\n    }\\n    __typename\\n  }\\n  ownerId\\n  photos {\\n    uuid\\n    detail {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    detailFull {\\n      url\\n      width\\n      height\\n      __typename\\n    }\\n    detailSquare {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    list {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    medium {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    squareMedium {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    __typename\\n  }\\n  postDate\\n  price\\n  quantity\\n  saved @include(if: $isLoggedIn)\\n  shippingOptions {\\n    maxHandlingDays\\n    maxShippingDays\\n    minHandlingDays\\n    minShippingDays\\n    name\\n    price\\n    priority\\n    __typename\\n  }\\n  shippingRate {\\n    maxDeliveryDays\\n    maxEstimatedDeliveryDate\\n    minDeliveryDays\\n    minEstimatedDeliveryDate\\n    price\\n    priority\\n    __typename\\n  }\\n  sku\\n  state\\n  title\\n  vehicleAttributes {\\n    vehicleBody\\n    vehicleCityMpg\\n    vehicleColor\\n    vehicleDriveTrain\\n    vehicleDriveTrainClean\\n    vehicleEngineCylinders\\n    vehicleEpaCity\\n    vehicleEpaHighway\\n    vehicleExternalHistoryReport {\\n      epochDate\\n      imageUrl\\n      issues\\n      price {\\n        microUnits\\n        __typename\\n      }\\n      providerName\\n      reportUrl\\n      source\\n      __typename\\n    }\\n    vehicleFuelType\\n    vehicleFundamentals\\n    vehicleHighwayMpg\\n    vehicleId\\n    vehicleMake\\n    vehicleMiles\\n    vehicleModel\\n    vehicleStyleDisplay\\n    vehicleTitleStatus\\n    vehicleTransmission\\n    vehicleTransmissionClean\\n    vehicleTrim\\n    vehicleVin\\n    vehicleYear\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment adsGoogleDisplayAd on GoogleDisplayAd {\\n  ...baseGoogleDisplayAd\\n  renderLocation\\n  tileType\\n  __typename\\n}\\n\\nfragment baseGoogleDisplayAd on GoogleDisplayAd {\\n  ouAdId\\n  adExperimentId\\n  adHeight\\n  adMediationId\\n  adNetwork\\n  adRequestId\\n  adWidth\\n  clientId\\n  contentUrl\\n  displayAdType\\n  errorDrawable {\\n    actionPath\\n    listImage {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    __typename\\n  }\\n  experimentDataHash\\n  personalizationProperties {\\n    key\\n    values\\n    __typename\\n  }\\n  type\\n  __typename\\n}\\n"}`;e&&e.includes&&!e.includes("-")&&(n=`{"operationName":"GetListingDetailByItemId","variables":{"isLoggedIn":false,"itemId":${e},"vehicleHistoryExperiment":"vinaudit_1"},"query":"query GetListingDetailByItemId($itemId: Int!, $vehicleHistoryExperiment: String, $isLoggedIn: Boolean = false, $deviceLocation: DeviceLocation) {\\n  listing(\\n    itemId: $itemId\\n    vehicleHistoryExperiment: $vehicleHistoryExperiment\\n    deviceLocation: $deviceLocation\\n  ) {\\n    ...listingDetail\\n    __typename\\n  }\\n}\\n\\nfragment listingDetail on Listing {\\n  id\\n  badges\\n  condition\\n  description\\n  discussionCount\\n  distance {\\n    unit\\n    value\\n    __typename\\n  }\\n  extractedAttributes {\\n    attributeName\\n    attributeValue\\n    attributeValueSource\\n    __typename\\n  }\\n  fulfillmentDetails {\\n    buyItNowEnabled\\n    canShipToBuyer\\n    estimatedDeliveryDateEnd\\n    estimatedDeliveryDateStart\\n    localPickupEnabled\\n    sellerPaysShipping\\n    shippingEnabled\\n    shippingParcelId\\n    shippingPrice\\n    showAsShipped\\n    __typename\\n  }\\n  isFirmOnPrice\\n  isLocal\\n  isMerchantItem\\n  lastEdited\\n  listingCategory {\\n    categoryAttributeMap {\\n      attributeName\\n      attributePriority\\n      attributeUILabel\\n      attributeValue\\n      attributeValueSource\\n      __typename\\n    }\\n    categoryV2 {\\n      id\\n      l1Id\\n      l1Name\\n      l2Id\\n      l2Name\\n      l3Id\\n      l3Name\\n      name\\n      __typename\\n    }\\n    __typename\\n  }\\n  listingDetailAds {\\n    adTiles {\\n      ...adsGoogleDisplayAd\\n      __typename\\n    }\\n    placements {\\n      adTileConfigs {\\n        adSize {\\n          additionalSizes\\n          height\\n          width\\n          __typename\\n        }\\n        displayType\\n        renderLocation\\n        __typename\\n      }\\n      adType\\n      quantity\\n      __typename\\n    }\\n    __typename\\n  }\\n  listingId\\n  locationDetails {\\n    distance\\n    latitude\\n    locationName\\n    longitude\\n    __typename\\n  }\\n  merchantId\\n  merchantProfile {\\n    avatar {\\n      small {\\n        url\\n        __typename\\n      }\\n      __typename\\n    }\\n    description\\n    emailAddress\\n    legacyUserOwner\\n    phoneNumber\\n    publicLocationName\\n    storeName\\n    ratingSummary {\\n      average\\n      count\\n      __typename\\n    }\\n    __typename\\n  }\\n  originalPrice\\n  originalTitle\\n  owner {\\n    id\\n    profile {\\n      avatars {\\n        squareImage\\n        __typename\\n      }\\n      c2cPhoneNumber {\\n        countryCode\\n        nationalNumber\\n        __typename\\n      }\\n      clickToCallEnabled\\n      dateJoined\\n      isAutosDealer\\n      isSubPrimeDealer\\n      isTruyouVerified\\n      name\\n      notActive\\n      openingHours {\\n        day\\n        hours\\n        __typename\\n      }\\n      phoneNumber\\n      publicLocation {\\n        formattedAddress\\n        latitude\\n        longitude\\n        name\\n        __typename\\n      }\\n      publicLocationName\\n      itemsPurchased\\n      itemsSold\\n      responseTime\\n      ratingSummary {\\n        average\\n        count\\n        __typename\\n      }\\n      reviews {\\n        attributionIcon\\n        average\\n        readMoreUrl\\n        title\\n        userReviews {\\n          profilePhotoUrl\\n          text\\n          __typename\\n        }\\n        __typename\\n      }\\n      websiteLink\\n      __typename\\n    }\\n    __typename\\n  }\\n  ownerId\\n  photos {\\n    uuid\\n    detail {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    detailFull {\\n      url\\n      width\\n      height\\n      __typename\\n    }\\n    detailSquare {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    list {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    medium {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    squareMedium {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    __typename\\n  }\\n  postDate\\n  price\\n  quantity\\n  saved @include(if: $isLoggedIn)\\n  shippingOptions {\\n    maxHandlingDays\\n    maxShippingDays\\n    minHandlingDays\\n    minShippingDays\\n    name\\n    price\\n    priority\\n    __typename\\n  }\\n  shippingRate {\\n    maxDeliveryDays\\n    maxEstimatedDeliveryDate\\n    minDeliveryDays\\n    minEstimatedDeliveryDate\\n    price\\n    priority\\n    __typename\\n  }\\n  sku\\n  state\\n  title\\n  vehicleAttributes {\\n    vehicleBody\\n    vehicleCityMpg\\n    vehicleColor\\n    vehicleDriveTrain\\n    vehicleDriveTrainClean\\n    vehicleEngineCylinders\\n    vehicleEpaCity\\n    vehicleEpaHighway\\n    vehicleExternalHistoryReport {\\n      epochDate\\n      imageUrl\\n      issues\\n      price {\\n        microUnits\\n        __typename\\n      }\\n      providerName\\n      reportUrl\\n      source\\n      __typename\\n    }\\n    vehicleFuelType\\n    vehicleFundamentals\\n    vehicleHighwayMpg\\n    vehicleId\\n    vehicleMake\\n    vehicleMiles\\n    vehicleModel\\n    vehicleStyleDisplay\\n    vehicleTitleStatus\\n    vehicleTransmission\\n    vehicleTransmissionClean\\n    vehicleTrim\\n    vehicleVin\\n    vehicleYear\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment adsGoogleDisplayAd on GoogleDisplayAd {\\n  ...baseGoogleDisplayAd\\n  renderLocation\\n  tileType\\n  __typename\\n}\\n\\nfragment baseGoogleDisplayAd on GoogleDisplayAd {\\n  ouAdId\\n  adExperimentId\\n  adHeight\\n  adMediationId\\n  adNetwork\\n  adRequestId\\n  adWidth\\n  clientId\\n  contentUrl\\n  displayAdType\\n  errorDrawable {\\n    actionPath\\n    listImage {\\n      height\\n      url\\n      width\\n      __typename\\n    }\\n    __typename\\n  }\\n  experimentDataHash\\n  personalizationProperties {\\n    key\\n    values\\n    __typename\\n  }\\n  type\\n  __typename\\n}\\n"}`);try{async function r(t){return fetch("https://offerup.com/api/graphql",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0",Accept:"*/*","Accept-Language":"en-US,en;q=0.5","content-type":"application/json","x-ou-d-token":"web-8a263c39445e93084073408011803c17b413d18fa91fafb9f64f706f","x-ou-f-token":"6af29b25b551922205a90937fd164603",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6IntcImNpdHlcIjpcIkZvcnQgTGF1ZGVyZGFsZVwiLFwic3RhdGVcIjpcIkZMXCIsXCJ6aXBDb2RlXCI6XCIzMzMyMlwiLFwibG9uZ2l0dWRlXCI6LTgwLjI3NjgsXCJsYXRpdHVkZVwiOjI2LjE0ODZ9In0.Tjhlca2iBpxc6-SCQFImXWks2GnHjXnczrLRnDDbXOo","ou-browser-user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0","Proxy-Authorization":"Basic dHJhZGVhcHBsZXM6YXBwbGVzdHJhZGU2OQ=="},referrer:`https://offerup.com/item/detail/${e}?q=iphone`,body:n,method:"POST",mode:"cors"}).then((async e=>(0,i.handleFetchErrors)(e))).then((e=>e.text())).catch((async e=>(console.error("Fetch Failed (fetchListingDetail)",e,t),t&&t>6?"":(await(0,a.retryDelayWithMessage)(`Failed to fetch listing details. API failed: ${e}`),t||(t=0),r(t+=1)))))}return r().then((async e=>{try{return e&&e.match&&e.match(/currently serve areas outside of the US/i)?{error:"Proxy Failed",error_code:"proxy-failed"}:JSON.parse(e)}catch(t){return await(0,s.Z)({error:"Failed to parse fetchListingDetail api response.",x:e}),{}}})).then((async e=>e&&"proxy-failed"===e.error_code?(console.error("Proxy Failed - Got Error: Currently serve areas outside of the US"),""):e.data&&e.data.listing?e.data.listing:(console.error("Failed to get listing details",e),console.trace(),await(0,s.Z)({error:"Failed to get listing details",details:e}),""))).catch((e=>(console.error("Fetch Failed (fetchListingDetail))",e),"")))}catch(l){if(!t)return await(0,a.retryDelayWithMessage)(`Failed to fetch listing details. API failed: ${l}`),o(e,!0)}}},8365:(e,t,n)=>{"use strict";n.d(t,{R:()=>o,x:()=>r});var i=n(3539),a=n(3613),s=n(7367);async function o(e){let t=document.querySelector("#ta #title_must_include").value;const n=e.length,o=[...e];e=e.filter((e=>{const n=e.tile&&e.tile.title;if(!n)return!1;t=t.trim().replace(/,+$/,"");let i=t.split(",").map((e=>e.trim())).join("|");i.startsWith("|")&&(i=i.substring(1)),i.endsWith("|")&&(i=i.substring(0,i.length-1));const a=new RegExp(i,"i");return!!n.match(a)}));const r=[],l=o.filter((t=>!e.includes(t)));l.forEach((async e=>{const t=e.tile&&e.tile.title,n=e.tile&&e.tile.id;if(n){const e=(0,a.skips)().saveToSkipListing(n,`Title does not contain match. Title = ${t}`);r.push(e)}})),(await(0,s.stats)()).addSkipped(l.length),await Promise.all(r);const d=e.length;return d!==n&&(0,i.CONSOLE_MESSAGE)("skip_no_keyword",{num_listings:n-d}),e}function r(e){let t=document.querySelector("#ta #title_must_include").value;const n=e.title;if(!n)return!1;t=t.trim().replace(/,+$/,"");let i=t.split(",").map((e=>e.trim())).join("|");i.startsWith("|")&&(i=i.substring(1)),i.endsWith("|")&&(i=i.substring(0,i.length-1));const a=new RegExp(i,"i");return!!n.match(a)}},6198:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addFollowupEntry:()=>_,followup:()=>f});var i=n(9217),a=n(1334),s=n(4904);function o(e,t){const n=new Date(t);return(new Date-n)/1e3/60>=e}var r=n(1203),l=n(3539),d=n(4484),c=n(9107),u=n(3177),p=n(4246),m=n(8329);async function g(e){let t,n="",a="",s=await(0,m.z)().followup_1,o=await(0,m.z)().followup_2,g=await(0,m.z)().followup_3,h=s,f="1";if(e.last_template_sent&&("1"===e.last_template_sent?o?(h=o,f="2"):g&&(h=g,f="3"):"2"===e.last_template_sent&&g&&(h=g,f="3")),h){const s=await async function(e,t,n,a,s,o){const m=e,g=t,h=function(e){try{let t=document.querySelector("#ta #keywords").value.split("\n").map((e=>e.trim())).join("|");t.startsWith("|")&&(t=t.substring(1)),t.endsWith("|")&&(t=t.substring(0,t.length-1));const n=new RegExp(t,"i");if(e.match(n))return e.match(n)[0]}catch(t){(0,d._apiSendBug)({location:"getKeywordMatched",err:t,extra:{title:e}})}}(g),f=s.price;let _;if(o){o=(0,c.e)(o,n,f,h,g);const e=await(0,i.apiOfferUp)(window.runningInstanceId).sendMessage(m,o,g,a,n);if("STOP"===e)return void console.log("Stopped sending messages to user because other user is blocked.");if(e.error)return void console.log(e.error);_||(_=e),(0,l.CONSOLE_MESSAGE)("message_sent",{message_sent:o,listing_price:f,listing_id:m,listing_name:g});const t=1e3*(0,u.randomIntFromInterval)(r.messageDelay[0],r.messageDelay[1]),s=(new Date).getTime()+t;return(0,l.CONSOLE_MESSAGE)("timeout",{message:"Message Sent",hh:moment(s).format("HH"),mm:moment(s).format("mm"),ss:moment(s).format("ss")}),await(0,p.sleep)(t),{message:o,postMsgId:_}}}(e.listingid,e.listingTitle,e.ownername,e.ownerid,e.listingData,h);s&&(h=s.message,!t&&s.postMsgId&&(t=s.postMsgId)),n&&(n+="\n"),n+=h,a&&(a+=", "),a+=`followup${f}`;const m={last_template_sent:f};let _=!1;return"1"===f?o||g||(_=!0):"2"===f?g||(_=!0):"3"===f&&(_=!0),_&&(await async function(){t&&(t.thread_id&&(t=t.thread_id),document.querySelector("#switch-deleteaftersend").checked&&(await(0,i.apiOfferUp)(window.runningInstanceId).deleteMessage(t),console.log("Conversation Archived")))}(),m.isLastMessageSent=!0),m}return{isLastMessageSent:!0}}const h="toFollowUp";async function f(){if(!(document.getElementById("followup_1").value||document.getElementById("followup_2").value||document.getElementById("followup_3").value))return void console.log("No followup message to send");let e=await(0,a.gI)(h);if(!e)return console.log("No followup entry found."),e;e=JSON.parse(e);const t=function(e){const t=[];return e.forEach((e=>{const n=e.read,i=e.dateAdded,a=e.sender.id,s=e.sender.profile.firstName;n&&t.push({ownerid:a,ownername:s,lastUpdate:i})})),t}(await(0,i.apiOfferUp)().getInboxThreads());let n=!1;for(let i=e.length-1;i>=0;i--){const r=e[i],l=r.tsLastMsg||r.tsAdded;if(o(document.getElementById("followup_after").value,l)){const o=r.ownername,d=r.ownerid,c=r.listingTitle,u=t.find((e=>e.ownerid===d));if(u&&new Date(u.lastUpdate)<=new Date(l)){console.log(`Entry is due for followup [${o}] [${c}]`);const t=await g(r);t.isLastMessageSent?(console.log("last followup message was sent. Will remove followup entry."),e.splice(i,1)):(t.last_template_sent&&(r.last_template_sent=t.last_template_sent),r.tsLastMsg=(new Date).toISOString()),n=!0,console.log(`Followup message has been sent to listing [${o}] [${c}]`),await(0,a.Q5)(h,JSON.stringify(e)),await(0,s.Xh)(`FollowUp #${t.last_template_sent||"3"} sent.`)}else console.log(`Has new message. Will not follow up [${o}] [${c}]}`),e.splice(i,1),await(0,a.Q5)(h,JSON.stringify(e))}}n&&console.log("Done sending followups")}async function _(e,t){if(!e)return void console.error("Failed to add followup entry. Missing listingid");let n=await(0,a.gI)(h);n||(n="[]"),n=JSON.parse(n);const i=new Date;i.setMinutes(i.getMinutes()+1);const s=i.toISOString(),o=t.owner.id,r=t.owner.profile.name,l=t.title||t.originalTitle,d={listingid:e,listingTitle:l,ownerid:o,ownername:r,tsAdded:s,listingData:t},c=n.find((t=>t.listingid===e));if(c&&n.indexOf(c)>-1){const e=n.indexOf(c);n[e]=d}else n.push(d);await(0,a.Q5)(h,JSON.stringify(n))}},9395:(e,t,n)=>{"use strict";function i(e,t){const n={};for(const t in e)"title"!==t&&"price"!==t&&"description"!==t&&"locationDetails"!==t&&"photos"!==t&&"owner"!==t&&(n[t]=e[t]);delete n.photos;for(const e in n)if((e.startsWith("__")||null===n[e])&&delete n[e],"object"==typeof n[e])for(const t in n[e])(t.startsWith("__")||null===n[e][t])&&delete n[e][t];let i="";var a;if(i+=`Title: ${e.title}\n`,i+=`Price: ${e.price}\n`,n.condition&&(i+=`Condition: ${a=n.condition,100===a?"New":80===a?"Reconditioned/Certified":60===a?"Open Box (never used)":40===a?"Used (normal wear)":20===a?"For Parts":0===a?"Other (see description)":void 0}\n`),i+=`Description: ${e.description}\n`,i+="# Seller Details\n",i+=`Name: ${e?.owner?.profile?.name}\n`,e?.locationDetails?.locationName&&(i+=`Location: ${e?.locationDetails?.locationName}\n`),e?.locationDetails?.latitude&&(i+=`Latitude: ${e?.locationDetails?.latitude}\n`),e?.locationDetails?.longitude&&(i+=`Longitude: ${e?.locationDetails?.longitude}\n`),i+="Rating Summary:\n",i+=` - average: ${e?.owner?.profile?.ratingSummary.average}\n`,i+=` - count: ${e?.owner?.profile?.ratingSummary.count}\n`,i+=`Join Date: ${new Date(e?.owner?.profile?.dateJoined).toLocaleString("default",{month:"long",year:"numeric"})}\n`,i+="# Additional Listing Details\n",console.log("additionalInfo?.vehicleAttributes",n?.vehicleAttributes),n?.vehicleAttributes)for(const e in n.vehicleAttributes){let t=n.vehicleAttributes[e];(Array.isArray(t)||"object"==typeof t)&&(t=JSON.stringify(t)),i+=`${e}: ${t}\n`}(t=t.filter((t=>t.id!==e.id&&t.listingId!==e.id))).length&&(i+="# Other Seller Listings:\n",i+=t.map((e=>`- Title: ${e.title}, Price: ${e.price}`)).join("\n"));const s={text:i},o=e.photos;return o&&o.length>0&&(s.photos=o.map((e=>{const t=e.detailFull||e.detail;return t?t.url:null})),s.photos=s.photos.filter((e=>e))),s.listingDetails=e,s}n.d(t,{r:()=>i})},3372:(e,t,n)=>{"use strict";function i(){return Math.round(1e3*Math.random())}n.r(t),n.d(t,{generateId:()=>i})},9237:(e,t,n)=>{"use strict";function i(e){const t=new Date,n=new Date(e);return Math.floor((t-n)/864e5)}function a(e){const t=new Date,n=new Date(e);return Math.floor((t-n)/36e5)}n.d(t,{f:()=>i,h:()=>a})},3539:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CONSOLE_MESSAGE:()=>l,getConsoleMessages:()=>r});var i=n(1203),a=n(2287),s=n(6849),o=n(7091);async function r(){if(window.consoleMessages)return window.consoleMessages;const e=await fetch(`https://sheets.hopla.tools/?HT=${i.sheet_id}&format=json&sheet_name=ConsoleLog`).then((async e=>(0,a.handleFetchErrors)(e))).then((e=>e.text())).then((async e=>{try{return JSON.parse(e)}catch(t){return await(0,s.Z)({error:"Failed to parse getConsoleMessages api response.",x:e}),{}}}));if(e&&e.result){window.consoleMessages={};for(const t of e.result)t.variable&&(window.consoleMessages[t.variable]=t.message||"");return window.consoleMessages}return await(0,s.Z)({error:"Failed to get console messages."}),console.error("Failed to get console message"),{}}function l(e,t,n){if(function(e){return e="object"==typeof e?JSON.stringify(e):e,window.lastLog?window.lastLog===e||void(window.lastLog=e):(window.lastLog=e,!1)}(t||e))return;if("custom"===e)return window.lastLog=t,void(0,o.showLastConsoleLog)(t);if(!window.consoleMessages)return console.error("Called consoleMessage without initiating."),"";let i=window.consoleMessages[e];if(t)for(const e in t){const n=new RegExp(`{${e}}`,"gi");i=i.replace(n,t[e]||"")}(0,o.showLastConsoleLog)(i)}},5836:(e,t,n)=>{"use strict";function i(){let e=localStorage.getItem("lastZipIdx")||0;e=parseInt(e,10);let t=localStorage.getItem("lastKwIdx");t=t?parseInt(t,10)+1:0;let n=document.querySelector("#ta #keywords").value,a=document.querySelector("#ta #searchwithfilters").value;if(a&&(n+="\n"+a),!n)return console.error("No keywords found."),alert("No keywords found."),{error:"no keyword found"};n=n.split("\n").map((e=>e.trim()));let s=document.querySelector("#ta #zipcodes").value;if(!s)return console.error("No zipcodes input found."),alert("No zipcodes input found."),{error:"no zipcodes found"};s=s.split("\n").map((e=>e.trim()));let o=!1;return t>=n.length&&(t=0,e+=1,e>=s.length&&(e=0,o=!0)),localStorage.setItem("lastKwIdx",t),localStorage.setItem("lastZipIdx",e),String(n[t]).trim().length?{keyword:n[t],zipcode:s[e],isEnd:o}:i()}async function a(){let e=document.querySelector("#ta #title_must_include").value;return e?(e=e.trim().replace(/,+$/,""),e=e.split(",").map((e=>e.trim())),e):(console.error("No keywords found."),{error:"no keyword found"})}n.d(t,{W:()=>a,e:()=>i})},9105:(e,t,n)=>{const{sheet_id:i}=n(1203)},8414:(e,t,n)=>{"use strict";async function i(e){return fetch(`https://us-central1-trade-apples.cloudfunctions.net/partners?getpartnerdetails=1&uid=${e}`).then((e=>e.json()))}n.r(t),n.d(t,{getPartnerDetails:()=>i})},2646:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getQuote:()=>d});const i=e=>e?e=(e=e.replace(/\[.+?\]/,"")).trim():"";var a=n(3539),s=n(6849);async function o(){try{if(window.kvJson)return window.kvJson;const e=await fetch("https://prices.phones.trade/?kvread=key_values").then((e=>e.json()));return window.kvJson=e,e}catch(e){return console.log("error",e),await(0,s.Z)({error:"Failed to get key values from prices endpoint"}),""}}function r(e){if(e&&e.match(/internal/i))return"internal";let t=e;const n=e.match(/\[(.+)\]/);let i="";return n&&(i=n[1].trim(),t=t.replace(`[${i}]`,"").trim(),t=t.split("-"),t=t.length>1?t[1].trim():t[0].trim()),t}async function l(e){const t=await o();if(!t)return"";const n=t.bykey;return n&&n[e]||""}async function d(e,t){console.log("Getting quote.."),(0,a.CONSOLE_MESSAGE)("custom",`Getting quote of listing (${t})`);const n=e.model||"13promax",s=e.storage,d=e.network,c=e.condition||"likenew",u=e.deductions||"";let p,m;e.model&&e.storage&&e.network&&e.condition&&e.deductions||console.log("Found case with missing variant details.",e,t);const g=await async function(e){const t=(await o()).bykey;let n=[];if(!t)return"";const i=Object.keys(t).filter((e=>e.startsWith("M")));for(const e of i)n.push({key:e,value:t[e]});e&&!e.startsWith("iphone")&&(e="iphone"+e);for(const t of n){let n=t.value;if(n=n.toLowerCase().replace(/\s+/g,""),"iphonese2020"===n&&(n="iphonese2"),"iphonese2022"===n&&(n="iphonese3"),n===e)return t.key}}(n);s&&(p=await async function(e){const t=await o();return e=e.toUpperCase(),t.byvalue[e]}(s)),d&&(m=await async function(e){const t=await o(),n=Object.keys(t.bykey).filter((e=>e.startsWith("N")));for(const a of n){const n=i(t.bykey[a]);if(e.toLowerCase()===n.toLowerCase())return a}}(d));const h=await async function(e){const t=(await o()).bykey,n=[];if(!t)return"";const i=Object.keys(t).filter((e=>e.startsWith("C")));for(const e of i)n.push({key:e,value:t[e]});e&&(e=e.toLowerCase().replace(/\s+/g,""));for(const t of n){let n=t.value;if(n=r(n),n=n.toLowerCase().replace(/\s+/g,""),n===e)return t.key}return""}(c),f=await function(e){const t=[];e&&e.forEach((e=>{let n;switch(e){case"touchid issue":case"faceid issue":n="D3";break;case"crackedback":case"crackediphone":n="D1";break;case"simcard reading issue":n="D5";break;case"wifiissues":case"wifiproblems":n="D4";break;case"camera issues":case"cameraproblems":case"brokencamera":n="D2";break;case"crackedcameralens":n="D13"}n&&t.push(n)}))}(u);console.log("deductionKeys",f);const _={model:i(await l(g)),condition:i(await l(h))};if(p&&(_.storage=i(await l(p))),m&&(_.network=i(await l(m))),f&&Array.isArray(f)){const e=f.map((e=>{console.log("key",e);let t=l(x);return i(t)}));_.deductions=e}u&&u.includes("icloud")&&(p="S5",m="N6"),console.log("modelKey",g),console.log("storageKey",p),console.log("networkKey",m),console.log("conditionKey",h),console.log("deductionKeys",f);const y=await async function(e,t,n,i,a){let s=a?a.join("-"):"";return s&&(s=`&deductions=${s}`),await fetch(`https://prices.phones.trade/?getvariantprice=1&model=${e}&storage=${t||""}&network=${n||""}&condition=${i||""}${s}`).then((e=>e.text())).then((e=>{try{return JSON.parse(e)}catch(e){return{}}}))}(g,p,m,h,f);return console.log("price",y.price),!p&&y.storageKey&&(_.storage=i(await l(y.storageKey))),!m&&y.networkKey&&(_.network=i(await l(y.networkKey))),_.price=y.price,_}},2617:(e,t,n)=>{"use strict";function i(){if(window.userEmail)return window.userEmail;try{const e=document.querySelector("#__NEXT_DATA__").textContent,t=JSON.parse(e);for(const e in t.props.pageProps.initialApolloState)if(e.startsWith("User")&&t.props.pageProps.initialApolloState[e].account){window.userEmail=t.props.pageProps.initialApolloState[e].account.email;break}return window.userEmail}catch(e){console.error(e)}}n.r(t),n.d(t,{getUserEmail:()=>i})},5458:(e,t,n)=>{"use strict";function i(e,t){if(!e)return"";for(const n of e)if(n.attributeName===t&&Array.isArray(n.attributeValue)&&n.attributeValue.length)return n.attributeValue[0].toLowerCase();return""}n.r(t),n.d(t,{getVariant:()=>g});var a=n(4347);async function s(e){const t=await(0,a.fetchListingDetail)(e);if(!t)return{};const n=t.listingCategory.categoryAttributeMap;let{title:i,description:s,condition:o,price:r}=t;return i||(i=""),s||(s=""),o||(o=""),r||(r=""),{title:i,description:s,condition:o,price:r,attributes:n}}window.getItemInfo=s;var o=n(1203),r=n(2287),l=n(4484);async function d(){console.log("Fetching model matches1.");let e=await fetch(`https://sheets.hopla.tools/?HT=${o.sheet_id}&format=json&sheet_name=model`).then((async e=>(0,r.handleFetchErrors)(e))).then((e=>e.text())).catch((e=>{(0,l._apiSendBug)({error:"Failed to get model matches.",e:e.toString()}),alert("Failed to get model matches.")}));if(e&&!e.includes("13promax"))return d();e=JSON.parse(e),console.log("Model matches has been fetched.",e);const t={};return e.result&&Array.isArray(e.result)&&e.result.length?(e.result.forEach((e=>{for(const n in e)t[n]||(t[n]=[]),e[n]&&t[n].push(e[n])})),t):((0,l._apiSendBug)({error:"Failed to get model matches.",x:e}),alert("Failed to get model matches."),t)}async function c(){console.log("Fetching storage matches.");let e=await fetch(`https://sheets.hopla.tools/?HT=${o.sheet_id}&format=json&sheet_name=storage`).then((async e=>(0,r.handleFetchErrors)(e))).then((e=>e.text())).catch((e=>{(0,l._apiSendBug)({error:"Failed to get storage matches.",e:e.toString()}),alert("Failed to get model matches.")}));if(e&&!e.includes("256gb"))return c();e=JSON.parse(e),console.log("Storage matches has been fetched.");const t={};return e.result&&Array.isArray(e.result)&&e.result.length?(e.result.forEach((e=>{for(const n in e)t[n]||(t[n]=[]),e[n]&&t[n].push(e[n])})),t):((0,l._apiSendBug)({error:"Failed to get storage matches.",x:e}),alert("Failed to get storage matches."),t)}async function u(){console.log("Fetching network matches.");let e=await fetch(`https://sheets.hopla.tools/?HT=${o.sheet_id}&format=json&sheet_name=network`).then((async e=>(0,r.handleFetchErrors)(e))).then((e=>e.text())).catch((t=>{(0,l._apiSendBug)({error:"Failed to get network matches.",x:e}),alert("Failed to get network matches.")}));if(e&&!e.includes("unlocked"))return u();e=JSON.parse(e),console.log("Network matches has been fetched.");const t={};return e.result&&Array.isArray(e.result)&&e.result.length?(e.result.forEach((e=>{for(const n in e)t[n]||(t[n]=[]),e[n]&&t[n].push(e[n])})),t):((0,l._apiSendBug)({error:"Failed to get network matches.",x:e}),alert("Failed to get network matches."),t)}async function p(){console.log("Fetching deduction matches.");let e=await fetch(`https://sheets.hopla.tools/?HT=${o.sheet_id}&format=json&sheet_name=deductions`).then((async e=>(0,r.handleFetchErrors)(e))).then((e=>e.text())).catch((e=>{(0,l._apiSendBug)({error:"Failed to get deduction matches.",e:e.toString()}),alert("Failed to get deduction matches.")}));if(e&&!e.includes("icloud"))return p();e=JSON.parse(e),console.log("Deduction matches has been fetched.");const t={};return e.result&&Array.isArray(e.result)&&e.result.length?(e.result.forEach((e=>{for(const n in e)t[n]||(t[n]=[]),e[n]&&t[n].push(e[n])})),t):((0,l._apiSendBug)({error:"Failed to get deduction matches.",x:e}),alert("Failed to get deduction matches."),t)}var m=n(8927);async function g(e){window.textMatchIndex={},window.textMatchIndex[e]={};const t=await s(e),n={};return n.model=await async function(){const n=t.title&&t.title.toLowerCase(),a=t.description&&t.description.toLowerCase(),s=i(t.attributes,"model"),o=["11promax","11pro","11","xsmax","xs","xr","x","8plus","8","7plus","7","se2","12promax","12pro","12mini","12","13promax","13pro","13mini","13","6plus","6splus","6s","6"];if(!window.modelMatches){const e=await d();window.modelMatches=[];const t=[];for(const n in e)o.includes(n)||t.push(n);const n=t.filter((e=>e.endsWith("promax"))),i=t.filter((e=>e.endsWith("pro"))),a=t.filter((e=>e.endsWith("plus"))),s=t.filter((e=>!e.endsWith("promax")&&!e.endsWith("pro")&&!e.endsWith("plus")));t.length=0,t.push(...n),t.push(...i),t.push(...a),t.push(...s),o.push(...t),o.forEach((t=>{window.modelMatches.push([t,e[t]])}))}const r=window.modelMatches;for(const t of r){const i=t[0],o=t[1];if(Array.isArray(o))for(const t of o){const o=new RegExp(t,"i");let r=s&&s.match(o);if(r)return window.textMatchIndex[e].modelFromAttribute||(window.textMatchIndex[e].modelFromAttribute={}),window.textMatchIndex[e].modelFromAttribute.model={rgx:o},i;if(r=n&&n.match(o),r)return window.textMatchIndex[e].title||(window.textMatchIndex[e].title={}),window.textMatchIndex[e].title.model={rgx:o},i;if(r=a&&a.match(o),r)return window.textMatchIndex[e].description||(window.textMatchIndex[e].description={}),window.textMatchIndex[e].description.model={rgx:o},window.textMatchIndex[e].model={via:"description",index:r.index,length:o.source.length},i}}for(const e of r){const t=e[0],n=e[1];if(console.log("keyMatches",n),n)for(const e of n){const n=new RegExp(e,"i");if(s&&s.match(n))return t;if(a&&a.match(n))return t}}}(),n.storage=await async function(){const i=t.title&&t.title.toLowerCase(),a=t.description&&t.description.toLowerCase();window.storageMatches||(window.storageMatches=await c());const s=window.storageMatches,o={"16gb":["16\\s?gb"]};for(const t in s){const n=s[t];for(const s of n){const n=new RegExp(s,"i");if(i&&i.match(n))return window.textMatchIndex[e].title||(window.textMatchIndex[e].title={}),window.textMatchIndex[e].title.storage={rgx:n},t;if(a&&a.match(n))return window.textMatchIndex[e].description||(window.textMatchIndex[e].description={}),window.textMatchIndex[e].description.storage={rgx:n},t}}for(const e in o){const t=o[e];for(const s of t){const t=new RegExp(s,"i");if(i&&i.match(t))return n.skip=!0,e;if(a&&a.match(t))return n.skip=!0,e}}}(),n.network=await async function(){const n=t.title&&t.title.toLowerCase(),a=t.description&&t.description.toLowerCase(),s=i(t.attributes,"carrierNetwork"),o=["unlocked","locked"];if(!window.networkMatches){const e=await u();window.networkMatches=[],o.forEach((t=>{window.networkMatches.push([t,e[t]])}))}const r=window.networkMatches;for(const t of r){const i=t[0],o=t[1];for(const t of o){const o=new RegExp(t,"i");if(s&&s.match(o))return window.textMatchIndex[e].networkFromAttribute||(window.textMatchIndex[e].networkFromAttribute={}),window.textMatchIndex[e].networkFromAttribute.network={rgx:o},i;if(n&&n.match(o))return window.textMatchIndex[e].title||(window.textMatchIndex[e].title={}),window.textMatchIndex[e].title.network={rgx:o},i;if(a&&a.match(o))return window.textMatchIndex[e].description||(window.textMatchIndex[e].description={}),window.textMatchIndex[e].description.network={rgx:o},i}}}(),n.condition=await function(){if(t&&t.condition){if(100===t.condition)return"likenew";if(80===t.condition)return"likenew";if(60===t.condition)return"new";if(40===t.condition)return"likenew";if(20===t.condition)return n.skip=!0,console.log("Skipped because condition is For Parts."),"dead";if(0===t.condition)return"likenew"}}(),n.deductions=await async function(){const n=t.title&&t.title.toLowerCase(),i=t.description&&t.description.toLowerCase(),a=["icloud","crackedcameralens","faceid issue"];if(!window.deductionMatches){const e=await p();window.deductionMatches=[],a.forEach((t=>{window.deductionMatches.push([t,e[t]])}))}const s=window.deductionMatches,o=[];for(const t of s){const a=t[0],s=t[1];for(const t of s){const s=new RegExp(t,"i");n&&n.match(s)?(window.textMatchIndex[e].title||(window.textMatchIndex[e].title={}),window.textMatchIndex[e].title.deductions||(window.textMatchIndex[e].title.deductions=[]),window.textMatchIndex[e].title.deductions.push(s),o.push(a)):i&&i.match(s)&&(window.textMatchIndex[e].description||(window.textMatchIndex[e].description={}),window.textMatchIndex[e].description.deductions||(window.textMatchIndex[e].description.deductions=[]),window.textMatchIndex[e].description.deductions.push(s),o.push(a))}}return o}(),t.price?n.listing_price=parseFloat(t.price):n.listing_price=0,window.lastVariant=n,async function(e,t){let n;if(e?n=e:window.location.href.includes("inbox/message/")&&(n=await(0,m.t)()),!n)return;window.bugReport={};const a=t||await s(n);window.bugReport.listingId=n;const o=i(a.attributes,"model"),r=i(a.attributes,"carrierNetwork");if(document.querySelector("#buglistingdetails").innerHTML="",document.querySelector("#bugvariantdetails").innerHTML="",l("URL",window.location.href),a.title){let e=a.title;e=c(e,"title"),l("Title",e),window.bugReport.listing_title=e}if(a.description){let e=a.description;e=c(e,"description"),l("Description",e),window.bugReport.listing_description=e}if(o){let e=o;e=c(e,"modelFromAttribute"),l("Model",e),window.bugReport.listing_detail_model=e}if(r){let e=r;e=c(e,"networkFromAttribute"),l("Network",e),window.bugReport.listing_detail_network=e}function l(e,t){document.querySelector("#buglistingdetails").innerHTML+=` <div class="report-detail">\n                            <span class="label">${e}</span>\n                            <span id="itemtitle">${t}</span>\n                          </div>`}function d(e,t){document.querySelector("#bugvariantdetails").innerHTML+=` <div class="report-detail">\n                            <span class="label">${e}</span>\n                            <span id="itemtitle">${t}</span>\n                          </div>`}function c(e,t){if(window.textMatchIndex[n]&&window.textMatchIndex[n][t]){if(window.textMatchIndex[n][t].model){const i=window.textMatchIndex[n][t].model.rgx;e=e.replace(i,(e=>`<strong class="blue">${e}</strong>`))}if(window.textMatchIndex[n][t].storage){const i=window.textMatchIndex[n][t].storage.rgx;e=e.replace(i,(e=>`<strong class="green">${e}</strong>`))}if(window.textMatchIndex[n][t].network){const i=window.textMatchIndex[n][t].network.rgx;e=e.replace(i,(e=>`<strong class="purple">${e}</strong>`))}if(window.textMatchIndex[n][t].deductions){const i=window.textMatchIndex[n][t].deductions;for(const t of i)e=e.replace(t,(e=>`<strong class="red">${e}</strong>`))}}return e}window.lastVariant&&(window.lastVariant.model&&(window.bugReport.model=window.lastVariant.model,d("Model",window.lastVariant.model)),window.lastVariant.storage&&(window.bugReport.storage=window.lastVariant.storage,d("Storage",window.lastVariant.storage)),window.lastVariant.network&&(window.bugReport.network=window.lastVariant.network,d("Network",window.lastVariant.network)),window.lastVariant.condition&&(window.bugReport.condition=window.lastVariant.condition,d("Condition",window.lastVariant.condition)))}(e,t),n}window.getVariant=g},3119:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var i=n(6849);async function a(e){return fetch(`https://us-central1-trade-apples.cloudfunctions.net/partners?getDomain=1&uid=${e}`).then((e=>e.text())).then((t=>{try{const n=JSON.parse(t);let i=n&&n.domain;return i||(i=`${e}.tradeapples.com`),`https://${i}`}catch(t){return`https://${e}.tradeapples.com`}})).catch((t=>((0,i.Z)({error:"getWebsiteVariable failed.",detail:t.toString()}),`https://${e}.tradeapples.com`)))}},2497:(e,t,n)=>{"use strict";n.r(t),n.d(t,{setupGlobalErrorHandlers:()=>s});var i=n(4484),a=n(6186);function s(){window.onerror=function(e,t,n,a,s){const o={error:"Uncaught error",message:s?.toString()||e?.toString(),errorObject:s,url:t,lineNumber:n,columnNumber:a,stack:s?.stack||(new Error).stack,timestamp:(new Date).toISOString()};return console.error("Global error caught:",o),(0,i._apiSendBug)(o),!1},window.onunhandledrejection=function(e){const t=e.reason,n={error:"Unhandled Promise Rejection",message:t?.toString()||"Unknown promise rejection",errorObject:t,stack:t?.stack||(new Error).stack,url:window.location.href,lineNumber:t?.line,columnNumber:t?.column,timestamp:(new Date).toISOString()};console.error("Unhandled promise rejection:",n),(0,i._apiSendBug)(n),(0,a.s)("Bot is restarting in ",60).then((()=>{window.location.reload()}))},window.addEventListener("error",(function(e){const t=e.error,n={error:"Error Event",message:t?.toString()||e.message,errorObject:t,url:e.filename||window.location.href,lineNumber:e.lineno,columnNumber:e.colno,stack:t?.stack||(new Error).stack,timestamp:(new Date).toISOString()};console.error("Error event caught:",n),(0,i._apiSendBug)(n)}),!0)}},2287:(e,t,n)=>{"use strict";function i(e){return new Promise(((t,n)=>window.isRun?e.ok?void t(e):(console.trace(),void setTimeout((()=>{n(e.statusText)}),1e4)):t(e)))}n.r(t),n.d(t,{handleFetchErrors:()=>i})},6722:(e,t,n)=>{"use strict";function i(e){window.HOPLA_login=HOPLA_login,HOPLA_login.init({projectid:"-MuH8erCc-DO-GAWvO7v",onready:function(){console.log("User Details",HOPLA_login.user),console.log("You are logged in as ",HOPLA_login.user.uid),"function"==typeof e&&e(HOPLA_login.user)}})}n.r(t),n.d(t,{injectHoplaLogin:()=>i})},7731:(e,t,n)=>{"use strict";n.r(t),n.d(t,{injectLogger:()=>a});const{showLastConsoleLog:i}=n(7091);function a(){void 0===window.everything&&(window.everything=[],console.defaultLog=console.log.bind(console),console.log=function(){i(Array.from(arguments).join(" ")),window.everything.push({type:"log",datetime:(new Date).getTime(),value:Array.from(arguments)}),console.defaultLog.apply(console,[(new Date).toLocaleString(),...arguments])},console.defaultError=console.error.bind(console),console.error=function(){i(Array.from(arguments).join(" ")),window.everything.push({type:"error",datetime:(new Date).getTime(),value:Array.from(arguments)}),console.defaultError.apply(console,arguments)},console.defaultWarn=console.warn.bind(console),console.warn=function(){window.everything.push({type:"warn",datetime:(new Date).getTime(),value:Array.from(arguments)}),console.defaultWarn.apply(console,arguments)},console.defaultDebug=console.debug.bind(console),console.debug=function(){window.everything.push({type:"debug",datetime:(new Date).getTime(),value:Array.from(arguments)}),console.defaultDebug.apply(console,arguments)})}},4559:(e,t,n)=>{"use strict";function i(){let e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","https://fonts.googleapis.com/icon?family=Material+Icons"),document.head.appendChild(e),e=document.createElement("link"),e.setAttribute("rel","stylesheet"),e.setAttribute("href","https://code.getmdl.io/1.3.0/material.indigo-pink.min.css"),document.head.appendChild(e),e=document.createElement("script"),e.setAttribute("src","https://code.getmdl.io/1.3.0/material.min.js"),document.head.appendChild(e),e=document.createElement("script"),e.setAttribute("src","https://cdnjs.cloudflare.com/ajax/libs/dialog-polyfill/0.4.2/dialog-polyfill.min.js"),document.head.appendChild(e),document.head.insertAdjacentHTML("beforeend","<style>\n    #ta .mdl-switch {\n      width: unset;\n    }\n\n    #__next, .MuiPaper-root {\n      width: calc(100% - 370px) !important;\n      left: 0px !important;\n    }\n    </style>")}n.r(t),n.d(t,{injectMdl:()=>i})},3695:(e,t,n)=>{"use strict";function i(){const e=document.createElement("script");e.setAttribute("src","https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.2/moment.min.js"),document.head.appendChild(e)}n.r(t),n.d(t,{injectMoment:()=>i})},5729:(e,t,n)=>{"use strict";function i(){const e=document.createElement("style");document.head.append(e),e.textContent=".mdl-list__item.taseparator {\n    border-bottom: solid 1px #e0e0e0;\n  }\n  \n  .mdl-list__item.taseparator .mdl-textfield__input {\n    border-bottom: unset;\n    text-align: right;\n  }\n  \n  .mdl-list__item-secondary-action.tawsmall {\n    width: 45px;\n  }\n  \n  [id^=page] .demo-list-control {\n    margin-top: unset;\n    height: calc(100% - 143px);\n    overflow: auto;\n  }\n  \n  #page2 .demo-list-control {\n    /* margin-top: unset;\n    height: fit-content;\n    overflow: auto; */\n    margin-top: unset;\n    height: calc(100% - 219px);\n    overflow: auto;\n  }\n  \n  #ta .mdl-textfield {\n    width: 100%;\n  }\n  \n  /* #ta .mdl-textfield__label {\n    text-align: center;\n  } */\n  \n  .label {\n    font-weight: 700;\n    margin-right: 10px;\n  }\n  \n  #dialog-bug {\n    width: 400px;\n    height: max-content;\n  }\n  \n  .report-detail {\n    display: flex;\n  }\n  \n  #bugvariantdetails {\n    border: solid 1px;\n    padding: 8px;\n  }\n  \n  \n  .blue {\n    color: blue\n  }\n  .green {\n    color: green\n  }\n  .purple {\n    color: purple\n  }\n  .red {\n    color: red\n  }\n  .bgred {\n    background: red !important;\n  }\n\n  .w100 {\n    width: 100%;\n  }\n\n  .h100 {\n    height: 100%\n  }\n\n  .space-between {\n    display: flex;\n    justify-content: space-between;\n  }\n\n  .bgblue {\n    background: rgb(63, 81, 181) !important;\n  }\n\n  .bblue {\n    color: rgb(63, 81, 181) !important;\n  }\n\n  .hoplablue {\n    background-color: #343ca3 !important;\n  }\n  \n  .buttons_container {\n    display: flex;\n    justify-content: space-around;\n    width: 100%;\n    flex-wrap: wrap;\n  }\n\n  .buttons_container > button {\n    margin-top: 14px;\n  }\n  \n  .listing_debugger_container {\n    display: flex;\n    justify-content: flex-start;\n    width: 92%;\n    position: absolute;\n    bottom: 0;\n    flex-direction: column;\n    align-items: stretch;\n    margin-bottom: 30px;\n  }\n\n  .fsmall {\n    font-size: small;\n  }\n\n  .h150 {\n    height: 150px;\n  }\n\n  .nowrap {\n      white-space: pre;\n      overflow-wrap: normal;\n      overflow-x: scroll;\n    }\n\n  .popup-content {\n    min-width: 485px\n  }\n\n  .mb20 {\n    margin-bottom: 20px\n  }\n\n  .login_container {\n    height: 100%;\n  }\n\n  .mdl-menu__container.is-visible {\n    z-index: 9999;\n    position: sticky;\n  }\n  ";const t=document.createElement("style");document.head.append(t),t.textContent=".getmdl-select{outline:none}.getmdl-select .mdl-textfield__input{cursor:pointer}.getmdl-select .selected{background-color:#ddd}.getmdl-select .mdl-icon-toggle__label{float:right;margin-top:-30px;color:rgba(0,0,0,0.4);transform:rotate(0);transition:transform 0.3s}.getmdl-select.is-focused .mdl-icon-toggle__label{color:#3f51b5;transform:rotate(180deg)}.getmdl-select .mdl-menu__container{width:100% !important;margin-top:2px}.getmdl-select .mdl-menu__container .mdl-menu{width:100%}.getmdl-select .mdl-menu__container .mdl-menu .mdl-menu__item{font-size:16px}.getmdl-select__fix-height .mdl-menu__container .mdl-menu{overflow-y:auto;max-height:288px !important}.getmdl-select__fix-height .mdl-menu.mdl-menu--top-left{bottom:auto;top:0}\n/*# sourceMappingURL=getmdl-select.min.css.map */"}n.r(t),n.d(t,{injectStyle:()=>i})},7933:(e,t,n)=>{"use strict";n.r(t),n.d(t,{injectTrackjs:()=>a});var i=n(6849);function a(){try{self.TrackJS=self.trackJs=function(e,t,n){var i=function(e,t){this.config=e,this.onError=t,e.enabled&&this.watch()};i.prototype={watch:function(){m.forEach(["EventTarget","Node","XMLHttpRequest"],(function(t){m.has(e,t+".prototype.addEventListener")&&m.hasOwn(e[t].prototype,"addEventListener")&&this.wrapEventTarget(e[t].prototype)}),this),this.wrapTimer("setTimeout"),this.wrapTimer("setInterval")},wrap:function(e){function t(){try{return e.apply(this,arguments)}catch(e){throw a.onError("catch",e,{bindTime:n,bindStack:i}),m.wrapError(e)}}var n,i,a=this;try{if(!m.isFunction(e)||m.hasOwn(e,"__trackjs__"))return e;if(m.hasOwn(e,"__trackjs_state__"))return e.__trackjs_state__}catch(t){return e}if(a.config.bindStack)try{throw Error()}catch(e){i=e.stack,n=m.isoNow()}for(var s in e)m.hasOwn(e,s)&&(t[s]=e[s]);return t.prototype=e.prototype,t.__trackjs__=!0,e.__trackjs_state__=t},wrapEventTarget:function(e){var t=this;m.has(e,"addEventListener.call")&&m.has(e,"removeEventListener.call")&&(m.patch(e,"addEventListener",(function(e){return function(n,i,a,s){try{m.has(i,"handleEvent")&&(i.handleEvent=t.wrap(i.handleEvent))}catch(e){}return e.call(this,n,t.wrap(i),a,s)}})),m.patch(e,"removeEventListener",(function(e){return function(t,n,i,a){try{n=n&&(n.__trackjs_state__||n)}catch(e){}return e.call(this,t,n,i,a)}})))},wrapTimer:function(t){var n=this;m.patch(e,t,(function(e){return function(t,i){var a=Array.prototype.slice.call(arguments),s=a[0];return m.isFunction(s)&&(a[0]=n.wrap(s)),m.has(e,"apply")?e.apply(this,a):e(a[0],a[1])}}))}};var a=function(e){this.initCurrent(e)||console.warn("[TrackJS] invalid config")};a.prototype={current:{},initOnly:{application:!0,cookie:!0,enabled:!0,token:!0,callback:{enabled:!0},console:{enabled:!0},navigation:{enabled:!0},network:{enabled:!0,fetch:!0},visitor:{enabled:!0},window:{enabled:!0,promise:!0}},defaults:{application:"",cookie:!1,dedupe:!0,dependencies:!0,enabled:!0,forwardingDomain:"",errorURL:"https://capture.trackjs.com/capture",errorNoSSLURL:"http://capture.trackjs.com/capture",faultURL:"https://usage.trackjs.com/fault.gif",usageURL:"https://usage.trackjs.com/usage.gif",onError:function(){return!0},serialize:function(e){function t(e){var t="<"+e.tagName.toLowerCase();e=e.attributes||[];for(var n=0;n<e.length;n++)t+=" "+e[n].name+'="'+e[n].value+'"';return t+">"}if(""===e)return"Empty String";if(e===n)return"undefined";if(m.isString(e)||m.isNumber(e)||m.isBoolean(e)||m.isFunction(e))return""+e;if(m.isElement(e))return t(e);if("symbol"==typeof e)return Symbol.prototype.toString.call(e);var i;try{i=JSON.stringify(e,(function(e,i){return i===n?"undefined":m.isNumber(i)&&isNaN(i)?"NaN":m.isError(i)?{name:i.name,message:i.message,stack:i.stack}:m.isElement(i)?t(i):i}))}catch(t){for(var a in i="",e)if(e.hasOwnProperty(a))try{i+=',"'+a+'":"'+e[a]+'"'}catch(e){}i=i?"{"+i.replace(",","")+"}":"Unserializable Object"}return i.replace(/"undefined"/g,"undefined").replace(/"NaN"/g,"NaN")},sessionId:"",token:"",userId:"",version:"",callback:{enabled:!0,bindStack:!1},console:{enabled:!0,display:!0,error:!0,warn:!1,watch:["log","debug","info","warn","error"]},navigation:{enabled:!0},network:{enabled:!0,error:!0,fetch:!0},visitor:{enabled:!0},window:{enabled:!0,promise:!0}},initCurrent:function(e){return this.removeEmpty(e),this.validate(e,this.defaults,"[TrackJS] config",{})?(this.current=m.defaultsDeep({},e,this.defaults),!0):(this.current=m.defaultsDeep({},this.defaults),!1)},setCurrent:function(e){return!!this.validate(e,this.defaults,"[TrackJS] config",this.initOnly)&&(this.current=m.defaultsDeep({},e,this.current),!0)},removeEmpty:function(e){for(var t in e)e.hasOwnProperty(t)&&e[t]===n&&delete e[t]},validate:function(e,t,n,i){var a=!0;for(var s in n=n||"",i=i||{},e)if(e.hasOwnProperty(s))if(t.hasOwnProperty(s)){var o=typeof t[s];o!==typeof e[s]?(console.warn(n+"."+s+": property must be type "+o+"."),a=!1):"[object Array]"!==Object.prototype.toString.call(e[s])||this.validateArray(e[s],t[s],n+"."+s)?"[object Object]"===Object.prototype.toString.call(e[s])?a=this.validate(e[s],t[s],n+"."+s,i[s]):i.hasOwnProperty(s)&&(console.warn(n+"."+s+": property cannot be set after load."),a=!1):a=!1}else console.warn(n+"."+s+": property not supported."),a=!1;return a},validateArray:function(e,t,n){var i=!0;n=n||"";for(var a=0;a<e.length;a++)m.contains(t,e[a])||(console.warn(n+"["+a+"]: invalid value: "+e[a]+"."),i=!1);return i}};var s=function(e,t,n,i,a,s,o){this.util=e,this.log=t,this.onError=n,this.onFault=i,this.serialize=a,o.enabled&&(s.console=this.wrapConsoleObject(s.console,o))};s.prototype={wrapConsoleObject:function(e,t){var n,i=(e=e||{}).log||function(){},a=this;for(n=0;n<t.watch.length;n++)!function(n){var s=e[n]||i;e[n]=function(){try{var i=Array.prototype.slice.call(arguments);if(a.log.add("c",{timestamp:a.util.isoNow(),severity:n,message:a.serialize(1===i.length?i[0]:i)}),t[n])if(m.isError(i[0])&&1===i.length)a.onError("console",i[0]);else try{throw Error(a.serialize(1===i.length?i[0]:i))}catch(e){a.onError("console",e)}t.display&&(a.util.hasFunction(s,"apply")?s.apply(e,i):s(i[0]))}catch(e){a.onFault(e)}}}(t.watch[n]);return e},report:function(){return this.log.all("c")}};var o=function(e,t,n,i,a){this.config=e,this.util=t,this.log=n,this.window=i,this.document=a,this.correlationId=this.token=null,this.initialize()};o.prototype={initialize:function(){this.token=this.getCustomerToken(),this.correlationId=this.getCorrelationId()},getCustomerToken:function(){if(this.config.current.token)return this.config.current.token;var e=this.document.getElementsByTagName("script");return e[e.length-1].getAttribute("data-token")},getCorrelationId:function(){var e;if(!this.config.current.cookie)return this.util.uuid();try{(e=this.document.cookie.replace(/(?:(?:^|.*;\s*)TrackJS\s*\=\s*([^;]*).*$)|^.*$/,"$1"))||(e=this.util.uuid(),this.document.cookie="TrackJS="+e+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/")}catch(t){e=this.util.uuid()}return e},report:function(){return{application:this.config.current.application,correlationId:this.correlationId,sessionId:this.config.current.sessionId,token:this.token,userId:this.config.current.userId,version:this.config.current.version}}};var r=function(e){this.config=e,this.loadedOn=(new Date).getTime(),this.originalUrl=m.getLocation(),this.referrer=m.isBrowser?t.referrer:""};r.prototype={discoverDependencies:function(){var t={TrackJS:"3.10.1"};for(var n in e.jQuery&&e.jQuery.fn&&e.jQuery.fn.jquery&&(t.jQuery=e.jQuery.fn.jquery),e.jQuery&&e.jQuery.ui&&e.jQuery.ui.version&&(t.jQueryUI=e.jQuery.ui.version),e.angular&&e.angular.version&&e.angular.version.full&&(t.angular=e.angular.version.full),e)if("_trackJs"!==n&&"_trackJS"!==n&&"_trackjs"!==n&&"webkitStorageInfo"!==n&&"webkitIndexedDB"!==n&&"top"!==n&&"parent"!==n&&"frameElement"!==n)try{if(e[n]){var i=e[n].version||e[n].Version||e[n].VERSION;"string"==typeof i&&(t[n]=i)}}catch(e){}return t.TrackJS&&t.trackJs&&delete t.trackJs,t},report:function(){return{age:(new Date).getTime()-this.loadedOn,dependencies:this.config.current.dependencies?this.discoverDependencies():{trackJs:"3.10.1"},originalUrl:this.originalUrl,referrer:this.referrer,userAgent:e.navigator.userAgent,viewportHeight:m.isBrowser?e.document.documentElement.clientHeight:0,viewportWidth:m.isBrowser?e.document.documentElement.clientWidth:0}}};var l=function(e){this.util=e,this.appender=[],this.maxLength=30};l.prototype={all:function(e){var t,n,i=[];for(n=0;n<this.appender.length;n++)(t=this.appender[n])&&t.category===e&&i.push(t.value);return i},clear:function(){this.appender.length=0},truncate:function(){this.appender.length>this.maxLength&&(this.appender=this.appender.slice(Math.max(this.appender.length-this.maxLength,0)))},add:function(e,t){var n=this.util.uuid();return this.appender.push({key:n,category:e,value:t}),this.truncate(),n},get:function(e,t){var n,i;for(i=0;i<this.appender.length;i++)if((n=this.appender[i]).category===e&&n.key===t)return n.value;return!1}};var d=function(e){var t={};return{addMetadata:function(e,n){t[e]=n},removeMetadata:function(e){delete t[e]},report:function(){var n,i=[];for(n in t)t.hasOwnProperty(n)&&i.push({key:n,value:e(t[n])});return i},store:t}},c=function(e,t){this.log=e,this.options=t,t.enabled&&this.watch()};c.prototype={isCompatible:function(t){return t=t||e,!m.has(t,"chrome.app.runtime")&&m.has(t,"addEventListener")&&m.has(t,"history.pushState")},record:function(e,t,n){this.log.add("h",{type:e,from:m.truncate(t,250),to:m.truncate(n,250),on:m.isoNow()})},report:function(){return this.log.all("h")},watch:function(){if(this.isCompatible()){var t=this,n=m.getLocationURL().relative;e.addEventListener("popstate",(function(){var e=m.getLocationURL().relative;t.record("popState",n,e),n=e}),!0),m.forEach(["pushState","replaceState"],(function(e){m.patch(history,e,(function(i){return function(){n=m.getLocationURL().relative;var a=i.apply(this,arguments),s=m.getLocationURL().relative;return t.record(e,n,s),n=s,a}}))}))}}};var u=function(e,t,n,i,a,s){this.util=e,this.log=t,this.onError=n,this.onFault=i,this.window=a,this.options=s,s.enabled&&this.initialize(a)};u.prototype={initialize:function(e){e.XMLHttpRequest&&this.util.hasFunction(e.XMLHttpRequest.prototype.open,"apply")&&this.watchNetworkObject(e.XMLHttpRequest),e.XDomainRequest&&this.util.hasFunction(e.XDomainRequest.prototype.open,"apply")&&this.watchNetworkObject(e.XDomainRequest),this.options.fetch&&m.isWrappableFunction(e.fetch)&&this.watchFetch()},escapeUrl:function(e){return(""+e).replace(/ /gi,"%20").replace(/\t/gi,"%09")},watchFetch:function(){var t=this,n=this.log,i=this.options,a=this.onError;m.patch(e,"fetch",(function(s){return function(o,r){if(r&&r.__trackjs__)return s.apply(e,arguments);var l;try{throw Error()}catch(e){l=e.stack}var d=o instanceof Request?o.url:o,c=o instanceof Request?o.method:(r||{}).method||"GET",u=(d=t.escapeUrl(d),s.apply(e,arguments));return u.__trackjs_state__=n.add("n",{type:"fetch",startedOn:m.isoNow(),method:c,url:m.truncate(d,2e3)}),u.then((function(e){var t=n.get("n",u.__trackjs_state__);if(t){m.defaults(t,{completedOn:m.isoNow(),statusCode:e.status,statusText:e.statusText});var s=e.headers.get("trackjs-correlation-id");s&&(t.requestCorrelationId=s),i.error&&400<=e.status&&((t=Error(t.statusCode+" : "+t.method+" "+t.url)).stack=l,a("ajax",t))}return e})).catch((function(e){e=e||{};var t=n.get("n",u.__trackjs_state__);throw t&&(m.defaults(t,{completedOn:m.isoNow(),statusCode:0,statusText:e.toString()}),i.error&&(a("ajax",{name:e.name,message:(e.message||"Failed")+": "+t.method+" "+t.url,stack:e.stack||l}),e.__trackjs_state__=!0)),e}))}}))},watchNetworkObject:function(e){var t=this,n=e.prototype.open,i=e.prototype.send;return e.prototype.open=function(e,i){var a=(i||"").toString();return 0>a.indexOf("localhost:0")&&(a=t.escapeUrl(a),this._trackJs={method:e,url:a}),n.apply(this,arguments)},e.prototype.send=function(){if(!this._trackJs)try{return i.apply(this,arguments)}catch(e){return void t.onError("ajax",e)}try{this._trackJs.logId=t.log.add("n",{type:"xhr",startedOn:t.util.isoNow(),method:this._trackJs.method,url:m.truncate(this._trackJs.url,2e3)}),t.listenForNetworkComplete(this)}catch(e){t.onFault(e)}return i.apply(this,arguments)},e},listenForNetworkComplete:function(e){var t=this;t.window.ProgressEvent&&e.addEventListener&&e.addEventListener("readystatechange",(function(){4===e.readyState&&t.finalizeNetworkEvent(e)}),!0),e.addEventListener?e.addEventListener("load",(function(){t.finalizeNetworkEvent(e),t.checkNetworkFault(e)}),!0):setTimeout((function(){try{var n=e.onload;e.onload=function(){t.finalizeNetworkEvent(e),t.checkNetworkFault(e),"function"==typeof n&&t.util.hasFunction(n,"apply")&&n.apply(e,arguments)};var i=e.onerror;e.onerror=function(){t.finalizeNetworkEvent(e),t.checkNetworkFault(e),"function"==typeof oldOnError&&i.apply(e,arguments)}}catch(e){t.onFault(e)}}),0)},finalizeNetworkEvent:function(e){if(e._trackJs){var t=this.log.get("n",e._trackJs.logId);t&&(t.completedOn=this.util.isoNow(),e.getAllResponseHeaders&&e.getResponseHeader&&0<=(e.getAllResponseHeaders()||"").toLowerCase().indexOf("trackjs-correlation-id")&&(t.requestCorrelationId=e.getResponseHeader("trackjs-correlation-id")),t.statusCode=1223==e.status?204:e.status,t.statusText=1223==e.status?"No Content":e.statusText)}},checkNetworkFault:function(e){if(this.options.error&&400<=e.status&&1223!=e.status){var t=e._trackJs||{};this.onError("ajax",e.status+" : "+t.method+" "+t.url)}},report:function(){return this.log.all("n")}};var p=function(t,n){this.util=t,this.config=n,this.disabled=!1,this.throttleStats={attemptCount:0,throttledCount:0,lastAttempt:(new Date).getTime()},e.JSON&&e.JSON.stringify||(this.disabled=!0)};p.prototype={errorEndpoint:function(t){var n=this.config.current,i=n.errorURL;return m.isBrowser&&!m.testCrossdomainXhr()&&-1===e.location.protocol.indexOf("https")?i=n.errorNoSSLURL:n.forwardingDomain&&(i="https://"+n.forwardingDomain+"/capture"),i+"?token="+t+"&v=3.10.1"},usageEndpoint:function(e){var t=this.config.current,n=t.usageURL;return t.forwardingDomain&&(n="https://"+t.forwardingDomain+"/usage.gif"),this.appendObjectAsQuery(e,n)},trackerFaultEndpoint:function(e){var t=(this.config||{}).current||a.prototype.defaults,n=t.faultURL;return t.forwardingDomain&&(n="https://"+t.forwardingDomain+"/fault.gif"),this.appendObjectAsQuery(e,n)},appendObjectAsQuery:function(e,t){for(var n in t+="?",e)e.hasOwnProperty(n)&&(t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n])+"&");return t},getCORSRequest:function(t,n){var i;return this.util.testCrossdomainXhr()?((i=new e.XMLHttpRequest).open(t,n),i.setRequestHeader("Content-Type","text/plain")):void 0!==e.XDomainRequest?(i=new e.XDomainRequest).open(t,n):i=null,i},sendTrackerFault:function(e){this.throttle(e)||(m.isBrowser?t.createElement("img").src=this.trackerFaultEndpoint(e):fetch(this.trackerFaultEndpoint(e),{mode:"no-cors",__trackjs__:!0}))},sendUsage:function(e){m.isBrowser?t.createElement("img").src=this.usageEndpoint(e):fetch(this.usageEndpoint(e),{mode:"no-cors",__trackjs__:!0})},sendError:function(t,i){var a=this;if(!this.disabled&&!this.throttle(t))try{if(m.isBrowser){var s=this.getCORSRequest("POST",this.errorEndpoint(i));s.onreadystatechange=function(){4!==s.readyState||m.contains([200,202],s.status)||(a.disabled=!0)},s._trackJs=n,s.send(e.JSON.stringify(t))}else if(m.isWorker){var o={method:"POST",mode:"cors",body:e.JSON.stringify(t),__trackjs__:1};fetch(this.errorEndpoint(i),o).then((function(e){e.ok||(a.disabled=!0)})).catch((function(e){a.disabled=!0}))}}catch(e){throw this.disabled=!0,e}},throttle:function(e){var t=(new Date).getTime();if(this.throttleStats.attemptCount++,this.throttleStats.lastAttempt+1e3>=t){if(this.throttleStats.lastAttempt=t,10<this.throttleStats.attemptCount)return this.throttleStats.throttledCount++,!0}else e.throttled=this.throttleStats.throttledCount,this.throttleStats.attemptCount=0,this.throttleStats.lastAttempt=t,this.throttleStats.throttledCount=0;return!1}};var m=function(){function i(e,t,s,o){return s=s||!1,o=o||0,m.forEach(t,(function(t){m.forEach(m.keys(t),(function(r){null===t[r]||t[r]===n?e[r]=t[r]:s&&10>o&&"[object Object]"===a(t[r])?(e[r]=e[r]||{},i(e[r],[t[r]],s,o+1)):e.hasOwnProperty(r)||(e[r]=t[r])}))})),e}function a(e){return Object.prototype.toString.call(e)}return{isBrowser:void 0!==e&&void 0!==e.document,isWorker:"object"==typeof self&&self.constructor&&0<=(self.constructor.name||"").indexOf("WorkerGlobalScope"),isNode:"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,addEventListenerSafe:function(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on"+t,n)},afterDocumentLoad:function(e){if(m.isWorker)m.defer(e);else{var n=!1;"complete"===t.readyState?m.defer(e):(m.addEventListenerSafe(t,"readystatechange",(function(){"complete"!==t.readyState||n||(m.defer(e),n=!0)})),setTimeout((function(){n||(m.defer(e),n=!0)}),1e4))}},bind:function(e,t){return function(){return e.apply(t,Array.prototype.slice.call(arguments))}},contains:function(e,t){return 0<=e.indexOf(t)},defaults:function(e){return i(e,Array.prototype.slice.call(arguments,1),!1)},defaultsDeep:function(e){return i(e,Array.prototype.slice.call(arguments,1),!0)},defer:function(e,t){setTimeout((function(){e.apply(t)}))},forEach:function(e,t,n){if(m.isArray(e)){if(e.forEach)return e.forEach(t,n);for(var i=0;i<e.length;)t.call(n,e[i],i,e),i++}},getLocation:function(){return e.location.toString().replace(/ /g,"%20")},getLocationURL:function(){return m.parseURL(m.getLocation())},has:function(e,t){try{for(var n=t.split("."),i=e,a=0;a<n.length;a++){if(!i[n[a]])return!1;i=i[n[a]]}return!0}catch(e){return!1}},hasFunction:function(e,t){try{return!!e[t]}catch(e){return!1}},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},isArray:function(e){return"[object Array]"===a(e)},isBoolean:function(e){return"boolean"==typeof e||m.isObject(e)&&"[object Boolean]"===a(e)},isBrowserIE:function(t){var n=(t=t||e.navigator.userAgent).match(/Trident\/([\d.]+)/);return n&&"7.0"===n[1]?11:!!(t=t.match(/MSIE ([\d.]+)/))&&parseInt(t[1],10)},isBrowserSupported:function(){var e=this.isBrowserIE();return!e||8<=e},isError:function(e){if(!m.isObject(e))return!1;var t=a(e);return"[object Error]"===t||"[object DOMException]"===t||m.isString(e.name)&&m.isString(e.message)},isElement:function(e){return m.isObject(e)&&1===e.nodeType},isFunction:function(e){return!(!e||"function"!=typeof e)},isNumber:function(e){return"number"==typeof e||m.isObject(e)&&"[object Number]"===a(e)},isObject:function(e){return!(!e||"object"!=typeof e)},isString:function(e){return"string"==typeof e||!m.isArray(e)&&m.isObject(e)&&"[object String]"===a(e)},isWrappableFunction:function(e){return this.isFunction(e)&&this.hasFunction(e,"apply")},isoNow:function(){var e=new Date;return e.toISOString?e.toISOString():e.getUTCFullYear()+"-"+this.pad(e.getUTCMonth()+1)+"-"+this.pad(e.getUTCDate())+"T"+this.pad(e.getUTCHours())+":"+this.pad(e.getUTCMinutes())+":"+this.pad(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"},keys:function(e){if(!m.isObject(e))return[];var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n},noop:function(){},pad:function(e){return 1===(e=String(e)).length&&(e="0"+e),e},parseURL:function(e){var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);return t?((t={protocol:t[2],host:t[4],path:t[5],query:t[6],hash:t[8]}).origin=(t.protocol||"")+"://"+(t.host||""),t.relative=(t.path||"")+(t.query||"")+(t.hash||""),t.href=e,t):{}},patch:function(e,t,n){e[t]=n(e[t]||m.noop)},testCrossdomainXhr:function(){return m.isBrowser&&"withCredentials"in new XMLHttpRequest},truncate:function(e,t){if((e=""+e).length<=t)return e;var n=e.length-t;return e.substr(0,t)+"...{"+n+"}"},tryGet:function(e,t){try{return e[t]}catch(e){}},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},wrapError:function(e){var t=e||Object.prototype.toString.call(e);if(t&&t.innerError)return e;var n=Error("TrackJS Caught: "+(t.message||t));return n.description="TrackJS Caught: "+t.description,n.file=t.file,n.line=t.line||t.lineNumber,n.column=t.column||t.columnNumber,n.stack=t.stack,n.innerError=e,n}}}(),g=function(e,t,n,i,a,s){this.util=e,this.log=t,this.onError=n,this.onFault=i,this.options=s,this.document=a,e.isBrowser&&s.enabled&&this.initialize(a)};g.prototype={initialize:function(e){var t=this.util.bind(this.onDocumentClicked,this),n=this.util.bind(this.onInputChanged,this);e.addEventListener?(e.addEventListener("click",t,!0),e.addEventListener("blur",n,!0)):e.attachEvent&&(e.attachEvent("onclick",t),e.attachEvent("onfocusout",n))},onDocumentClicked:function(e){try{var t=this.getElementFromEvent(e);t&&t.tagName&&(this.isDescribedElement(t,"a")||this.isDescribedElement(t,"button")||this.isDescribedElement(t,"input",["button","submit"])?this.writeVisitorEvent(t,"click"):this.isDescribedElement(t,"input",["checkbox","radio"])&&this.writeVisitorEvent(t,"input",t.value,t.checked))}catch(e){this.onFault(e)}},onInputChanged:function(e){try{var t=this.getElementFromEvent(e);t&&t.tagName&&(this.isDescribedElement(t,"textarea")?this.writeVisitorEvent(t,"input",t.value):this.isDescribedElement(t,"select")&&t.options&&t.options.length?this.onSelectInputChanged(t):this.isDescribedElement(t,"input")&&!this.isDescribedElement(t,"input",["button","submit","hidden","checkbox","radio"])&&this.writeVisitorEvent(t,"input",t.value))}catch(e){this.onFault(e)}},onSelectInputChanged:function(e){if(e.multiple)for(var t=0;t<e.options.length;t++)e.options[t].selected&&this.writeVisitorEvent(e,"input",e.options[t].value);else 0<=e.selectedIndex&&e.options[e.selectedIndex]&&this.writeVisitorEvent(e,"input",e.options[e.selectedIndex].value)},writeVisitorEvent:function(e,t,i,a){"password"===this.getElementType(e)&&(i=n);var s=this.getElementAttributes(e);e.innerText&&(s.__trackjs_element_text=this.util.truncate(e.innerText,500)),this.log.add("v",{timestamp:this.util.isoNow(),action:t,element:{tag:e.tagName.toLowerCase(),attributes:s,value:this.getMetaValue(i,a)}})},getElementFromEvent:function(e){return e.target||t.elementFromPoint(e.clientX,e.clientY)},isDescribedElement:function(e,t,n){if(e.tagName.toLowerCase()!==t.toLowerCase())return!1;if(!n)return!0;for(e=this.getElementType(e),t=0;t<n.length;t++)if(n[t]===e)return!0;return!1},getElementType:function(e){return(e.getAttribute("type")||"").toLowerCase()},getElementAttributes:function(e){for(var t={},n=Math.min(e.attributes.length,10),i=0;i<n;i++){var a=e.attributes[i];m.contains(["data-value","value"],a.name.toLowerCase())||(t[a.name]=m.truncate(a.value,100))}return t},getMetaValue:function(e,t){return e===n?n:{length:e.length,pattern:this.matchInputPattern(e),checked:t}},matchInputPattern:function(e){return""===e?"empty":/^[a-z0-9!#$%&'*+=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/.test(e)?"email":/^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/.test(e)||/^(\d{4}[\/\-](0?[1-9]|1[012])[\/\-]0?[1-9]|[12][0-9]|3[01])$/.test(e)?"date":/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/.test(e)?"usphone":/^\s*$/.test(e)?"whitespace":/^\d*$/.test(e)?"numeric":/^[a-zA-Z]*$/.test(e)?"alpha":/^[a-zA-Z0-9]*$/.test(e)?"alphanumeric":"characters"},report:function(){return this.log.all("v")}};var h=function(e,t,n,i,a){this.onError=e,this.onFault=t,this.serialize=n,a.enabled&&this.watchWindowErrors(i),a.promise&&this.watchPromiseErrors(i)};h.prototype={watchPromiseErrors:function(e){var t=this;e.addEventListener?e.addEventListener("unhandledrejection",(function(e){try{var i=(e=e||{}).detail?m.tryGet(e.detail,"reason"):m.tryGet(e,"reason");if(i!==n&&null!==i&&!i.__trackjs_state__){if(!m.isError(i))try{throw Error(t.serialize(i))}catch(e){i=e}t.onError("promise",i)}}catch(e){t.onFault(e)}})):m.patch(e,"onunhandledrejection",(function(e){return function(n){t.onError("promise",n),e.apply(this,arguments)}}))},watchWindowErrors:function(e){var t=this;m.patch(e,"onerror",(function(e){return function(n,i,a,s,o){try{if(m.isError(o))return t.onError("window",o),void e.apply(this,arguments);var r={message:(o=o||{}).message||t.serialize(n),name:o.name||"Error",line:o.line||parseInt(a,10)||null,column:o.column||parseInt(s,10)||null,stack:o.stack||null};"[object Event]"!==Object.prototype.toString.call(n)||i?r.file=o.file||t.serialize(i):r.file=(n.target||{}).src,t.onError("window",r)}catch(e){t.onFault(e)}e.apply(this,arguments)}}))}};var f,_,y=function(){this.hasInstalled=!1,this.hasEnabled=!0,this.window=e,this.document=t,this.util=m,this.install=m.bind(this.install,this),this.onError=m.bind(this.onError,this),this.onFault=m.bind(this.onFault,this),this.serialize=m.bind(this.serialize,this),this.log=new l(m),this.metadata=new d(this.serialize);var n=e&&(e._trackJs||e._trackJS||e._trackjs);n&&this.install(n)};return y.prototype={install:function(e){try{if(m.isNode)return this.warn("monitoring disabled in node"),!1;if(!m.has(e,"token"))return this.warn("missing token"),!1;if(this.hasInstalled)return this.warn("already installed"),!1;if(this.config=new a(e),this.transmitter=new p(this.util,this.config),this.environment=new r(this.config),this.customer=new o(this.config,this.util,this.log,this.window,this.document),!this.config.current.enabled)return this.hasEnabled=!1;if(this.windowConsoleWatcher=new s(this.util,this.log,this.onError,this.onFault,this.serialize,this.window,this.config.current.console),!this.util.isBrowserSupported())return!1;this.callbackWatcher=new i(this.config.current.callback,this.onError,this.onFault),this.visitorWatcher=new g(this.util,this.log,this.onError,this.onFault,this.document,this.config.current.visitor),this.navigationWatcher=new c(this.log,this.config.current.navigation),this.networkWatcher=new u(this.util,this.log,this.onError,this.onFault,this.window,this.config.current.network),this.windowWatcher=new h(this.onError,this.onFault,this.serialize,this.window,this.config.current.window);var t=this;return m.afterDocumentLoad((function(){t.transmitter.sendUsage({token:t.customer.token,correlationId:t.customer.correlationId,application:t.config.current.application,x:t.util.uuid()})})),this.hasInstalled=!0}catch(e){return this.onFault(e),!1}},pub:function(){var e=this,t={addMetadata:this.metadata.addMetadata,attempt:function(t,n){try{var i=Array.prototype.slice.call(arguments,2);return t.apply(n||this,i)}catch(t){throw e.onError("catch",t),m.wrapError(t)}},configure:function(t){return!e.hasInstalled&&e.hasEnabled?(e.warn("agent must be installed"),!1):e.config.setCurrent(t)},hash:"fb090f9249a14e8440f317f57bd82ec8d6ea32a4",isInstalled:function(){return e.hasInstalled},install:this.install,removeMetadata:this.metadata.removeMetadata,track:function(t){if(!e.hasInstalled&&e.hasEnabled)e.warn("agent must be installed");else{var n=m.isError(t)?t.message:e.serialize(t);if(!(t=t||{}).stack)try{throw Error(n)}catch(e){t=e}e.onError("direct",t)}},version:"3.10.1",watch:function(t,n){return function(){try{var i=Array.prototype.slice.call(arguments,0);return t.apply(n||this,i)}catch(t){throw e.onError("catch",t),m.wrapError(t)}}},watchAll:function(e){var t,n=Array.prototype.slice.call(arguments,1);for(t in e)"function"!=typeof e[t]||m.contains(n,t)||(e[t]=this.watch(e[t],e));return e}};return new s(m,e.log,e.onError,e.onFault,e.serialize,t,a.prototype.defaults.console),t},onError:(_=!1,function(t,n,i){if(this.hasInstalled&&this.hasEnabled&&m.isBrowserSupported())try{if(i=i||{bindStack:null,bindTime:null,force:!1},n&&m.isError(n)||(n={name:"Error",message:this.serialize(n,i.force)}),-1===n.message.indexOf("TrackJS Caught"))if(_&&-1!==n.message.indexOf("Script error"))_=!1;else{var a=m.defaultsDeep({},{agentPlatform:m.isBrowser?"browser":"worker",bindStack:i.bindStack,bindTime:i.bindTime,column:n.column||n.columnNumber,console:this.windowConsoleWatcher.report(),customer:this.customer.report(),entry:t,environment:this.environment.report(),file:n.file||n.fileName,line:n.line||n.lineNumber,message:n.message,metadata:this.metadata.report(),nav:this.navigationWatcher.report(),network:this.networkWatcher.report(),url:(e.location||"").toString(),stack:n.stack,timestamp:this.util.isoNow(),visitor:this.visitorWatcher.report(),version:"3.10.1"});if(!i.force)try{if(!this.config.current.onError(a,n))return}catch(e){a.console.push({timestamp:this.util.isoNow(),severity:"error",message:e.message});var s=this;setTimeout((function(){s.onError("catch",e,{force:!0})}),0)}if(this.config.current.dedupe){var o=(a.message+a.stack).substr(0,1e4);if(o===f)return;f=o}!function(){function e(){var e=0;return m.forEach(a.console,(function(t){e+=(t.message||"").length})),8e4<=e}for(var t=0;e()&&t<a.console.length;)a.console[t].message=m.truncate(a.console[t].message,1e3),t++}(),this.log.clear(),setTimeout((function(){_=!1})),_=!0,this.transmitter.sendError(a,this.customer.token)}}catch(e){this.onFault(e)}}),onFault:function(e){var t=this.transmitter||new p;e=e||{},e={token:(this.customer||{}).token,file:e.file||e.fileName,msg:e.message||"unknown",stack:(e.stack||"unknown").substr(0,1e3),url:this.window.location,v:"3.10.1",h:"fb090f9249a14e8440f317f57bd82ec8d6ea32a4",x:this.util.uuid()},t.sendTrackerFault(e)},serialize:function(e,t){if(this.hasInstalled&&this.config.current.serialize&&!t)try{return this.config.current.serialize(e)}catch(e){this.onError("catch",e,{force:!0})}return a.prototype.defaults.serialize(e)},warn:function(t){m.has(e,"console.warn")&&e.console.warn("TrackJS: "+t)}},(new y).pub()}("undefined"==typeof self?void 0:self,"undefined"==typeof document?void 0:document),window.TrackJS&&TrackJS.install({token:"16c187efb05541c6b81bee305e0727d1",application:"offerupbot"})}catch(e){console.error(e),(0,i.Z)({error:"Failed to install trackjs",details:e.toString()})}}},642:(e,t,n)=>{"use strict";function i(){document.body.insertAdjacentHTML("afterbegin",'\n  <div id="ta_maximize" style="user-select: none;position: fixed;border: 1px solid;height: 38px;margin-top: -7px;width: 30px;font-size: -webkit-xxx-large;cursor: pointer;background: rgb(63, 81, 181);z-index: 1;right: 0px;align-items: center;justify-content: center;display: block;color: white;">\n    <svg fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 473 473" xml:space="preserve" style="\n        position: absolute;\n        height: 81%;\n        width: 65%;\n        padding: 0px;\n        color: white;\n        fill: white;\n        margin: 5px;\n    ">\n    <g>\n      <g>\n        <path d="M459.5,0H330.4c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5h96.5L218.8,235.1c-5.3,5.3-5.3,13.8,0,19.1c2.6,2.6,6.1,4,9.5,4\n          s6.9-1.3,9.5-4L446,46.1v96.5c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5V13.5C473,6,467,0,459.5,0z"></path>\n        <path d="M459.5,231.2c-7.5,0-13.5,6-13.5,13.5v130.9c0,38.8-31.6,70.4-70.4,70.4H97.4C58.6,446,27,414.4,27,375.6V97.4\n          C27,58.6,58.6,27,97.4,27h129.9c7.5,0,13.5-6,13.5-13.5S234.8,0,227.3,0H97.4C43.7,0,0,43.7,0,97.4v278.2\n          C0,429.3,43.7,473,97.4,473h278.2c53.7,0,97.4-43.7,97.4-97.4V244.7C473,237.2,467,231.2,459.5,231.2z"></path>\n      </g>\n    </g>\n    </svg>\n  </div>\n  <div id="ta" style="position: fixed;z-index: 900000;background-color: white;border: solid; right: 0px;width: 393px;\n                  height: 600px; \n                  padding-right: unset;\n                  padding-top: unset;\n                  height: 100%;\n                  top: 0;">\n                <div class="login_container">\n                  <iframe id="login_iframe" src="https://login.phones.trade" style="border: none; width: 100%; height: 100%; margin-top: 100%;"></iframe>\n                </div>\n\n                \x3c!-- MDL Tab Container --\x3e\n                <div id="taheader" class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect" style="height: 100%;">\n                  <div id="info-header" style="display: none; color: white;background: rgb(63,81,181);line-height: 26px;padding: 5px 0px;width: 100%;text-align: center; justify-content: space-around;">\n                    <span id="info-subscription"></span>\n                    <span id="info-website"></span>\n                    <span><a id="info-logout" href="#" onclick="hopla_logout()" style="text-decoration: none;color: white;-webkit-highlight: none;">Logout</a></span>\n                  </div>\n                  \x3c!-- Tab Bars --\x3e\n                  <div id="menu" class="mdl-tabs__tab-bar" style="display: none;">\n                      <a href="#page2" class="mdl-tabs__tab is-active" style="width: 100%;">Automate</a>\n                      <a href="#page3" class="mdl-tabs__tab" style="width: 100%;">Content</a>\n                      <a href="#page4" class="mdl-tabs__tab" style="width: 100%;">Settings</a>\n                  </div>\n\n                  \x3c!-- <div id="page1" class="mdl-tabs__panel is-active" style="height: 100%;">\n                    <iframe id="taframe" src="https://sell.phones.trade/?model=12pro&amp;storage=128gb&amp;network=unlocked&amp;condition=usedlikenew&a=1" style="\n                      height: 100%;\n                    "></iframe>\n                    <button id="reportbug2" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored" style="position: absolute;\n                      bottom: 0px;\n                      left: 50%;\n                      transform: translate(-50%);\n                      z-index: 1;\n                      width: 100%;\n                      display: none;\n                      height: 44px;">\n                        Report a\n                        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bug" class="svg-inline--fa fa-bug fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="width: 22px;padding-left: 3px;margin-bottom: 3px;"><path fill="currentColor" d="M511.988 288.9c-.478 17.43-15.217 31.1-32.653 31.1H424v16c0 21.864-4.882 42.584-13.6 61.145l60.228 60.228c12.496 12.497 12.496 32.758 0 45.255-12.498 12.497-32.759 12.496-45.256 0l-54.736-54.736C345.886 467.965 314.351 480 280 480V236c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v244c-34.351 0-65.886-12.035-90.636-32.108l-54.736 54.736c-12.498 12.497-32.759 12.496-45.256 0-12.496-12.497-12.496-32.758 0-45.255l60.228-60.228C92.882 378.584 88 357.864 88 336v-16H32.666C15.23 320 .491 306.33.013 288.9-.484 270.816 14.028 256 32 256h56v-58.745l-46.628-46.628c-12.496-12.497-12.496-32.758 0-45.255 12.498-12.497 32.758-12.497 45.256 0L141.255 160h229.489l54.627-54.627c12.498-12.497 32.758-12.497 45.256 0 12.496 12.497 12.496 32.758 0 45.255L424 197.255V256h56c17.972 0 32.484 14.816 31.988 32.9zM257 0c-61.856 0-112 50.144-112 112h224C369 50.144 318.856 0 257 0z"></path></svg>\n                    </button>\n                  </div> --\x3e\n\n                  <div id="page2" class="mdl-tabs__panel is-active" style="position: relative; height: calc(100% - 105px); display: none;">\n                    <ul class="demo-list-control mdl-list">\n                      <li class="mdl-list__item" style="height: 100px;">\n                          <span class="mdl-list__item-primary-content">\n                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                              <textarea class="mdl-textfield__input" type="text" rows= "3" id="keywords" ></textarea>\n                              <label class="mdl-textfield__label" for="keywords">Search (Keywords & Categories)</label>\n                            </div>\n                          </span>\n                      </li>\n                      <li style="display: flex;justify-content: space-around;">\n                        <a class="bblue" href="#" id="copy_search_filters" style="display: flex;justify-content: center;">[Copy Search &amp; Filters from URL]</a>\n                        <a class="bblue" href="#" id="test_search_filters" style="display: flex;justify-content: center;">[Test Search]</a>\n                      </li>\n                      <li class="mdl-list__item" style="height: fit-content;">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input nowrap" type="text" rows= "3" id="searchwithfilters" ></textarea>\n                            <label class="mdl-textfield__label" for="searchwithfilters">Search With Filters</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item" style="height: 100px;">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows= "3" id="zipcodes" ></textarea>\n                            <label class="mdl-textfield__label" for="zipcodes">Zipcodes</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Loop Search & Locations\n                        </span>\n                        <span class="mdl-list__item-secondary-action">\n                          <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-loopsearch">\n                            <input type="checkbox" id="switch-loopsearch" class="mdl-switch__input" checked/>\n                          </label>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content" style="margin-right: -54px;">\n                          Price Min\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 71px;margin-right: -20px;">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="100" id="listing_min_price" placeholder="0" style="text-align: unset;">\n                            <label class="mdl-textfield__label" for="listing_min_price"></label>\n                          </span>\n                        </span>\n                        <span class="mdl-list__item-primary-content" style="margin-left: 29px;margin-right: -53px;">\n                          Max\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 90px;">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="1000" id="listing_max_price" placeholder="0" style="text-align: left;">\n                            <label class="mdl-textfield__label" for="listing_max_price"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item" style="height: 100px;">\n                          <span class="mdl-list__item-primary-content">\n                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                              <textarea class="mdl-textfield__input" type="text" rows= "3" id="title_must_include" ></textarea>\n                              <label class="mdl-textfield__label" for="title_must_include">Title must contain, any</label>\n                            </div>\n                          </span>\n                      </li>\n                      <li class="mdl-list__item" style="height: 100px;">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows= "3" id="skipwords_title" ></textarea>\n                            <label class="mdl-textfield__label" for="skipwords_title">Skip Words Title</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item" style="height: 100px;">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows= "3" id="skipwords_description" ></textarea>\n                            <label class="mdl-textfield__label" for="skipwords_description">Skip Words Description</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Listing Max Age (days.hours)\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" id="listing_max_age" value=90 placeholder="0">\n                            <label class="mdl-textfield__label" for="listing_max_age"></label>\n                          </span>\n                        </span>\n                      </li>\n                     <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Owner KW Listings Min\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="1" id="owner_min_lists" placeholder="0" style="text-align: unset;">\n                            <label class="mdl-textfield__label" for="owner_min_lists"></label>\n                          </span>\n                        </span>\n                        <span class="mdl-list__item-primary-content">\n                          Max\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="3" id="owner_max_lists" placeholder="0">\n                            <label class="mdl-textfield__label" for="owner_max_lists"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Skip Profiles Created => (Year)\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" id="skip_profiles_created_after_year" value=2023 placeholder="2023">\n                            <label class="mdl-textfield__label" for="skip_profiles_created_after_year"></label>\n                          </span>\n                        </span>\n                      </li>\n                      \x3c!-- <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Custom Price Delta\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="text" id="custom_price_delta" placeholder="0">\n                            <label class="mdl-textfield__label" for="custom_price_delta"></label>\n                          </span>\n                        </span>\n                      </li> --\x3e\n                      \x3c!-- <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Owner Skip Expiry\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" id="ownerskipexpiry" placeholder="days" value="14">\n                            <label class="mdl-textfield__label" for="ownerskipexpiry"></label>\n                          </span>\n                        </span>\n                      </li> --\x3e\n                      \x3c!-- <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Continue After Storage\n                        </span>\n                        <span class="mdl-list__item-secondary-action">\n                          <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-continue_after_storage">\n                            <input type="checkbox" id="switch-continue_after_storage" class="mdl-switch__input" />\n                          </label>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Continue After Network\n                        </span>\n                        <span class="mdl-list__item-secondary-action">\n                          <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-continue_after_network">\n                            <input type="checkbox" id="switch-continue_after_network" class="mdl-switch__input" />\n                          </label>\n                        </span>\n                      </li> --\x3e\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Skip Shipping-Enabled\n                        </span>\n                        <span class="mdl-list__item-secondary-action">\n                          <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-skipshippingenabled">\n                            <input type="checkbox" id="switch-skipshippingenabled" class="mdl-switch__input" checked />\n                          </label>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px; display: none;">\n                        <span class="mdl-list__item-primary-content">\n                          Send Partner Messages\n                        </span>\n                        <span class="mdl-list__item-secondary-action">\n                          <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-sendpartnermessages">\n                            <input type="checkbox" id="switch-sendpartnermessages" class="mdl-switch__input" />\n                          </label>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="display: none; padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Streak\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="5" id="streak" placeholder="0" style="text-align: unset;">\n                            <label class="mdl-textfield__label" for="streak"></label>\n                          </span>\n                        </span>\n                        <span class="mdl-list__item-primary-content">\n                          Then Timeout\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="15" id="streaktimeout" placeholder="0">\n                            <label class="mdl-textfield__label" for="streaktimeout"></label>\n                          </span>\n                        </span>\n                      </li>\n                    </ul>\n                    <div id="status" style="color: white;background: black;line-height: 26px;padding: 5px 0px;position: absolute;bottom: 137px;width: 100%;text-align: center;min-height: 61px;align-items: center;display: flex;justify-content: center;">\n                        <span id="statustext" style="\n                    "></span></div>\n                    \n\n\n                    <div id="stats" style="color: white;background: rgb(63,81,181);line-height: 26px;padding: 5px 0px;position: absolute;bottom: 49px;width: 100%;text-align: center;">\n                    <span>Today\'s Stats </span>\n                    <div style="\n                      display: flex;\n                      justify-content: space-evenly;\n                    ">\n                      <span><span id="stat_scraped">0</span> scraped </span>\n                      <span><span id="stat_new_listings">0</span> new </span>\n                      <span><span id="stat_skipped">0</span> skipped</span>\n                    </div>\n                    <div style="\n                      display: flex;\n                      justify-content: space-evenly;\n                    ">\n                      <span><span id="stat_offers">0</span> messaged</span>\n                      <span><span id="stat_runs">0</span> runs </span>\n                      <span><span id="stat_streaks">0</span> streak</span>\n                      <span><span id="stat_ko">0</span> KO</span>\n                    </div>\n                  </div>\n\n\n\n                    <div class="footer" style="\n                      justify-content: space-around;\n                      display: flex;\n                      position: absolute;\n                      bottom: 5px;\n                      width: 100%; align-items: center;\n                      border-top: solid 1px;\n                      border-top-color: #e0e0e0;\n                      height: 44px;\n                      padding-right: 10px;\n                      ">\n                      <span>Run From</span>\n                      <input id="runfrom" type="time" style="width: unset;font-size: 16px;font-family: Lato,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-weight: 400;" class="mdl-textfield__input" value="09:00">\n                      <span>Until</span>\n                      <input id="rununtil" type="time" style="width: unset;font-size: 16px;font-family: Lato,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-weight: 400;" class="mdl-textfield__input" value="18:00">\n                      <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-rununtil">\n                        <input type="checkbox" id="switch-rununtil" class="mdl-switch__input">\n                        <span class="mdl-switch__label"></span>\n                      </label>\n                    </div>\n                  </div>\n\n                  <div id="page3" class="mdl-tabs__panel" style="\n                    height: calc(100% - 105px);\n                    overflow: hidden auto;\n                    position: relative;\n                    display: none;">\n                    <div id="page2loading" class="mdl-spinner mdl-js-spinner is-active" style="position: absolute;left: 50%;top: 30%; display:none;"></div>\n                    <ul class="demo-list-control mdl-list">\n                        <li class="mdl-list__item h150" >  \n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows="5" id="message_1" ></textarea>\n                            <label class="mdl-textfield__label" for="message_1">Message 1</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item h150">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows="5" id="message_2" ></textarea>\n                            <label class="mdl-textfield__label" for="message_2">Message 2</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item h150">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows="5" id="message_3" ></textarea>\n                            <label class="mdl-textfield__label" for="message_3">Message 3</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item h150" >  \n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows="5" id="followup_1" ></textarea>\n                            <label class="mdl-textfield__label" for="followup_1">Follow-up 1</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item h150">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows="5" id="followup_2" ></textarea>\n                            <label class="mdl-textfield__label" for="followup_2">Follow-up 2</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item h150">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows="5" id="followup_3" ></textarea>\n                            <label class="mdl-textfield__label" for="followup_3">Follow-up 3</label>\n                          </div>\n                        </span>\n                      </li>\n                      \x3c!-- <li class="mdl-list__item h150">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows="5" id="listing_price" ></textarea>\n                            <label class="mdl-textfield__label" for="lowball_message">Lowball</label>\n                          </div>\n                        </span>\n                      </li> \n                      <li class="mdl-list__item h150">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows="5" id="message_4" ></textarea>\n                            <label class="mdl-textfield__label" for="message_4">Message 4</label>\n                          </div>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item h150">\n                        <span class="mdl-list__item-primary-content">\n                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <textarea class="mdl-textfield__input" type="text" rows="5" id="message_5" ></textarea>\n                            <label class="mdl-textfield__label" for="message_5">Message 5</label>\n                          </div>\n                        </span>\n                      </li>--\x3e\n                      <li class="mdl-list__item" style="height: 60px; display: none;">\n                        <span class="mdl-list__item-primary-content">\n                          <span class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                            <input class="mdl-textfield__input" type="text" id="partnermessage">\n                            <label class="mdl-textfield__label" for="partnermessage">Partner Message</label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Price Delta\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 71px;">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" id="listing_price_delta" placeholder="0" style="text-align: unset;">\n                            <label class="mdl-textfield__label" for="listing_price_delta"></label>\n                          </span>\n                        </span>\n                        <span class="mdl-list__item-primary-content">\n                          Rounding\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 90px;">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" id="roundupdown" placeholder="0" style="text-align: left;">\n                            <label class="mdl-textfield__label" for="roundupdown"></label>\n                          </span>\n                        </span>\n                      </li>\n                    </ul>\n                    <div class="variables" style="padding-bottom: 10px; position: absolute;\n                    bottom: 55px;\n                    padding: 0px 16px;">\n                        <span style="display: block;">Available Variables:</span>\n                        <span class="variable">[name]</span>\n                        \x3c!-- <span class="variable">[model]</span>\n                        <span class="variable">[network]</span>\n                        <span class="variable">[memory]</span>\n                        <span class="variable">[price]</span> --\x3e\n                        <span class="variable">[price]</span>\n                        <span class="variable">[title]</span>\n                        \x3c!-- <span class="variable">[deductions]</span>\n                        <span class="variable">[condition]</span> --\x3e\n                        \x3c!-- <span class="variable">[quote_link]</span>\n                        <span class="variable">[pickup_link]</span> \n                        <span class="variable">[partner_link]</span> \n                        <span class="variable">[website]</span> --\x3e\n                    </div>\n                    <div class="template-actions" style="\n                      justify-content: space-between;\n                      display: flex;\n                      position: absolute;\n                      bottom: 0px;\n                      width: 100%;\n                    ">\n                      <button id="test_template" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect"\n                        style="width: 50%;\n                        margin-right: 1px;\n                        height: 44px;">\n                        Test\n                      </button>\n                      <button id="restore_defaults" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect"\n                        style="width: 50%;\n                        height: 44px;">\n                        Restore Defaults\n                      </button>\n                    </div>\n                  </div>\n                  <div id="page4" class="mdl-tabs__panel" style="\n                    height: calc(100% - 105px);\n                    overflow: hidden auto;\n                    position: relative;\n                    display: none;\n                    ">\n                    <div id="page2loading" class="mdl-spinner mdl-js-spinner is-active" style="position: absolute;left: 50%;top: 30%; display:none;"></div>\n                    <ul class="demo-list-control mdl-list">\n                      <li id="row_eject_subscriptionid" class="mdl-list__item taseparator" style="height: 49px;">\n                        <div class="buttons_container_container w100" style="margin-bottom: 20px;">\n                          <div class="buttons_container space-between">\n                            <button id="btn_eject_subscription" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect">\n                              Eject Subscription ID\n                            </button>\n                          </div>\n                        </div>\n                      </li>\n                      <li id="row_soldphones" class="mdl-list__item taseparator" style="padding-top: unset !important; padding-bottom: unset !important; height: 43px;">\n                        <span class="mdl-list__item-primary-content" style="text-align: center; line-height: 2px; height: 25px;">\n                          Phones sold in the last 30 days: <span id="phones_sold_last_30_days" style="margin-left: 9px;font-weight: 500;">X</span>\n                        </span>\n                      </li>\n                         <li id="row_licenseKeyAddBuy" class="mdl-list__item taseparator" style="padding-top: unset !important; padding-bottom: unset !important; height: 43px;">\n                        <span class="mdl-list__item-primary-content" style="text-align: center; line-height: 2px; height: 25px;">\n                          License Key:\n                        </span>\n                        <span class="mdl-list__item-secondary-action">\n                          <button id="btn_add_license_key" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored">\n                            ADD\n                          </button>\n                          <button id="buy_license_key" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored">\n                            BUY\n                          </button>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Owner Message Expiry\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" id="owner_message_expiry" placeholder="days" value="14" min="7">\n                            <label class="mdl-textfield__label" for="owner_message_expiry"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Archive After Sending\n                        </span>\n                        <span class="mdl-list__item-secondary-action">\n                          <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-deleteaftersend">\n                            <input type="checkbox" id="switch-deleteaftersend" class="mdl-switch__input" checked />\n                          </label>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Follow Up After (mins)\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" id="followup_after" placeholder="minutes" value="20">\n                            <label class="mdl-textfield__label" for="followup_after"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content" style="justify-content: center; font-weight: 600;">\n                          Timeouts\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content fsmall">\n                          Between API Calls (secs) Min\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="5" id="timeout_api_calls_min" placeholder="0" style="text-align: unset;">\n                            <label class="mdl-textfield__label" for="timeout_api_calls_min"></label>\n                          </span>\n                        </span>\n                        <span class="mdl-list__item-primary-content fsmall">\n                          Max\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="80" id="timeout_api_calls_max" placeholder="0">\n                            <label class="mdl-textfield__label" for="timeout_api_calls_max"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content fsmall">\n                          Between Messages (secs) Min\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="5" id="timeout_between_messages_min" placeholder="0" style="text-align: unset;">\n                            <label class="mdl-textfield__label" for="timeout_between_messages_min"></label>\n                          </span>\n                        </span>\n                        <span class="mdl-list__item-primary-content fsmall">\n                          Max\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="300" id="timeout_between_messages_max" placeholder="0">\n                            <label class="mdl-textfield__label" for="timeout_between_messages_max"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content fsmall">\n                          After Listings Messaged (secs) Min\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="1" id="timeout_listings_messaged_min" placeholder="0" style="text-align: unset;">\n                            <label class="mdl-textfield__label" for="timeout_listings_messaged_min"></label>\n                          </span>\n                        </span>\n                        <span class="mdl-list__item-primary-content fsmall">\n                          Max\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="15" id="timeout_listings_messaged_max" placeholder="0">\n                            <label class="mdl-textfield__label" for="timeout_listings_messaged_max"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content fsmall">\n                          After Streak (secs) Min\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="1" id="timeout_streak_min" placeholder="0" style="text-align: unset;">\n                            <label class="mdl-textfield__label" for="timeout_streak_min"></label>\n                          </span>\n                        </span>\n                        <span class="mdl-list__item-primary-content fsmall">\n                          Max\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="30" id="timeout_streak_max" placeholder="0">\n                            <label class="mdl-textfield__label" for="timeout_streak_max"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content fsmall">\n                          End of Run (secs) Min\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="30" id="timeout_end_of_run_min" placeholder="0" style="text-align: unset;">\n                            <label class="mdl-textfield__label" for="timeout_end_of_run_min"></label>\n                          </span>\n                        </span>\n                        <span class="mdl-list__item-primary-content fsmall">\n                          Max\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 30px">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="300" id="timeout_end_of_run_max" placeholder="0">\n                            <label class="mdl-textfield__label" for="timeout_end_of_run_max"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content fsmall">\n                          Stop Messaging After (# of messages)\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input disabled class="mdl-textfield__input" type="number" id="stop_messaging_after" placeholder="0" value="0">\n                            <label class="mdl-textfield__label" for="stop_messaging_after"></label>\n                          </span>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content" style="justify-content: center; font-weight: 600; margin-left: 36px;">\n                          OpenAI\n                        </span>\n                        <span class="mdl-list__item-secondary-action">\n                          <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-enablegpt">\n                            <input type="checkbox" id="switch-enablegpt" class="mdl-switch__input" />\n                          </label>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="display: flex; flex-direction: column;">\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 100%">\n                          <span class="mdl-textfield mdl-js-textfield openai_init" id="container_openai_apikey">\n                            <input class="mdl-textfield__input" value="" id="openai_apikey" placeholder="API KEY" style="text-align: center; border-bottom: 1px solid; height: 31px;">\n                            <label class="mdl-textfield__label" for="openai_apikey"></label>\n                          </span>\n                        </span>\n                        <div class="openai_ready mdl-textfield mdl-js-textfield mdl-textfield--floating-label getmdl-select">\n                          <input type="text" value="" class="mdl-textfield__input" id="assistant_id" style="text-align: center;" readonly>\n                          <input type="hidden" value="" name="assistant_id">\n                          <label for="assistant_id" class="mdl-textfield__label">Assistant ID</label>\n                          <ul for="assistant_id" class="mdl-menu mdl-menu--bottom-left mdl-js-menu">\n                              \x3c!-- <li class="mdl-menu__item" data-val="DEU">Germany</li>\n                              <li class="mdl-menu__item" data-val="BLR">Belarus</li>\n                              <li class="mdl-menu__item" data-val="RUS">Russia</li> --\x3e\n                          </ul>\n                        </div>\n                        <li class="openai_readyflex w100 mdl-list__item taseparator" style="padding-top: unset !important;\n                          padding-bottom: unset !important;\n                          height: 43px;">\n                          <span class="mdl-list__item-primary-content">\n                            Images\n                          </span>\n                          <span class="mdl-list__item-secondary-action tawsmall">\n                            <span class="mdl-textfield mdl-js-textfield">\n                              <input class="mdl-textfield__input" type="number" id="num_images" value="3">\n                              <label class="mdl-textfield__label" for="num_images"></label>\n                            </span>\n                          </span>\n                        </li>\n                        <li class="openai_readyflex w100 mdl-list__item taseparator" style="padding-top: unset !important;\n                          padding-bottom: unset !important;\n                          height: 43px;">\n                          <span class="mdl-list__item-primary-content">\n                            Detail\n                          </span>\n                          <span class="mdl-list__item-secondary-action">\n                            <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="high">\n                              <input checked class="mdl-radio__button" id="high" name="image_detail" type="radio"\n                              value="high">\n                              <span class="mdl-radio__label">High</span>\n                            </label>\n                            <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="low">\n                              <input class="mdl-radio__button" id="low" name="image_detail" type="radio" value="low">\n                              <span class="mdl-radio__label">Low</span>\n                            </label>\n                          </span>\n                        </li>\n                        <div class="buttons_container_container w100">\n                          <div class="buttons_container space-between">\n                            <button id="btn_set_openai_apikey" class="openai_init mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect">\n                              Set Key\n                            </button>\n                            <button id="btn_openai_test" class="openai_ready mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect">\n                              Test\n                            </button>\n                            <button id="btn_copylisting_details" class="openai_ready mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect">\n                              Copy Listing Details\n                            </button>\n                            <button id="btn_eject_openai_apikey" class="openai_ready mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect" style="display: none;">\n                              Eject Key\n                            </button>\n                          </div>\n                        </div>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important; height: 43px;">\n                        <span class="mdl-list__item-primary-content" style="justify-content: center; font-weight: 600;">\n                          Archive Threads\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content" style="margin-right: -54px;">\n                          Archive \n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall" style="width: 71px;margin-right: -20px;">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="60" id="amount_to_archive" placeholder="# threads" style="text-align: center;">\n                            <label class="mdl-textfield__label" for="amount_to_archive"></label>\n                          </span>\n                        </span>\n                         <span class="mdl-list__item-primary-content" style="margin-left: 29px;margin-right: -53px;">\n                          Older Than (days)\n                        </span>\n                        <span class="mdl-list__item-secondary-action tawsmall">\n                          <span class="mdl-textfield mdl-js-textfield">\n                            <input class="mdl-textfield__input" type="number" value="7" id="archiveolderthan" placeholder="days">\n                            <label class="mdl-textfield__label" for="archiveolderthan"></label>\n                          </span>\n                        </span>\n                      </li>\n                       <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content">\n                          Skip Unread\n                        </span>\n                        <span class="mdl-list__item-secondary-action">\n                          <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-skipunread">\n                            <input type="checkbox" id="switch-skipunread" class="mdl-switch__input" checked />\n                          </label>\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        ">\n                        <div class="buttons_container_container w100">\n                          <div class="buttons_container space-between mb20">\n                            <button id="archive_all_threads" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent bgred">\n                              Archive All Threads\n                            </button>\n                          </div>\n                        </div>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        height: 43px;">\n                        <span class="mdl-list__item-primary-content" style="justify-content: center; font-weight: 600;">\n                          Purge Lists\n                        </span>\n                      </li>\n                      <li class="mdl-list__item taseparator" style="padding-top: unset !important;\n                        padding-bottom: unset !important;\n                        ">\n                        <div class="buttons_container_container w100">\n                          <div class="buttons_container space-between">\n                            <button id="purge_listings" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent bgred">\n                              Purge Listings\n                            </button>\n                            <button id="download_listings" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent bgblue">\n                              Download Listings\n                            </button>\n                          </div>\n                          <div class="buttons_container space-between">\n                            <button id="purge_owners" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent bgred">\n                              Purge Owners\n                            </button>\n                            <button id="download_owners" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent bgblue">\n                              Download Owners\n                            </button>\n                          </div>\n                        </div>\n                      </li>\n                      <br>\n                      <li class="mdl-list__item" style="height: 100px;">  \n                        <div class="listing_debugger_container">\n                          <span class="mdl-list__item-primary-content">\n                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                              <input class="mdl-textfield__input" type="text" rows="3" id="listing_url" ></input>\n                              <label class="mdl-textfield__label" for="listing_url">Listing URL</label>\n                            </div>\n                          </span>\n                          <button id="btn_test_url" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect"\n                            height: 44px;">\n                            Test URL\n                          </button>\n                        </div>\n                      </li>\n                    </ul>\n                  </div>\n                </div>\n\n                \n                <dialog id="dialog-bug" class="mdl-dialog">\n                  <h4 class="mdl-dialog__title">Bug Report</h4>\n                  <div class="mdl-dialog__content">\n                    <div id="buglistingdetails">\n                    </div>\n                    <div>\n                        <br>\n                        <p>Based on the info above. The bot determined that the phone variant is:</p>\n                        <div id="bugvariantdetails">\n                        </div>\n                      </div>\n                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\n                      <textarea class="mdl-textfield__input" type="text" rows= "3" id="bugcomment" ></textarea>\n                      <label class="mdl-textfield__label" for="bugcomment">Bug Details</label>\n                    </div>\n                  </div>\n                  <div class="mdl-dialog__actions">\n                    <button type="button" class="mdl-button sendbug">Submit</button>\n                    <button type="button" class="mdl-button close">Close</button>\n                  </div>\n                </dialog>\n              </div>')}n.r(t),n.d(t,{insertUI:()=>i})},5779:(e,t,n)=>{"use strict";function i(){return new Promise((e=>{const t=new BroadcastChannel("ht_tab_monitor");t.onmessage=n=>{const i=n.data;if(i&&i.message){if("isinjected"===i.message)return t.postMessage({message:"reply-injected"});if("reply-injected"===i.message)return e(!0)}},t.postMessage({message:"isinjected"}),setTimeout((()=>{e(!1)}),1e3)}))}n.r(t),n.d(t,{isInjectedToOtherTab:()=>i})},313:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var i=n(3539),a=n(5836),s=n(3613);async function o(e,t,n,o,r,l){(0,i.CONSOLE_MESSAGE)("custom",`Checking qualifying listings of ${n} (${t}).`);let d=0;if(!document.querySelector("#ta #title_must_include").value)return(0,i.CONSOLE_MESSAGE)("custom","No keyword to match title. Skipping range check."),!0;Array.isArray(r)&&r.length>0&&(d=(await async function(e){const t=await(0,a.W)(),n=[];for(const i of e)for(const e of t)i.title.toLowerCase().includes(e.toLowerCase())&&n.push(i);return n}(r)).length),(0,i.CONSOLE_MESSAGE)("custom",`Found ${d} listings of ${n} (${t}) that matches a kw.`);const c=document.getElementById("owner_min_lists").value,u=document.getElementById("owner_max_lists").value;return c&&d<c?((0,i.CONSOLE_MESSAGE)("custom",`Owner ${n} has < min required listings. Skipping.`),l||(await(0,s.skips)().saveToSkipListing(e,`Owner Keyword Listings: ${d} < min: ${c}`),await(0,s.skips)().saveToSkipUsers(t,`Owner Keyword Listings: ${d} < min: ${c}`)),console.log(`Owner Listings (${d}) < min(${c}): Fail`),!1):u&&d>u?((0,i.CONSOLE_MESSAGE)("custom",`Owner ${n} has > max required listings. Skipping.`),l||(await(0,s.skips)().saveToSkipListing(e,`Owner Keyword Listings: ${d} > max: ${u}`),await(0,s.skips)().saveToSkipUsers(t,`Owner Keyword Listings: ${d} > max: ${u}`)),console.log(`Owner Listings (${d}) > max(${u}): Fail`),!1):(console.log(`Owner Listings min(${c}) <= (${d}) < max(${u}): Pass`),!0)}},9632:(e,t,n)=>{"use strict";n.r(t),n.d(t,{isShippingEnabled:()=>a});var i=n(4347);async function a(e){const t=await(0,i.fetchListingDetail)(e);return t&&t.fulfillmentDetails&&t.fulfillmentDetails.shippingEnabled}},5489:(e,t,n)=>{"use strict";n.r(t),n.d(t,{loadInputs:()=>s});var i=n(7426);function a(e){return new Promise((t=>{!function n(){if(e.parentNode.MaterialRadio||e.parentNode.MaterialSwitch)return t(e);setTimeout(n,30)}()}))}function s(){let e=!1;for(const t in localStorage)if(t.startsWith("input_")){const n=t.replace("input_",""),a=localStorage.getItem(t),s=document.getElementById(n);s&&("checkbox"===s.type?"switch-rununtil"===n?((0,i.o)(!0),e=!0,s.checked="true"===a):s.checked="true"===a:s.value=a)}else if(t.startsWith("radio_")){const e=t.replace("radio_",""),n=localStorage.getItem(t);let i=document.getElementsByName(e);if(i&&(i=i[0],"radio"===i.type)){const e=document.getElementById(n);e&&a(e).then((()=>{e.parentNode.MaterialRadio.check()}))}}e||(0,i.o)(!0)}},4219:(e,t,n)=>{"use strict";n.r(t),n.d(t,{loadStats:()=>a});var i=n(9171);function a(){const e=new Date,t=`${e.getFullYear()}${e.getMonth()+1}${e.getDate()}`;let n=localStorage.getItem(`stats_${t}`);if(n){n=JSON.parse(n);const e=["offers","partners","runs","streaks","ko","new_listings","single_listings","multi_listings","skipped"],t={};["offers","partners","runs","streaks","ko","scraped","new_listings","single_listings","multi_listings","skipped"].forEach((e=>{if(e in n){const t=document.getElementById(`stat_${e}`);t&&(t.textContent=n[e])}})),e.forEach((e=>{e in n&&("ko"===e?t.KO=n[e]:t[e]=n[e])})),(0,i._)(t)}}},8792:(e,t,n)=>{"use strict";n.d(t,{AC:()=>o,gp:()=>l,tf:()=>r});var i=n(4484),a=n(1334),s=n(1203);async function o(e,t,n,i){if(await(0,a.FF)())return async function(e,t){const s=await(0,a.gI)(e);if(s&&"object"==typeof s){const e=s[t];if(e){if(n)return e&&e.ts||!0;if(i){const t=new Date(e.ts);if(t.setDate(t.getDate()+i),t>new Date)return e&&e.ts||!0}if(e.expiry&&new Date(e.expiry)>new Date)return e&&e.ts||!0}}}(`skip_${e}`,t)}async function r(e,t,n,o){let r=`skip_${e}`,l=await(0,a.gI)(r);if(l||(l={}),Array.isArray(t))for(const a of t){let t="";"object"==typeof n&&n[a]?t=n[a]:"string"==typeof n&&(t=n),t||s.aNoReasonNeeded.includes(e)||(console.error(`local_saveIdToLog: No reason provided for ${e} ${a}`),await(0,i._apiSendBug)({message:`local_saveIdToLog: No reason provided for ${e} ${a}`,data:{listname:e,i:a}}).catch((e=>{console.error("local_saveIdToLog: Failed to send bug report",e)})));const r={ts:"object"==typeof o&&o[a]?o[a]:(new Date).toISOString()};t&&(r.reason=t),l[a]=r}else{const e=o||(new Date).toISOString();l[t]={ts:e},n&&(l[t].reason=n)}await(0,a.Q5)(r,l)}async function l(e){let t=`skip_${e}`,n=await(0,a.gI)(t);return n||(n={}),n}unsafeWindow.local_isIdInLog=o},1992:(e,t,n)=>{"use strict";n.r(t),n.d(t,{logout:()=>s});var i=n(2425),a=n(3253);function s(){console.log("Sending logout message"),document.getElementById("login_iframe").contentWindow.postMessage({event:"logout"},"*"),window.isRun&&(window.isRun=0),window.issnatchbot&&(0,a.waitForLogin)(i.onSessionReady),(0,i.updateLoggedInUI)(!0)}},9485:(e,t,n)=>{"use strict";function i(){const e=document.querySelector("#ta_maximize");e&&(e.style.display="none");const t=document.querySelector("#ta");t&&(t.style.display="block")}function a(){const e=document.querySelector("#ta_maximize");e&&(e.style.display="flex");const t=document.querySelector("#ta");t&&(t.style.display="none")}n.d(t,{E:()=>i,g:()=>a})},2425:(e,t,n)=>{"use strict";n.r(t),n.d(t,{login_callback:()=>b,login_callbackOLD:()=>v,onSessionReady:()=>y,showSubscription:()=>x,updateLoggedInUI:()=>w});var i=n(3539),a=n(8414),s=n(9971),o=n(4147),r=n(9485),l=n(1023),d=n(4219),c=n(8809),u=n(4053),p=n(1334),m=n(1221);function g(e,t){for(const n in e){const i=h(e[n],t);if(i)return{role:i,domain:n}}return!1}function h(e,t){const n=e.roles;if(Array.isArray(n)){Array.isArray(t)||(t=[t]);for(const e of t)if(n.includes(e))return e}return null}var f=n(1992);function _(e){e?(document.getElementById("stop_messaging_after").parentNode.classList.remove("is-disabled"),document.getElementById("stop_messaging_after").disabled=!1):(document.getElementById("stop_messaging_after").parentNode.classList.add("is-disabled"),document.getElementById("stop_messaging_after").disabled=!0)}function y(e){if(console.log("onSessionReady!",e),console.log("User Details",e),console.log("You are logged in as ",e.uid),(0,l.showLoading)(!1),e.isAnonymous){const e=document.querySelector(".login_container");e&&(e.style.display="block")}else b(e),(0,d.loadStats)(),(0,c.attachEvents)(),(0,u.processWriteQueue)(),window.isAllowed=!0,"true"===localStorage.getItem("input_switch-rununtil")&&(0,s.O)()}function w(e){if(e){let e=document.querySelector(".login_container");e&&(e.style.display="block"),e=document.querySelector("#ta #menu"),e&&(e.style.display="none"),e=document.querySelector("#ta #page2"),e&&(e.style.display=null),e=document.querySelector("#ta #page3"),e&&(e.style.display=null),e=document.querySelector("#ta #page4"),e&&(e.style.display=null),componentHandler&&componentHandler.upgradeDom()}else{let e=document.querySelector(".login_container");e&&(e.style.display="none"),e=document.querySelector("#ta #menu"),e&&(e.style.display="flex"),e=document.querySelector("#ta #page2"),e&&(e.style.display=null),e=document.querySelector("#ta #page3"),e&&(e.style.display=null),e=document.querySelector("#ta #page4"),e&&(e.style.display=null),componentHandler&&componentHandler.upgradeDom()}}async function b(e){w();const t=e&&e.uid;window.taUID=t,unsafeWindow.taUID=t,window.taEmail=e&&e.email,unsafeWindow.taEmail=window.taEmail;const n=await async function(){const e=await(0,p.gI)("subscription_id");if(e)return(0,m.ln)(e)}(),i=await async function(e){const t=e?.claims?.teams;if(t){const e=g(t,["owner","indoor"]);if(e)return{role:"owner",domain:e.domain};const n=g(t,["regular","store_manager"]);if(n)return{role:n.role,domain:n.domain}}return null}(e),a=i?.role;unsafeWindow.$isStoreOrRegular="store_manager"===a||"outdoor"===a||"regular"===a,unsafeWindow.$isStoreOrRegular&&(document.getElementById("row_soldphones").style.display="flex");const s=i?.domain;if(s){const e=await async function(e){try{const t=await fetch(`https://us-central1-trade-apples.cloudfunctions.net/inventory?get_ownerid=1&domain=${e}`),n=await t.json();return console.log("getDomainOwnerId",n),n.ownerid}catch(e){console.error("Failed to get domain owner id",e)}}(s);e&&(window.taPartnerId=e,unsafeWindow.taPartnerId=window.taPartnerId)}else if(t){const e=await S(t);window.taPartnerId=e,unsafeWindow.taPartnerId=window.taPartnerId}let o;window.var_domain=s||"",unsafeWindow.$isStoreOrRegular&&(o=await async function(e,t,n){try{return(await fetch(`https://us-central1-trade-apples.cloudfunctions.net/snatchbots?get_phones_sold=1&email=${t}&uid=${e}&teamid=${n}`).then((e=>e.json())))?.phonesSold||0}catch(e){return console.error("Failed to get phones sold",e),0}}(t,e&&e.email,window.taPartnerId)),function(e,t,n){n?(window.licenseMode="ACTIVE",document.getElementById("row_eject_subscriptionid").style.display="flex"):"owner"===e||"indoor"===e?(window.licenseMode="FREEMIUM",document.getElementById("row_eject_subscriptionid").style.display="none"):"store_manager"===e||"outdoor"===e||"regular"===e?(window.licenseMode=t<20?"TRIAL":"FREEMIUM",document.getElementById("row_eject_subscriptionid").style.display="none"):(window.licenseMode="TRIAL",document.getElementById("row_eject_subscriptionid").style.display="none")}(a,o,n),window.$role=a,window.$phonesSold=o,window.$teamDomain=s,x(a,s,o,n),document.getElementById("taheader").style.display="block",document.getElementById("taheader").style.height="100%"}function v(e){w();const t=e&&e.uid;window.taUID=t,unsafeWindow.taUID=t,window.taEmail=e&&e.email,unsafeWindow.taEmail=window.taEmail,t&&S(t).then((n=>{window.taPartnerId=n,window.taEmail=e&&e.email,(0,a.getPartnerDetails)(n).then((async e=>{if(e.error)return console.error(e.error),void x(e,!1);window.taUID=t,window.var_domain=e&&e.partner_details&&e.partner_details.website&&e.partner_details.website.domain,window.var_domain||(window.var_domain=""),window.taEmail||(window.taEmail=e&&e.partner_details&&e.partner_details.email),window.TrackJS&&window.taEmail&&window.TrackJS&&window.TrackJS.configure({userId:window.taEmail}),x(e,t!==n)}))})),document.getElementById("taheader").style.display="block",document.getElementById("taheader").style.height="100%"}async function S(e){const t=await fetch(`https://us-central1-trade-apples.cloudfunctions.net/partners?isTeammember=1&uid=${e}`).then((e=>e.json()));let n=t&&t.isTeamMember&&t.isTeamMember.partnerId;return n||(n=e),n}async function x(e,t,n,a){try{document.getElementById("phones_sold_last_30_days").textContent=n||0,(0,i.CONSOLE_MESSAGE)("custom","");const o=document.querySelector("#info-header");o&&(o.style.display="flex",o.style.flexDirection="column");const r='<a id="info-logout" href="#" style="color: white;-webkit-highlight: none;">Logout</a>',u=`<span id="ta_minimize" style="user-select: none; position: absolute; left: 0px; height: 38px; margin-top: -7px; width: 30px; font-size: xxx-large; cursor: pointer;">\n          -\n        </span>\n          <span style="text-align: center; line-height: 2px; height: 25px;">\n            <p>License: <span style="font-weight: 500;">FREEMIUM</span></p>\n          </span>\n          <div>\n            <span style="cursor: pointer;" id="logged_email">[${window.taEmail}]</span>\n            <span style="position: absolute; right: 14px;">${r}</span>\n          </div>`,p=`<span id="ta_minimize" style="user-select: none; position: absolute; left: 0px; height: 38px; margin-top: -7px; width: 30px; font-size: xxx-large; cursor: pointer;">\n          -\n        </span>\n          <span style="text-align: center; line-height: 2px; height: 25px;">\n            <p>License: <span style="font-weight: 500;">ACTIVE</span></p>\n          </span>\n          <div>\n            <span style="cursor: pointer;" id="logged_email">[${function(e){if("string"!=typeof e)return"";let t=e.replace(/(snatchbot(?:_sub)?_)(.{5})(.*)(.{5})/,"$1$2...$4");return t.length<5?e:t}(window.taEmail)}]</span>\n            <span style="position: absolute; right: 14px;">${r}</span>\n          </div>`,m=`<span id="ta_minimize" style="user-select: none; position: absolute; left: 0px; height: 38px; margin-top: -7px; width: 30px; font-size: xxx-large; cursor: pointer;">\n          -\n        </span>\n            <span style="text-align: center; line-height: 2px; height: 25px;">\n              <p>License: <span style="font-weight: 500;">TRIAL</span></p>\n            </span>\n            <div>\n              <span style="cursor: pointer;" id="logged_email">[${window.taEmail}]</span>\n              <span style="position: absolute; right: 14px;">${r}</span>\n            </div>`,g="store_manager"===e||"outdoor"===e||"regular"===e;if("owner"===e||"indoor"===e)return o&&(o.innerHTML=u),document.getElementById("row_soldphones").style.display="none",document.getElementById("row_licenseKeyAddBuy").style.display="none",document.getElementById("row_eject_subscriptionid").style.display="none",_(!0),d(),l(),void s();if(a)return o&&(o.innerHTML=p),g||(document.getElementById("row_soldphones").style.display="none"),document.getElementById("row_licenseKeyAddBuy").style.display="none",document.getElementById("row_eject_subscriptionid").style.display="flex",_(!0),d(),l(),void s();if(g)return document.getElementById("row_soldphones").style.display="flex",document.getElementById("row_licenseKeyAddBuy").style.display="flex",_(!0),n<20?(o&&(o.innerHTML=m),_(!1),c(),d(),l(),void s()):(o&&(o.innerHTML=u),d(),l(),void s());document.getElementById("row_soldphones").style.display="flex",document.getElementById("row_licenseKeyAddBuy").style.display="flex",_(!1),o&&(o.innerHTML=m),c();let h=document.querySelector("#info-subscription");h&&(h.textContent=function(e){switch(e){case"owner":return"Owner";case"indoor":return"Indoor";case"outdoor":return"Outdoor";case"store_manager":return"Dropoff Location";case"regular":return"Regular";default:return""}}(e)),h=document.querySelector("#info-website"),h&&(h.textContent=t),d(),l(),s()}catch(e){console.error("Error in showSubscription:",e)}function s(){document.querySelector("#ta_minimize").addEventListener("click",(()=>{(0,r.g)()}))}function l(){document.querySelector("#info-header #info-logout").addEventListener("click",(()=>{console.log("logout"),(0,f.logout)()}))}function d(){document.querySelector("#info-header #logged_email").addEventListener("click",(()=>{let t=`Version:${o.version}\nUID: ${window.taUID}\nEmail: ${window.taEmail}\nPartner ID: ${window.taPartnerId}\nDomain: ${window.var_domain}\nRole: ${e||""}\nLicense: ${window.licenseMode}`;n&&(t+=`\nPhones Sold: ${n}`),console.log("debugInfo",t),navigator.clipboard.writeText(t),alert(t)}))}function c(){if(window.listener_listenAddLicenseKey)return;window.listener_listenAddLicenseKey=!0;const e=document.querySelector("#btn_add_license_key");function t(){const e=prompt("Enter License Key");e&&(0,m.ln)(e)}e.removeEventListener("click",t),e.addEventListener("click",t)}}},9309:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ejectOpenAIApikey:()=>l,generateMessage:()=>c,getAssistants:()=>d,getOpenAIApiKey:()=>s,setOpenAIApiKey:()=>r});var i=n(1334),a=n(1023);async function s(){o(!await(0,i.gI)("openai_apikey"))}function o(e){e?(document.querySelectorAll(".openai_init").forEach((e=>{e.style.display="block"})),document.querySelectorAll(".openai_ready").forEach((e=>{e.style.display="none"})),document.querySelectorAll(".openai_readyflex").forEach((e=>{e.style.display="none"}))):(document.querySelectorAll(".openai_init").forEach((e=>{e.style.display="none"})),document.querySelectorAll(".openai_ready").forEach((e=>{e.style.display="block"})),document.querySelectorAll(".openai_readyflex").forEach((e=>{e.style.display="flex"})),d())}async function r(){const e=document.getElementById("openai_apikey").value;if(!e)return void alert("Please enter your OpenAI API key");(0,a.showLoading)(!0);const t=`https://us-central1-trade-apples.cloudfunctions.net/snatchbots?validate_openai_key=1&key=${e}`,n=await fetch(t).then((e=>e.text()));let s={};try{s=JSON.parse(n)}catch(e){console.error("Error parsing JSON",e,n),s={error:"Error parsing JSON"}}(0,a.showLoading)(!1),s?.valid?(document.getElementById("openai_apikey").value="",await(0,i.Q5)("openai_apikey",e),o(!1)):alert("Invalid OpenAI API key")}async function l(){await(0,i.aD)("openai_apikey"),o(!0)}async function d(){const e=await(0,i.gI)("openai_apikey");if(!e)return void alert("Please enter your OpenAI API key");(0,a.showLoading)(!0);const t=await fetch("https://us-central1-trade-apples.cloudfunctions.net/chatgpt?get_assistants=1",{headers:{Authorization:"Bearer "+e}}).then((e=>e.json()));return(0,a.showLoading)(!1),async function(e,t){const n=document.querySelector('ul[for="assistant_id"]');n.innerHTML="",e.forEach((e=>{const i=document.createElement("li");i.className="mdl-menu__item",i.dataset.val=e.id,i.textContent=e.name||e.id,e.id===t&&(i.dataset.selected=!0),n.appendChild(i)})),async function(){document.querySelectorAll('ul[for="assistant_id"] .mdl-menu__item').forEach((function(e){e.addEventListener("click",(function(){var e=this.getAttribute("data-val"),t=this.textContent;console.log("text",t,e),(0,i.Q5)("assistant_id",e)}))}))}()}(t,await(0,i.gI)("assistant_id")),t}async function c(e,t){if(!(e||t&&0!==t.length))return void alert("Listing has no text or photos");const n=await(0,i.gI)("openai_apikey");if(!n)return void alert("Please enter your OpenAI API key");const a=await(0,i.gI)("assistant_id");if(!a)return void alert("Please select an assistant");const s={};e&&(s.text=e),t&&t.length>0&&(s.photos=t);const o=parseInt(document.getElementById("num_images").value,10);o&&(s.numPhotos=o,t&&t.length>o&&(s.photos=t.slice(0,o)));const r=document.querySelector('[name="image_detail"]:checked');r&&(s.imageDetail=r.value);try{const e=await fetch(`https://us-central1-trade-apples.cloudfunctions.net/chatgpt?generate_message=1&assistant_id=${a}`,{method:"POST",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await e.json();return console.log("generate_message response",t),t}catch(e){return console.error("Network or fetch error",e),alert("An error occurred while generating the message. Please try again."),{error:"An error occurred while generating the message. Please try again."}}}},9107:(e,t,n)=>{"use strict";function i(e,t){if(!t)return e;const n=t>0?Math.ceil(e/Math.abs(t)):Math.floor(e/Math.abs(t));return Math.abs(n*t)}function a(e,t,n,a){n&&(n=Number(n));let s=e;const o=document.querySelector("#listing_price_delta").value||0;s=s.replace(/\[name\]/g,(t||"").split(" ")[0]),s=s.replace(/\[title\]/g,a||"");let r=s.match(/\[price\s?-\s?(\d+)\]/),l=document.getElementById("roundupdown").value;if(l&&(l=parseFloat(l)),void 0!==n&&r&&r.length>1){const e=parseFloat(r[1]);let t=n-parseFloat(e);l&&(t=i(t,l)),t<0&&(t=0),s=s.replace(/\[price\s?-\s?\d+\]/,`$${t}`)}else if(void 0!==n&&s.match(/\[price\]/)){let e=n;o&&(e=function(e,t){return e&&t?t.includes("%")?(t=t.replace(/[^\d\.-]/g,""),e+e*((t=Number(t))/100)):(t=t.replace(/[^\d\.-]/g,""),e+(t=Number(t))):e}(e,o)),l&&(e=i(e,l)),e<0&&(e=0),s=s.replace(/\[price\]/,`$${e}`)}else s=s.replace(/\[price\s?-\s?\d+\]/,"your price");return s}n.d(t,{e:()=>a})},7850:(e,t,n)=>{"use strict";function i(e){if(e.target.id&&"number"===e.target.type){let t=e.target.value;"0"===t||t.startsWith("-")||(e.target.value=`-${t}`)}}n.r(t),n.d(t,{prefix:()=>i})},4227:(e,t,n)=>{"use strict";n.r(t),n.d(t,{processKeyword:()=>S});var i=n(9088),a=n(9217),s=n(1203),o=n(4347),r=n(8365),l=n(3539),d=n(3613),c=n(7367),u=n(1060),p=n(313),m=n(3177),g=n(7164),h=n(4246);async function f(){const e=document.getElementById("streak").value;let t=document.getElementById("timeout_streak_min").value;t||(t=s.timeout_streak[0]);let n=document.getElementById("timeout_streak_max").value;if(n||(n=s.timeout_streak[1]),t&&n&&window.iStreaks>=e){const e=1e3*(0,m.randomIntFromInterval)(t,n),i=(new Date).getTime()+e;(0,l.CONSOLE_MESSAGE)("timeout",{message:"Streak",hh:moment(i).format("HH"),mm:moment(i).format("mm"),ss:moment(i).format("ss")}),await(0,h.sleep)(e),(0,c.stats)().resetCurrentStreak()}}var _=n(9237),y=n(4904),w=n(8944),b=n(9395),v=n(9309);async function S(e,t,n){if(!window.isAllowed)return console.error("You are not allowed to use this bot! x("),"not-allowed";await(0,l.getConsoleMessages)(),await new Promise((e=>{!function t(){if("complete"===document.readyState)return e();setTimeout(t,30)}()})),(0,l.CONSOLE_MESSAGE)("fetching_listings",{keyword:e,zipcode:t},n),console.log("Fetching: ",e,t);let S,x,I=await(0,a.apiOfferUp)().fetchListings(e,t);unsafeWindow.listings=I,console.log(`Listings Fetched: ${I.length}`),(0,l.CONSOLE_MESSAGE)("fetch_listings",{num_listings:I.length,keyword:e,zipcode:t},n),(await(0,c.stats)()).addRun(),I&&Array.isArray(I)&&(0,c.stats)().addTotalListingsScraped(I),I.forEach(((e,t)=>{e.sortOrder=t})),S=I.length,I=await async function(e){e.length;const t=[],n=[];for(const i of e){const e=i.tile&&i.tile.id;if(i.tile&&i.tile.title,e){const a=(0,d.skips)().isSkipListing(e).then((e=>{e||t.push(i)}));n.push(a)}}return await Promise.all(n),t.length,t}(I),x=I.length,console.log("In Listing Skiplist: "+(S-x)),x!==S&&((0,l.CONSOLE_MESSAGE)("custom",`Filtered out ${S-x} listings that were in skip list.`),window.debug&&alert(`Filtered out ${S-x} listings that were in skip list.`)),S=I.length,I=await async function(e){e.length;const t=[],n=[];for(const i of e){const e=i.tile&&i.tile.id,a=(0,d.skips)().isSkipMessagedListing(e).then((e=>{e||t.push(i)}));n.push(a)}return await Promise.all(n),t.length,t}(I),x=I.length,console.log("In Listings Messaged: "+(S-x)),x!==S&&((0,l.CONSOLE_MESSAGE)("custom",`Filtered out ${S-x} listings that were messaged before.`),window.debug&&alert(`Filtered out ${S-x} listings that were messaged before.`)),S=I.length,I=await(0,r.R)(I),x=I.length,console.log("No match in title: "+(S-x)),x!==S&&((0,l.CONSOLE_MESSAGE)("custom",`Filtered out ${S-x} listings that didn't have match in title.`),window.debug&&alert(`Filtered out ${S-x} listings that didn't have match in title.`)),S=I.length,I=await async function(e){const t=e.length,n=[];e=e.filter((e=>{const t=e.tile&&e.tile.title,i=(0,u.KI)(t);return i&&n.push(e),!i}));const i=[];n.forEach((e=>{const t=e.tile&&e.tile.id,n=(0,d.skips)().saveToSkipListing(t,"Title contains skip word");i.push(n)})),(await(0,c.stats)()).addSkipped(n.length),await Promise.all(i);const a=e.length;return a!==t&&(0,l.CONSOLE_MESSAGE)("custom",`Skipped ${t-a} containing skip word.`),e}(I),x=I.length,console.log("Skip word in title: "+(S-x)),x!==S&&(0,l.CONSOLE_MESSAGE)("custom",`Filtered out ${S-x} listings that had skip words in title.`),S=I.length,I=await async function(e){const t=[],n=e.length;if(!document.querySelector("#switch-skipshippingenabled").checked)return e;e=e.filter((e=>{const n=e.tile&&e.tile.fulfillmentDetails&&e.tile.fulfillmentDetails.shippingEnabled,i=e.tile&&e.tile.id;return n&&i&&t.push(e),!n}));const i=[];t.forEach((e=>{const t=e.tile&&e.tile.id,n=(0,d.skips)().saveToSkipListing(t,"Listing is shipping enabled.");i.push(n)})),(await(0,c.stats)()).addSkipped(t.length),await Promise.all(i);const a=e.length;return a!==n&&(0,l.CONSOLE_MESSAGE)("shipping_enabled",{num_listings:n-a}),e}(I),x=I.length,console.log("Shipping Enabled: "+(S-x)),S=I.length,I=await async function(e){const t=[],n=e.length;e=e.filter((e=>"DELETED"!==(e.tile&&e.tile.state)||(t.push(e),!1)));const i=[];t.forEach((e=>{const t=e.tile&&e.tile.id;if(t){const e=(0,d.skips)().saveToSkipListing(t,"Listing is deleted.");i.push(e)}})),(await(0,c.stats)()).addSkipped(t.length),await Promise.all(i);const a=e.length;return a!==n&&(0,l.CONSOLE_MESSAGE)("deleted_listings",{num_listings:n-a}),e}(I),x=I.length,console.log("Already deleted: "+(S-x)),I.sort(((e,t)=>e.sortOrder-t.sortOrder));const k=I.length;console.log(`New Listings: ${k}`);for(let e=0;e<k;e++){if(window.listingsChecked||(window.listingsChecked=0),window.listingsChecked+=1,window.listingsChecked>s.listingsPerKeyword)return window.listingsChecked=0,"listingsPerKeyword reached.";if(!window.isRun)return void console.log("Bot stopped.");if(n!==window.runningInstanceId)return;const r=I[e]&&I[e].tile&&I[e].tile.id,S=I[e]&&I[e].tile&&I[e].tile.title;if(console.log(`(${e+1}/${k}) (${r}) [${S}]`),!r){console.error("listing has no id");continue}const x=await(0,o.fetchListingDetail)(r),E=document.getElementById("listing_max_age");if(E&&x.postDate){const e=E.value;if(Number(e)<1){const t=100*e,n=(0,_.h)(x.postDate);if(n>t)return(0,l.CONSOLE_MESSAGE)("skip_old_listing_hours",{age:n,listing_id:x.id,listing_name:x.title}),await(0,d.skips)().saveToSkipListing(r,`ListingAge ${n}h > MaxAge ${t}h`),(await(0,c.stats)()).addSkipped(),console.log("ListingAge: Fail"),console.log("FAIL: added to listing skip list"),"old_listing_found"}else{const t=(0,_.f)(x.postDate);if(t>e)return(0,l.CONSOLE_MESSAGE)("skip_old_listing",{age:t,listing_id:x.id,listing_name:x.title}),await(0,d.skips)().saveToSkipListing(x.id,`ListingAge ${t}d > MaxAge ${e}d`),(await(0,c.stats)()).addSkipped(),console.log("ListingAge: Fail"),console.log("FAIL: added to listing skip list"),"old_listing_found"}}if(console.log("ListingAge: Pass"),document.querySelector("#switch-skipshippingenabled").checked&&x&&x.fulfillmentDetails&&x.fulfillmentDetails.shippingEnabled){(0,l.CONSOLE_MESSAGE)("shipping_enabled_single",{listing_id:r,listing_name:S},n),await(0,d.skips)().saveToSkipListing(r,"ShippingEnabled"),(await(0,c.stats)()).addSkipped(),console.log("Shipping Enabled: Fail"),console.log("FAIL: added to listing skip list");continue}const L=x.description;if(L){let e=(0,u.AP)(L);if(e){(0,l.CONSOLE_MESSAGE)("skipword_found",{listing_name:S,listing_id:r},n),await(0,d.skips)().saveToSkipListing(r,`Description Skipword "${e}"`),(await(0,c.stats)()).addSkipped(),console.log("Skip word in description: Fail"),console.log("FAIL: added to listing skip list");continue}}console.log("Skip word in description: Pass");const T=x&&x.owner&&x.owner.id,A=x&&x.owner&&x.owner.profile&&x.owner.profile.name;if(!T){console.error(`Failed to get ownerid of listing ${r}!`),(await(0,c.stats)()).addSkipped();continue}const M=await(0,d.skips)().isSkipUser(T);if(M){(0,l.CONSOLE_MESSAGE)("skip_user",{owner_id:T,owner_name:A,listing_id:r,listing_name:S},n);let e=M&&M.reason;e||(e="User is in user skip list."),await(0,d.skips)().saveToSkipListing(r,e),(await(0,c.stats)()).addSkipped(),console.log("In User skip list: Fail"),console.log("FAIL: added to listing skip list");continue}const O=await(0,d.skips)().isSkipMessagedUser(T);if(O){let e=O&&O.reason;e||(e="User is already messaged."),await(0,d.skips)().saveToSkipListing(r,e),await(0,i.addAllUserListingsToSkipList)(T,A,e,r),(0,l.CONSOLE_MESSAGE)("already_messaged",{owner_id:T,owner_name:A,listing_id:r,listing_name:S},n),(await(0,c.stats)()).addSkipped(),console.log(`User ${T} was already messaged ${moment(O).fromNow()}`),await(0,d.skips)().saveToSkipListing(r,`User ${T} was already messaged ${moment(O).fromNow()}`);continue}console.log("In Owner messaged: Pass");let F=document.getElementById("skip_profiles_created_after_year");F&&(F=Number(F.value)),F||(F=s.DEFAULT_SKIP_OWNERCREATION_YEAR);const N=x&&x.owner&&x.owner.profile&&x.owner.profile.dateJoined;if(F<=(new Date).getFullYear()&&N){const e=new Date(N).getFullYear();if(e&&e>=F){(0,l.CONSOLE_MESSAGE)("custom",`Skipped new account ${A} (${T})`);const t=`Profile Created ${e} >= ${F}`;await(0,d.skips)().saveToSkipListing(r,t),await(0,d.skips)().saveToSkipUsers(T,t),(await(0,c.stats)()).addSkipped(),console.log(`Profile created (${e}) >= ${F}: Fail`),console.log("FAIL: added to listing/owner skip list");continue}console.log(`Profile created (${e}) >= ${F}: Pass`)}const C=await(0,a.apiOfferUp)().getUserListings(T);if(C&&Array.isArray(C)&&(await(0,c.stats)()).addTotalListingsScraped(C),await(0,y.TI)("Fetched user listings."),!await(0,p.R)(r,T,A,S,C)){(await(0,c.stats)()).addSkipped(),console.log("FAIL: added to listing/owner skip list");continue}let D,j;console.log("All Pass: Messaging...");const q=document.getElementById("switch-enablegpt");if(q&&q.checked){const e=(0,b.r)(x,C);console.log("Generating message");const i=await(0,v.generateMessage)(e.text,e.photos);if(console.log("Got GPT response",i),"skip"===i.status){await(0,d.skips)().saveToSkipListing(r,i.message);continue}if("message"===i.status){let e=i.message;Array.isArray(e)&&(e=e.join("\n")),D=i.message}else if("error"===i.status)return"halted";j=await(0,g.sendMessage)({listingData:x,instanceId:n,gptMessages:D,zipcode:t})}else if(j=await(0,g.sendMessage)({listingData:x,instanceId:n,zipcode:t}),j){const e=x.price;(0,l.CONSOLE_MESSAGE)("message_sent",{message_sent:j,listing_price:e,listing_id:r,listing_name:S},n),await(0,d.skips)().saveToSkipMessagedListing(r);const t=`Messaged [${T}] [${r}]`;await(0,i.addAllUserListingsToSkipList)(T,A,t,r),await(0,d.skips)().saveToMessagedUsers(T,r);let a=document.getElementById("timeout_listings_messaged_min").value;a||(a=s.userDelay[0]);let o=document.getElementById("timeout_listings_messaged_max").value;o||(o=s.userDelay[1]);const c=1e3*(0,m.randomIntFromInterval)(a,o),u=(new Date).getTime()+c;if((0,l.CONSOLE_MESSAGE)("timeout",{message:`Finished sending all messages to ${A} (${T}).`,hh:moment(u).format("HH"),mm:moment(u).format("mm"),ss:moment(u).format("ss")},n),await(0,h.sleep)(c),await(0,w.isStopAfterXMessagesReached)())return"stop_after_x_messages_reached"}await f()}return"no more results"}},4053:(e,t,n)=>{"use strict";n.r(t),n.d(t,{processWriteQueue:()=>s});var i=n(2287),a=n(6849);async function s(){window.writeQueue||(window.writeQueue=[]);const e=[...window.writeQueue];window.writeQueue=[];for(const t of e)try{t.bot="offerup";let e=await fetch("https://cloudlogging.hopla.workers.dev/marketplacebotstats",{method:"POST",headers:{"Content-Length":"application/json"},body:JSON.stringify(t)}).then((async e=>(0,i.handleFetchErrors)(e))).then((e=>e.text())).catch((e=>{console.log(e)}));"ok"!==e&&(0,a.Z)({error:"Failed to write to dashboard",data:t,sheetsApiResponse:e})}catch(e){console.error(e),(0,a.Z)({error:"Failed to write to dashboard3",data:t})}setTimeout((()=>{s()}),2e3)}},3177:(e,t,n)=>{"use strict";function i(e,t){return Math.floor(Math.random()*(t-e+1)+e)}n.r(t),n.d(t,{randomIntFromInterval:()=>i})},1063:(e,t,n)=>{"use strict";n.r(t),n.d(t,{restoreDefaults:()=>l});var i=n(1203),a=n(2287),s=n(6849),o=n(4246);async function r(){const e=await fetch(`https://sheets.hopla.tools/?HT=${i.sheet_id}&format=json&sheet_name=Content`).then((async e=>(0,a.handleFetchErrors)(e))).then((e=>e.text()));if(e&&!e.includes("message_1"))return r();try{return JSON.parse(e)}catch(t){return await(0,s.Z)({error:"Failed to getDefaultContent. sheets.hopla.tools api response.",res:e}),{}}}function l(){function e(e){if("createEvent"in document){const t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange");e.parentElement&&e.parentElement.MaterialTextfield&&e.parentElement.MaterialTextfield.change(e.value)}document.getElementById("page2loading").style.display="block",async function(){const e=await fetch(`https://sheets.hopla.tools/?HT=${i.sheet_id}&format=json&sheet_name=Settings`).then((async e=>(0,a.handleFetchErrors)(e))).then((e=>e.text()));if(e&&!e.includes("keywords"))return r();try{return JSON.parse(e)}catch(t){return await(0,s.Z)({error:"Failed to getDefaultSettings. sheets.hopla.tools api response.",res:e}),{}}}().then((t=>{if(document.getElementById("page2loading").style.display="none",t.result&&Array.isArray(t.result)&&t.result.length){const n={};t.result.forEach((e=>{n[e.input_name]=e.value}));const i=n.keywords||"",a=n.zipcodes||"",s=n.skip_words_title||"",o=n.skip_words_description||"",r=n.listing_min_price||"",l=n.listing_max_price||"",d=n.listing_max_age||"",c=n.listing_price_delta||"",u=n.price_rounding||"",p=n.must_have||"",m=n.owner_listings_min||"",g=n.owner_listings_max||"",h=n.skip_profiles||"",f=n.owner_message_expiry||"",_=n.followup_after||"",y=n.between_api_calls_min||"",w=n.between_api_calls_max||"",b=n.between_messages_min||"",v=n.between_messages_max||"",S=n.after_listings_messaged_min||"",x=n.after_listings_messaged_max||"",I=n.after_streak_min||"",k=n.after_streak_max||"",E=n.end_of_run_min||"",L=n.end_of_run_max||"",T=n.stop_messaging_after||0;let A=document.querySelector("#keywords");A.value=i,e(A),a&&(A=document.querySelector("#zipcodes"),A.value=a,e(A)),A=document.querySelector("#skipwords_title"),A.value=s,e(A),A=document.querySelector("#skipwords_description"),A.value=o,e(A),A=document.querySelector("#listing_min_price"),A.value=r,e(A),A=document.querySelector("#listing_max_price"),A.value=l,e(A),A=document.querySelector("#listing_max_age"),A.value=d,e(A),A=document.querySelector("#listing_price_delta"),A.value=c,e(A),A=document.querySelector("#roundupdown"),A.value=u,e(A),A=document.querySelector("#title_must_include"),A&&(A.value=p,e(A)),A=document.querySelector("#owner_min_lists"),A&&(A.value=m,e(A)),A=document.querySelector("#owner_max_lists"),A&&(A.value=g,e(A)),A=document.querySelector("#skip_profiles_created_after_year"),A&&(A.value=h,e(A)),A=document.querySelector("#owner_message_expiry"),A&&(A.value=f,e(A)),A=document.querySelector("#followup_after"),A&&(A.value=_,e(A)),A=document.querySelector("#timeout_api_calls_min"),A&&(A.value=y,e(A)),A=document.querySelector("#timeout_api_calls_max"),A&&(A.value=w,e(A)),A=document.querySelector("#timeout_between_messages_min"),A&&(A.value=b,e(A)),A=document.querySelector("#timeout_between_messages_max"),A&&(A.value=v,e(A)),A=document.querySelector("#timeout_listings_messaged_min"),A&&(A.value=S,e(A)),A=document.querySelector("#timeout_listings_messaged_max"),A&&(A.value=x,e(A)),A=document.querySelector("#timeout_streak_min"),A&&(A.value=I,e(A)),A=document.querySelector("#timeout_streak_max"),A&&(A.value=k,e(A)),A=document.querySelector("#timeout_end_of_run_min"),A&&(A.value=E,e(A)),A=document.querySelector("#timeout_end_of_run_max"),A&&(A.value=L,e(A)),A=document.querySelector("#stop_messaging_after"),A&&(A.value=T,e(A))}})).catch((e=>(console.error("Fetch Failed",e),(0,o.sleep)(1e4).then((()=>l()))))),r().then((t=>{if(document.getElementById("page2loading").style.display="none",t.result&&Array.isArray(t.result)&&t.result.length){const n={};t.result.forEach((e=>{n[e.input_name]=e.value}));const i=n.message_1||"",a=n.message_2||"",s=n.message_3||"";let o=document.querySelector("#message_1");o.value=i,e(o),o=document.querySelector("#message_2"),o.value=a,e(o),o=document.querySelector("#message_3"),o.value=s,e(o)}})).catch((e=>(console.error("Fetch Failed",e),(0,o.sleep)(1e4).then((()=>l())))))}},425:(e,t,n)=>{"use strict";n.r(t),n.d(t,{retryDelayWithMessage:()=>r});var i=n(1203),a=n(3539),s=n(3177),o=n(4246);async function r(e){const t=60*(0,s.randomIntFromInterval)(i.botRetryDelay[0],i.botRetryDelay[1])*1e3,n=(new Date).getTime()+t;(0,a.CONSOLE_MESSAGE)("timeout",{message:e||"",hh:moment(n).format("HH"),mm:moment(n).format("mm"),ss:moment(n).format("ss")}),await(0,o.sleep)(t)}},9971:(e,t,n)=>{"use strict";n.d(t,{O:()=>o});var i=n(3372),a=n(7426),s=n(2572);function o(){window.isRun=1,(0,a.o)(!1),async function(){const e=(0,i.generateId)();window.runningInstanceId=e;try{await(0,s.start)(e)}catch(t){console.trace(),console.error("start Caught error!",e,t)}}()}n(7367)},4252:(e,t,n)=>{"use strict";async function i(){const e=await fetch("https://offerup.com/api/graphql",{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9","cache-control":"no-cache","content-type":"application/json","ou-browser-user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36","ou-experiment-data":'{"datamodel_id":"experimentmodel24"}',"ou-session-id":"web-f3250040bab51a89cc88f7803cf0eb38caf6042facd03f1d66de56bb@1721128029436",pragma:"no-cache","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="126", "Google Chrome";v="126"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",userdata:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbiI6eyJjaXR5IjoiR3JlZW53ZWxsIFNwcmluZ3MiLCJzdGF0ZSI6IkxBIiwiemlwQ29kZSI6IjcwNzM5IiwibG9uZ2l0dWRlIjotOTAuOTcwNSwibGF0aXR1ZGUiOjMwLjU5NzYsInNvdXJjZSI6ImlwIn19.ATaPdQl-oiM2vTsHF0W32OI7kEKiycJ1fqzNkmiKQOs","x-ou-d-token":"web-f3250040bab51a89cc88f7803cf0eb38caf6042facd03f1d66de56bb","x-ou-usercontext":'{"device_id":"web-f3250040bab51a89cc88f7803cf0eb38caf6042facd03f1d66de56bb","user_agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36","device_platform":"web","user_id":"138897283"}',"x-request-id":"d3b67711-b841-4389-84f2-2aed03dfe821"},referrer:"https://offerup.com/explore/k/5/1?PRICE_MIN=100&PRICE_MAX=20000",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify({operationName:"GetModularFeed",query:"query GetModularFeed($searchParams: [SearchParam], $debug: Boolean = false) {\n  modularFeed(params: $searchParams, debug: $debug) {\n    analyticsData {\n      requestId\n      searchPerformedEventUniqueId\n      searchSessionId\n      __typename\n    }\n    categoryInfo {\n      categoryId\n      isForcedCategory\n      __typename\n    }\n    feedAdditions\n    filters {\n      ...modularFilterNumericRange\n      ...modularFilterSelectionList\n      __typename\n    }\n    legacyFeedOptions {\n      ...legacyFeedOptionListSelection\n      ...legacyFeedOptionNumericRange\n      __typename\n    }\n    looseTiles {\n      ...modularTileBanner\n      ...modularTileBingAd\n      ...modularTileGoogleDisplayAd\n      ...modularTileJob\n      ...modularTileEmptyState\n      ...modularTileListing\n      ...modularTileLocalDisplayAd\n      ...modularTileSearchAlert\n      ...modularTileSellerAd\n      ...modularModuleTileAdsPostXAd\n      __typename\n    }\n    modules {\n      ...modularGridModule\n      __typename\n    }\n    pageCursor\n    query {\n      ...modularQueryInfo\n      __typename\n    }\n    requestTimeMetadata {\n      resolverComputationTimeSeconds\n      serviceRequestTimeSeconds\n      totalResolverTimeSeconds\n      __typename\n    }\n    searchAlert {\n      alertId\n      alertStatus\n      searchAlertCount\n      __typename\n    }\n    personalizationPath\n    debugInformation @include(if: $debug) {\n      rankedListings {\n        listingId\n        attributes {\n          key\n          value\n          __typename\n        }\n        __typename\n      }\n      lastViewedItems {\n        listingId\n        attributes {\n          key\n          value\n          __typename\n        }\n        __typename\n      }\n      categoryAffinities {\n        affinity\n        count\n        decay\n        affinityOwner\n        __typename\n      }\n      rankingStats {\n        key\n        value\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment modularFilterNumericRange on ModularFeedNumericRangeFilter {\n  isExpandedHighlight\n  lowerBound {\n    ...modularFilterNumericRangeBound\n    __typename\n  }\n  shortcutLabel\n  shortcutRank\n  subTitle\n  targetName\n  title\n  type\n  upperBound {\n    ...modularFilterNumericRangeBound\n    __typename\n  }\n  __typename\n}\n\nfragment modularFilterNumericRangeBound on ModularFeedNumericRangeFilterNumericRangeBound {\n  label\n  limit\n  placeholderText\n  targetName\n  value\n  __typename\n}\n\nfragment modularFilterSelectionList on ModularFeedSelectionListFilter {\n  targetName\n  title\n  subTitle\n  shortcutLabel\n  shortcutRank\n  type\n  isExpandedHighlight\n  options {\n    ...modularFilterSelectionListOption\n    __typename\n  }\n  __typename\n}\n\nfragment modularFilterSelectionListOption on ModularFeedSelectionListFilterOption {\n  isDefault\n  isSelected\n  label\n  subLabel\n  value\n  __typename\n}\n\nfragment legacyFeedOptionListSelection on FeedOptionListSelection {\n  label\n  labelShort\n  name\n  options {\n    default\n    label\n    labelShort\n    selected\n    subLabel\n    value\n    __typename\n  }\n  position\n  queryParam\n  type\n  __typename\n}\n\nfragment legacyFeedOptionNumericRange on FeedOptionNumericRange {\n  label\n  labelShort\n  leftQueryParam\n  lowerBound\n  name\n  options {\n    currentValue\n    label\n    textHint\n    __typename\n  }\n  position\n  rightQueryParam\n  type\n  units\n  upperBound\n  __typename\n}\n\nfragment modularTileBanner on ModularFeedTileBanner {\n  tileId\n  tileType\n  title\n  __typename\n}\n\nfragment modularTileBingAd on ModularFeedTileBingAd {\n  tileId\n  bingAd {\n    ouAdId\n    adExperimentId\n    adNetwork\n    adRequestId\n    adTileType\n    adSettings {\n      repeatClickRefractoryPeriodMillis\n      __typename\n    }\n    bingClientId\n    clickFeedbackUrl\n    clickReturnUrl\n    contentUrl\n    deepLinkEnabled\n    experimentDataHash\n    image {\n      height\n      url\n      width\n      __typename\n    }\n    impressionFeedbackUrl\n    impressionUrls\n    viewableImpressionUrls\n    installmentInfo {\n      amount\n      description\n      downPayment\n      __typename\n    }\n    itemName\n    lowPrice\n    price\n    searchId\n    sellerName\n    templateFields {\n      key\n      value\n      __typename\n    }\n    __typename\n  }\n  tileType\n  __typename\n}\n\nfragment modularTileGoogleDisplayAd on ModularFeedTileGoogleDisplayAd {\n  tileId\n  googleDisplayAd {\n    ouAdId\n    additionalSizes\n    adExperimentId\n    adHeight\n    adNetwork\n    adPage\n    adRequestId\n    adTileType\n    adWidth\n    adaptive\n    channel\n    clickFeedbackUrl\n    clientId\n    contentUrl\n    customTargeting {\n      key\n      values\n      __typename\n    }\n    displayAdType\n    errorDrawable {\n      actionPath\n      listImage {\n        height\n        url\n        width\n        __typename\n      }\n      __typename\n    }\n    experimentDataHash\n    formatIds\n    impressionFeedbackUrl\n    personalizationProperties {\n      key\n      values\n      __typename\n    }\n    prebidConfigs {\n      key\n      values {\n        timeout\n        tamSlotUUID\n        liftoffPlacementIDs\n        __typename\n      }\n      __typename\n    }\n    renderLocation\n    searchId\n    searchQuery\n    templateId\n    __typename\n  }\n  tileType\n  __typename\n}\n\nfragment modularTileJob on ModularFeedTileJob {\n  tileId\n  tileType\n  job {\n    address {\n      city\n      state\n      zipcode\n      __typename\n    }\n    companyName\n    datePosted\n    image {\n      height\n      url\n      width\n      __typename\n    }\n    industry\n    jobId\n    jobListingUrl\n    jobOwnerId\n    pills {\n      text\n      type\n      __typename\n    }\n    title\n    apply {\n      method\n      value\n      __typename\n    }\n    wageDisplayValue\n    provider\n    __typename\n  }\n  __typename\n}\n\nfragment modularTileEmptyState on ModularFeedTileEmptyState {\n  tileId\n  tileType\n  title\n  description\n  iconType\n  __typename\n}\n\nfragment modularTileListing on ModularFeedTileListing {\n  tileId\n  listing {\n    ...modularListing\n    __typename\n  }\n  tileType\n  __typename\n}\n\nfragment modularListing on ModularFeedListing {\n  listingId\n  conditionText\n  flags\n  image {\n    height\n    url\n    width\n    __typename\n  }\n  isFirmPrice\n  locationName\n  price\n  title\n  vehicleMiles\n  __typename\n}\n\nfragment modularTileLocalDisplayAd on ModularFeedTileLocalDisplayAd {\n  tileId\n  localDisplayAd {\n    ouAdId\n    adExperimentId\n    adNetwork\n    adRequestId\n    adTileType\n    advertiserId\n    businessName\n    callToAction\n    callToActionType\n    clickFeedbackUrl\n    contentUrl\n    experimentDataHash\n    headline\n    image {\n      height\n      url\n      width\n      __typename\n    }\n    impressionFeedbackUrl\n    searchId\n    __typename\n  }\n  tileType\n  __typename\n}\n\nfragment modularTileSearchAlert on ModularFeedTileSearchAlert {\n  tileId\n  tileType\n  title\n  __typename\n}\n\nfragment modularTileSellerAd on ModularFeedTileSellerAd {\n  tileId\n  listing {\n    ...modularListing\n    __typename\n  }\n  sellerAd {\n    ouAdId\n    adId\n    adExperimentId\n    adNetwork\n    adRequestId\n    adTileType\n    clickFeedbackUrl\n    experimentDataHash\n    impressionFeedbackUrl\n    searchId\n    __typename\n  }\n  tileType\n  __typename\n}\n\nfragment modularModuleTileAdsPostXAd on ModularFeedTileAdsPostXAd {\n  ...modularTileAdsPostXAd\n  moduleId\n  moduleRank\n  moduleType\n  __typename\n}\n\nfragment modularTileAdsPostXAd on ModularFeedTileAdsPostXAd {\n  tileId\n  adsPostXAd {\n    ouAdId\n    adExperimentId\n    adNetwork\n    adRequestId\n    adTileType\n    clickFeedbackUrl\n    experimentDataHash\n    impressionFeedbackUrl\n    searchId\n    offer {\n      beacons {\n        noThanksClick\n        close\n        __typename\n      }\n      title\n      description\n      clickUrl\n      image\n      pixel\n      ctaYes\n      ctaNo\n      __typename\n    }\n    __typename\n  }\n  tileType\n  __typename\n}\n\nfragment modularGridModule on ModularFeedModuleGrid {\n  moduleId\n  collection\n  formFactor\n  grid {\n    actionPath\n    tiles {\n      ...modularModuleTileBingAd\n      ...modularModuleTileGoogleDisplayAd\n      ...modularModuleTileListing\n      ...modularModuleTileLocalDisplayAd\n      ...modularModuleTileSellerAd\n      __typename\n    }\n    __typename\n  }\n  moduleType\n  rank\n  rowIndex\n  searchId\n  subTitle\n  title\n  infoActionPath\n  feedIndex\n  __typename\n}\n\nfragment modularModuleTileBingAd on ModularFeedTileBingAd {\n  ...modularTileBingAd\n  moduleId\n  moduleRank\n  moduleType\n  __typename\n}\n\nfragment modularModuleTileGoogleDisplayAd on ModularFeedTileGoogleDisplayAd {\n  ...modularTileGoogleDisplayAd\n  moduleId\n  moduleRank\n  moduleType\n  __typename\n}\n\nfragment modularModuleTileListing on ModularFeedTileListing {\n  ...modularTileListing\n  moduleId\n  moduleRank\n  moduleType\n  __typename\n}\n\nfragment modularModuleTileLocalDisplayAd on ModularFeedTileLocalDisplayAd {\n  ...modularTileLocalDisplayAd\n  moduleId\n  moduleRank\n  moduleType\n  __typename\n}\n\nfragment modularModuleTileSellerAd on ModularFeedTileSellerAd {\n  ...modularTileSellerAd\n  moduleId\n  moduleRank\n  moduleType\n  __typename\n}\n\nfragment modularQueryInfo on ModularFeedQueryInfo {\n  appliedQuery\n  decisionType\n  originalQuery\n  suggestedQuery\n  __typename\n}",variables:{debug:!1,searchParams:[{key:"PRICE_MIN",value:"100"},{key:"PRICE_MAX",value:"20000"},{key:"platform",value:"web"},{key:"lon",value:"-90.9705"},{key:"lat",value:"30.5976"},{key:"experiment_id",value:"experimentmodel24"},{key:"cid",value:"5.1"},{key:"limit",value:"50"},{key:"searchSessionId",value:"84bfbad0-c67a-49f5-97ec-af5f6859a5e7"}]}}),method:"POST",mode:"cors",credentials:"include"}).then((e=>e.text()));let t={};try{t=JSON.parse(e)}catch(n){console.log("Failed to parse category response",n),t={error:"Failed to parse category response",textResponse:e}}return t}n.r(t),n.d(t,{searchCategory:()=>i})},6849:(e,t,n)=>{"use strict";function i(e){return fetch("https://webhook.hopla.workers.dev?project=OfferUpBot",{method:"POST",body:JSON.stringify(e),mode:"no-cors"})}n.d(t,{Z:()=>i})},7164:(e,t,n)=>{"use strict";n.r(t),n.d(t,{sendMessage:()=>_});var i=n(9217),a=n(1203),s=n(4904),o=n(6198),r=n(3539),l=(n(5458),n(9107)),d=n(3177),c=n(2617),u=n(2287),p=n(4246),m=n(3613),g=n(7367),h=n(8944),f=n(8329);async function _({listingData:e,instanceId:t,gptMessages:n,zipcode:_}){let y=!1;if(!window.isRun)return void console.log("bot stopped.");if(t!==window.runningInstanceId)return void console.log("Cancelled sending message because of different instance id.");let w=!1;const b=e.id,v=e.title,S=e.owner.id,x=e.owner.profile.name;let I,k="",E="",L=!1;const T=e.price,A=n&&n[0],M=n&&n[1],O=n&&n[2];let F=A||(0,f.z)().message_1;F&&await C(F,A?"gpt_message_1":"message_1",e),F=M||(0,f.z)().message_2,F&&await C(F,M?"gpt_message_2":"message_2",e),F=O||(0,f.z)().message_3,F&&await C(F,O?"gpt_message_3":"message_3",e),I&&document.querySelector("#switch-deleteaftersend").checked&&(await(0,i.apiOfferUp)(t).deleteMessage(I),console.log("Conversation Deleted/Archived")),window.messagesSent+=1;const N={uid:S,ownerName:x,listingid:b,message:k,templateName:E};return _&&(N.zipcode=_),await async function(e){if(a.disableLogs)return;const{uid:t,ownerName:n,listingid:i,message:s,templateName:o}=e,r={Date:(new Date).toGMTString(),UserID:t,Name:n,ListingID:i,"Message Sent":s,template:o,tabId:window.tabId,extension_version:window.extension_version},l=(0,c.getUserEmail)();return l&&(r.email=l),async function e(t){return fetch("https://sheets.hopla.tools/?HT=9ec6989caf07d1305c6c386880840f8a&mode=log",{method:"POST",body:JSON.stringify(r)}).then((async e=>(0,u.handleFetchErrors)(e))).then((e=>e.text())).catch((async n=>(console.error("Fetch Failed (sendBotLog)",n,t),t&&t>6?"":(await(0,p.sleep)(1e4),t||(t=0),e(t+=1)))))}().catch((e=>(console.error("Fetch Failed (sendBotLog))",e),"")))}(N),!!y&&k;async function C(e,n,c){if(F=e,F){F=(0,l.e)(F,x,T,v);const e=await(0,i.apiOfferUp)(t).sendMessage(b,F,v,S,x);if(w||(w=!0,(await(0,h.stopAfterXMessages)()).addMessageSent()),"STOP"===e)return void console.log("Stopped sending messages to user because other user is blocked.");if(e&&e.includes("STOP-"))return void console.log(e.replace("STOP-",""));await async function(e,t){await(0,m.skips)().saveToSkipMessagedListing(e),await(0,m.skips)().saveToMessagedUsers(t,e)}(b,S),L||(await async function(){(await(0,g.stats)()).addOffer(),(await(0,g.stats)()).addStreak()}(),L=!0),await(0,o.addFollowupEntry)(b,c),y=!0,I||(I=e),(0,r.CONSOLE_MESSAGE)("message_sent",{message_sent:F,listing_price:T,listing_id:b,listing_name:v},t);const u=1e3*(0,d.randomIntFromInterval)(a.messageDelay[0],a.messageDelay[1]),f=(new Date).getTime()+u;(0,r.CONSOLE_MESSAGE)("timeout",{message:"Message Sent",hh:moment(f).format("HH"),mm:moment(f).format("mm"),ss:moment(f).format("ss")},t),await(0,p.sleep)(u),k&&(k+="\n"),k+=F,E&&(E+=", "),E+=n,await(0,s.Xh)(`Message Template ${n} has been sent.`)}}}},7426:(e,t,n)=>{"use strict";function i(e){e||window.viewermode?window.isViewMode=!0:(document.querySelector('#ta #menu a[href="#page2"]').click(),window.isViewMode=!1),window.viewermode&&(document.querySelector("#menu").style.display="none")}n.d(t,{o:()=>i}),n(8927),n(5458)},7091:(e,t,n)=>{"use strict";function i(e){window.isKO||e.match&&(window.navigator.onLine||e.match(/offline/))&&(document.querySelector("#statustext").textContent=e)}n.r(t),n.d(t,{showLastConsoleLog:()=>i})},1023:(e,t,n)=>{"use strict";function i(e){if(e===window.prevShowLoadingState)return;window.prevShowLoadingState=e;let t=document.querySelector("#loadingoverlay");t?t.style.display=e?"flex":"none":function(e){const t=document.querySelector("#ta");t&&(t.insertAdjacentHTML("afterbegin",`<div id="loadingoverlay" style="display: ${e?"flex":"none"};" class='loading-one'>\n          <div class='loading-two'>\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"\n                  class='svg'>\n                  <circle r="80" cx="500" cy="90" class='circle-one' />\n                  <circle r="80" cx="500" cy="910" class='circle-one' />\n                  <circle r="80" cx="90" cy="500" class='circle-one' />\n                  <circle r="80" cx="910" cy="500" class='circle-one' />\n                  <circle r="80" cx="212" cy="212" class='circle-one' />\n                  <circle r="80" cx="788" cy="212" class='circle-one' />\n                  <circle r="80" cx="212" cy="788" class='circle-one' />\n                  <circle r="80" cx="788" cy="788" class='circle-one' />\n              </svg>\n          </div>\n          <span style="position: fixed; padding-top: 165px;">Loading. Please wait...</span>\n      </div>\n    `),document.head.insertAdjacentHTML("beforeend","<style>\n      /* Loading Overlay - START */\n      .loading-one {\n        box-sizing: border-box;\n        display: flex;\n        position: absolute;\n        flex-flow: column nowrap;\n        align-items: center;\n        justify-content: space-around;\n        background: rgba(255, 255, 255, 0.8);\n        top: 0px;\n        left: 0px;\n        width: 100%;\n        height: 100%;\n        z-index: 2147483647;\n      }\n\n      .loading-two {\n        order: 1;\n        box-sizing: border-box;\n        overflow: visible;\n        flex: 0 0 auto;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        animation-name: around;\n        animation-duration: 2000ms;\n        animation-timing-function: linear;\n        animation-iteration-count: infinite;\n        width: 120px;\n        height: 120px;\n      }\n\n      .circle-one {\n        fill: var(--black);\n      }\n\n      .svg {\n        width: 100%;\n        height: 100%;\n        fill: var(--black);\n      }\n\n      @keyframes around {\n        0% {\n          transform: rotate(0deg)\n        }\n\n        100% {\n          transform: rotate(360deg)\n        }\n      }\n\n      /* Loading Overlay - END */\n    </style>"))}(e)}n.r(t),n.d(t,{showLoading:()=>i})},3613:(e,t,n)=>{"use strict";n.r(t),n.d(t,{skips:()=>g});var i=n(9217),a=n(4347);function s(e){let t=Number(document.querySelector("#listing_min_price").value)||0,n=Number(document.querySelector("#listing_max_price").value)||0;return 0===t&&0===n||e>=t&&e<=n}var o=n(9237),r=n(3539),l=(n(9105),n(2287)),d=n(9632),c=n(4246),u=n(1060),p=n(4484),m=n(8792);function g(){async function e(e,t,n,i){let a=`https://us-central1-trade-apples.cloudfunctions.net/offerupbot?batch=1&listname=${e}`;n&&(a+=`&localcheck=${window.taPartnerId}`),i&&(a+=`&reason=${i}`),await(0,m.tf)(e,t,i);return await async function e(n){return fetch(a,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).catch((async t=>(console.error("Fetch Failed (saveIdToLogBatch)",t,n),n&&n>6?"":(await(0,c.sleep)(1e4),n||(n=0),e(n+=1)))))}().then((n=>{try{const i=JSON.parse(n);if(!i.success||"added"!==i.success)return(0,p._apiSendBug)({error:"Failed to copy ids from storage to db",listname:e,aIds:t,response:n})}catch(i){return(0,p._apiSendBug)({error:"Failed copy ids from storage to db",listname:e,aIds:t,response:n})}}))}async function t(e,t,n,i){let a=`https://us-central1-trade-apples.cloudfunctions.net/offerupbot?listname=${e}&id=${t}&email=${window.taEmail}`;n&&(a+=`&localcheck=${window.taPartnerId}`),i&&(a+=`&reason=${i}`),await(0,m.tf)(e,t,i);return await async function e(t){return fetch(a,{method:"POST"}).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).catch((async n=>(console.error("Fetch Failed (saveIdToLog)",n,t),t&&t>6?"":(await(0,c.sleep)(1e4),t||(t=0),e(t+=1)))))}().then((n=>{try{const i=JSON.parse(n);if(!i.success||"added"!==i.success)return(0,p._apiSendBug)({error:"Failed to save to log",listname:e,id:t,response:n})}catch(i){return(0,p._apiSendBug)({error:"Failed to save to log",listname:e,id:t,response:n})}}))}async function n(t,n){let i=localStorage.getItem(t);i&&(i=JSON.parse(i),i&&Array.isArray(i)&&i.length&&(await e(n,i),localStorage.setItem(t,"[]")))}async function h(e,t,n,i,a){let s=`https://us-central1-trade-apples.cloudfunctions.net/offerupbot?isexist=${t}&listname=${e}`;n&&(s+="&noexpiry=1"),a&&(s+=`&expiryInDays=${a}`),i&&(s+=`&localcheck=${window.taPartnerId}`);let o=await(0,m.AC)(e,t,n,a);return o||(o=await async function e(t){return fetch(s).then((async e=>(0,l.handleFetchErrors)(e))).then((e=>e.text())).catch((async n=>(console.error("Fetch Failed (isIdInLog)",n,t),t&&t>6?"":(await(0,c.sleep)(1e4),t||(t=0),e(t+=1)))))}().then((n=>{try{const i=JSON.parse(n);return"success"in i?i.success:((0,p._apiSendBug)({error:"Failed to check logs",listname:e,id:t,response:n}),!1)}catch(i){return(0,p._apiSendBug)({error:"Failed to check logs",listname:e,id:t,response:n}),!1}})),o)}return{saveToPartnerMessaged:e=>t("partnermessage",e),saveToMessagedUsers:(e,n)=>t("users",e,!0,n),saveToSkipUsers:(e,n)=>t("usersskip",e,!0,n),saveToSkipListing:(e,n)=>t("listings",e,!0,n),saveToSkipListingBatch:(t,n)=>{e("listings",t,!0,n)},isSkipListing:async e=>{let t="listings";return await n("skip_listings",t),h(t,e,!0,!0)},getOtherIphoneListings:async function(e,t,n){if(!t){const n=await(0,a.fetchListingDetail)(e);if(!n||!n.owner)return void(0,p._apiSendBug)({error:"getOtherIphoneListings failed. No listing owner returned."});t=n.owner.id}const l=[];(0,r.CONSOLE_MESSAGE)("custom",`Fetching other listings of ${n} (${t})`);const c=await(0,i.apiOfferUp)().getUserListings(t);let m=document.querySelector("#ta #keywords").value.split(",").map((e=>e.trim())).join("|");m.startsWith("|")&&(m=m.substring(1)),m.endsWith("|")&&(m=m.substring(0,m.length-1));for(const t of c)if(t.id!==e&&t.listingId!==e&&t.title){const e=t.title,n=t.description,i=t.postDate,a=Number(t.price),c=new RegExp(m,"i");if(i){const e=document.getElementById("listing_max_age");if(e){const n=e.value,a=(0,o.f)(i);if(a>n){(0,r.CONSOLE_MESSAGE)("skip_old_listing",{age:a,listing_id:t.id,listing_name:t.title});continue}}}if(await g().isSkipListing(t.listingId))continue;if(!e.match(c))continue;let p=(0,u.KI)(e);if(!p&&n&&(p=(0,u.AP)(n)),p)continue;if(!s(a))continue;const h=await(0,d.isShippingEnabled)(t.listingId);if(document.querySelector("#switch-skipshippingenabled").checked&&h&&t.listingId){await g().saveToSkipListing(t.listingId);continue}l.push(t.id)}return[...new Set(l)]},isSkipMessagedUser:async e=>(await n("skip_messagedusers","users"),h("users",e,"",!0,document.getElementById("owner_message_expiry").value||"")),isSkipUser:async e=>(await n("skip_usersskip","usersskip"),h("usersskip",e,"",!0,document.getElementById("owner_message_expiry").value||"")),isSkipPartnerMessage:async e=>(await n("skip_partnermessaged","partnermessage"),h("partnermessage",e,!0)),saveToSkipMessagedListing:e=>t("listings_messaged",e,!0),isSkipMessagedListing:async e=>{let t="listings_messaged";return await n(`skip_${t}`,t),h(t,e,!0,!0)}}}},4246:(e,t,n)=>{"use strict";function i(e){return new Promise((t=>setTimeout(t,e)))}n.r(t),n.d(t,{sleep:()=>i})},1221:(e,t,n)=>{"use strict";n.d(t,{TQ:()=>d,ln:()=>l});var i=n(1334),a=n(1203),s=n(2617),o=n(2425),r=n(1023);async function l(e){(0,r.showLoading)(!0),"string"!=typeof e&&(e="");const t=(0,s.getUserEmail)();if(!t)return void alert("You need to be logged in to offerup to use snatchbot");const n=await async function(e,t){return fetch(`https://us-central1-trade-apples.cloudfunctions.net/snatchbots?app=offerupbot&location_id=${a.losenolead_locationid}&check_subscription_id=${e}&email=${t}`).then((e=>e.json()))}(e,t);return(0,r.showLoading)(!1),n&&"active"===n.status?(window.issnatchbot=!0,(0,i.Q5)("subscription_id",e),async function(e){(0,o.updateLoggedInUI)(),window.taUID=e,unsafeWindow.taUID=e,window.taPartnerId=window.taPartnerId||"snatchbot_"+e,window.taEmail=window.taEmail||"snatchbot_"+e,unsafeWindow.taEmail=window.taEmail,unsafeWindow.taPartnerId=window.taPartnerId,window.TrackJS&&window.taEmail&&window.TrackJS&&window.TrackJS.configure({userId:window.taEmail}),window.licenseMode="ACTIVE",(0,o.showSubscription)(window.$role,window.$teamDomain,window.$phonesSold,!0),unsafeWindow.$isStoreOrRegular||(document.getElementById("row_soldphones").style.display="none"),document.getElementById("row_licenseKeyAddBuy").style.display="none",document.getElementById("row_eject_subscriptionid").style.display="flex"}(e),!0):(document.getElementById("row_eject_subscriptionid").style.display="none",n&&"canceled"===n.status?(d({clear:!0}),void alert("This subscription is already cancelled")):"paused"===n?.status||"past_due"===n?.status?(d({clear:!0}),void alert("This subscription is "+n.status)):(n.status&&alert(n.status),void(n.error&&alert(n.error))))}async function d(e){const t=e&&e.clear,n=await(0,i.gI)("subscription_id");if(n){const e=(0,s.getUserEmail)();if(!e)return void alert("You need to be logged in to facebook to use snatchbot");const o=await async function(e,t){return fetch(`https://us-central1-trade-apples.cloudfunctions.net/snatchbots?app=offerupbot&location_id=${a.losenolead_locationid}&release_subscription_id=${e}&email=${t}`).then((e=>e.json()))}(n,e);o.success?t&&(0,i.Q5)("subscription_id",""):console.error("Failed to release subscription",o)}}},2572:(e,t,n)=>{"use strict";function i(){if(Array.from(document.querySelectorAll("button")).find((e=>"Log in"===e.textContent))&&(alert("You are not logged in! You have to login to offerup first."),1))return!1;let e=document.querySelector("#runfrom").value,t=document.querySelector("#rununtil").value;if(t&&e){e=e.split(":"),t=t.split(":");const n=new Date,i=new Date;i.setHours(e[0],e[1]);const a=new Date;return a.setHours(t[0],t[1]),i>a&&a.setDate(a.getDate()+1),n>=i&&n<=a}return alert("No schedule set! Bot will not run."),!1}n.r(t),n.d(t,{start:()=>v});var a=n(1203),s=n(3539),o=n(5836);function r(){let e=localStorage.getItem("tsSpamDetected");if(e){e=parseInt(e,10);const t=(new Date).getTime();if(t<e)return e-t}return!1}var l=n(4219),d=n(4227),c=n(7426);function u(){document.querySelector("#switch-rununtil").parentElement.MaterialSwitch?((0,c.o)(!0),document.querySelector("#switch-rununtil").parentElement.MaterialSwitch.off(),localStorage.setItem("input_switch-rununtil",!1),localStorage.removeItem("lastKwIdx")):setTimeout((()=>{u()}),2e3)}var p=n(7091),m=n(4246),g=n(7121),h=n(3443),f=n(7367);function _(e){window.isWaitingForSchedule?(0,s.CONSOLE_MESSAGE)("halted_schedule"):(window.isWaitingForSchedule=!0,document.getElementById("switch-rununtil").checked?((0,s.CONSOLE_MESSAGE)("halted_schedule"),i()?(window.isWaitingForSchedule=!1,window.isRun=1,(0,f.stats)().resetCurrentStreak(),v(e)):setTimeout((()=>{window.isWaitingForSchedule=!1,_(e)}),5e3)):window.isWaitingForSchedule=!1)}var y=n(3177),w=n(6198),b=n(8944);async function v(e){console.log("start",e);try{if(window.viewermode)return void(0,p.showLastConsoleLog)("Tab is in viewer mode.");if(document&&document.body&&document.body.innerHTML&&document.body.innerHTML.includes("OfferUp is only available in the US"))return void(0,s.CONSOLE_MESSAGE)("custom","Offerup is only available in the US. Bot wont run.");(0,g.X)(!1);const t=setInterval((()=>{i()||(window.isRun=0,(0,s.CONSOLE_MESSAGE)("halted_schedule"),clearInterval(t),(0,g.X)(!0),_(e))}),1e4);if(!i())return clearInterval(t),(0,g.X)(!0),void _(e);if(a.showAlerts&&alert("start"),!(0,h.validateSpintaxes)())return u(),void(0,g.X)(!0);if((0,l.loadStats)(),r()){const e=r(),t=(new Date).getTime()+e;(0,s.CONSOLE_MESSAGE)("halted_soft",{hh:moment(t).format("HH"),mm:moment(t).format("mm"),ss:moment(t).format("ss")}),await(0,m.sleep)(e)}const{keyword:n,zipcode:c,error:f,isEnd:S}=(0,o.e)();if(f)return void console.error(f);if(!document.getElementById("switch-loopsearch").checked&&S){if(!localStorage.getItem("wasEnd"))return localStorage.setItem("wasEnd",1),void(0,s.CONSOLE_MESSAGE)("custom","Bot stopped because all Search & Locations completed.");localStorage.removeItem("wasEnd")}for(let t=1;t<40;){if(!window.isRun){console.log("Bot stopped.");break}if(e!==window.runningInstanceId)return;let t;if(await(0,b.isStopAfterXMessagesReached)()?t="stop_after_x_messages_reached":(console.log(`Query ${n} ${c}`),t=await(0,d.processKeyword)(n,c,e),console.log("processKeyword res",t)),await(0,w.followup)(),"no more results"===t){const t=(0,y.randomIntFromInterval)(1,5),n=(new Date).getTime()+60*t*1e3;return(0,s.CONSOLE_MESSAGE)("timeout",{message:"No listings left..",hh:moment(n).format("HH"),mm:moment(n).format("mm"),ss:moment(n).format("ss")}),await(0,m.sleep)(60*t*1e3),console.log("start3",e),void v(e)}if("listingsPerKeyword reached."===t){const t=(0,y.randomIntFromInterval)(1,5),n=(new Date).getTime()+60*t*1e3;return(0,s.CONSOLE_MESSAGE)("timeout",{message:"Listings per keyword has been reached. Starting a new search.",hh:moment(n).format("HH"),mm:moment(n).format("mm"),ss:moment(n).format("ss")}),await(0,m.sleep)(60*t*1e3),console.log("start4",e),void v(e)}if("stop_after_x_messages_reached"===t){const t=(0,y.randomIntFromInterval)(15,20),n=(new Date).getTime()+60*t*1e3,i=await(await(0,b.stopAfterXMessages)()).getMessagesSent();return(0,s.CONSOLE_MESSAGE)("timeout",{message:`${"TRIAL"===window.licenseMode?"TRIAL: ":""}Stopped messaging after sending ${i} messages.`,hh:moment(n).format("HH"),mm:moment(n).format("mm"),ss:moment(n).format("ss")}),await(0,m.sleep)(60*t*1e3),console.log("start5",e),void v(e)}if("not-allowed"===t)return void(0,s.CONSOLE_MESSAGE)("custom","You are not allowed to use this bot.");if("old_listing_found"===t){const t=(0,y.randomIntFromInterval)(1,5),n=(new Date).getTime()+60*t*1e3;return(0,s.CONSOLE_MESSAGE)("timeout",{message:"Found an old listing. Will move to next keyword..",hh:moment(n).format("HH"),mm:moment(n).format("mm"),ss:moment(n).format("ss")}),await(0,m.sleep)(60*t*1e3),console.log("start6",e),void v(e)}if("halted"===t)return void(0,s.CONSOLE_MESSAGE)("halted");if(window.messagesSent>1&&window.messagesSent%20==0){const e=(new Date).getTime()+60*a.delayPerXMessages*1e3;(0,s.CONSOLE_MESSAGE)("timeout",{message:"20 messages has been sent",hh:moment(e).format("HH"),mm:moment(e).format("mm"),ss:moment(e).format("ss")}),await(0,m.sleep)(60*a.delayPerXMessages*1e3)}}}finally{}}},7367:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getStats:()=>o,stats:()=>s});var i=n(9171),a=n(4484);function s(){const e=new Date,t=`${e.getFullYear()}${e.getMonth()+1}${e.getDate()}`;let n=localStorage.getItem(`stats_${t}`);function a(){localStorage.setItem(`stats_${t}`,JSON.stringify(n))}return n=n?JSON.parse(n):{},{addOffer:()=>{const e="offers";n[e]||(n[e]=0),n[e]+=1,a(),document.getElementById("stat_offers").textContent=n[e],(0,i._)({offers:n[e]}),s().addNewListings()},addSkipped:e=>{void 0===e&&(e=1);const t="skipped";n[t]||(n[t]=0),n[t]+=e,a(),document.getElementById(`stat_${t}`).textContent=n[t],(0,i._)({skipped:n[t]}),s().addNewListings(e)},addPartner:()=>{const e="partners";n[e]||(n[e]=0),n[e]+=1,a(),document.getElementById(`stat_${e}`).textContent=n[e],(0,i._)({partners:n[e]})},addRun:()=>{n.runs||(n.runs=0),n.runs+=1,a(),document.getElementById("stat_runs").textContent=n.runs,(0,i._)({runs:n.runs})},addStreak:()=>{window.iStreaks+=1,document.getElementById("stat_streaks").textContent=window.iStreaks,(0,i._)({streaks:window.iStreaks})},addKo:()=>{n.ko||(n.ko=0),n.ko+=1,a();const e=document.getElementById("stat_ko");e&&(e.textContent=n.ko),(0,i._)({KO:n.ko})},resetCurrentStreak:()=>{window.iStreaks=0,document.getElementById("stat_streaks").textContent=window.iStreaks,(0,i._)({streaks:0})},addTotalListingsScraped:e=>{const t="scraped";n[t]||(n[t]=0),n[t]+=e.length,a(),document.getElementById(`stat_${t}`).textContent=n[t],(0,i._)({listings_scraped:n[t]})},setThreadsCount:e=>{const t="num_threads";n[t]=e,a(),(0,i._)({num_threads:n[t]})},addNewListings:e=>{void 0===e&&(e=1);const t="new_listings";n[t]||(n[t]=0),n[t]+=e,a();const s=document.getElementById(`stat_${t}`);s&&(s.textContent=n[t]),(0,i._)({new_listings:n[t]})},addSingleListings:()=>{const e="single_listings";n[e]||(n[e]=0),n[e]+=1,a();const t=document.getElementById(`stat_${e}`);t&&(t.textContent=n[e]),(0,i._)({single_listings:n[e]})},addMultiListings:()=>{const e="multi_listings";n[e]||(n[e]=0),n[e]+=1,a();const t=document.getElementById(`stat_${e}`);t&&(t.textContent=n[e]),(0,i._)({multi_listings:n[e]})}}}function o(){try{const e={},t=new Date,n=`${t.getFullYear()}${t.getMonth()+1}${t.getDate()}`;let i=localStorage.getItem(`stats_${n}`);if(i){const t=["offers","partners","runs","streaks","ko"];i=JSON.parse(i),t.forEach((t=>{e[t]=i[t]||0}))}return e}catch(e){console.error(e),(0,a._apiSendBug)({error:"Failed to get stats",details:e.toString()})}}},8944:(e,t,n)=>{"use strict";n.r(t),n.d(t,{isStopAfterXMessagesReached:()=>o,stopAfterXMessages:()=>s});var i=n(1334),a=n(3539);async function s(){const e=new Date,t=`${e.getFullYear()}${e.getMonth()+1}${e.getDate()}`;let n=await(0,i.gI)(`stopAfterXMessages_${t}`);return n=n?JSON.parse(n):{},{addMessageSent:()=>{const e="messages_sent";n[e]||(n[e]=0),n[e]+=1,(0,i.Q5)(`stopAfterXMessages_${t}`,JSON.stringify(n))},getMessagesSent:()=>{const e="messages_sent";return n[e]||(n[e]=0),n[e]}}}async function o(){const e=(await s()).getMessagesSent();let t=Number(document.getElementById("stop_messaging_after").value)||0;if("TRIAL"===window.licenseMode&&(t=5),0===t)return!1;const n=e>=t;return n&&(console.log(`${"TRIAL"===window.licenseMode?"TRIAL: ":""}Stopped messaging after sending ${e} messages.`),(0,a.CONSOLE_MESSAGE)("custom",`${"TRIAL"===window.licenseMode?"TRIAL: ":""}Stopped messaging after sending ${e} messages.`)),n}},8329:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});const i=n(6503);function a(e){return{message_1:(()=>{const t=localStorage.getItem("input_message_1")||"";return e?t:i.unspin(t)})(),message_2:(()=>{const t=localStorage.getItem("input_message_2")||"";return e?t:i.unspin(t)})(),message_3:(()=>{const t=localStorage.getItem("input_message_3")||"";return e?t:i.unspin(t)})(),followup_1:(()=>{const t=localStorage.getItem("input_followup_1")||"";return e?t:i.unspin(t)})(),followup_2:(()=>{const t=localStorage.getItem("input_followup_2")||"";return e?t:i.unspin(t)})(),followup_3:(()=>{const t=localStorage.getItem("input_followup_3")||"";return e?t:i.unspin(t)})()}}},803:(e,t,n)=>{"use strict";n.r(t),n.d(t,{testTemplates:()=>o});var i=n(9107),a=n(8329),s=n(3443);function o(){const e=[];(0,s.validateSpintaxes)()&&(Object.keys((0,a.z)()).forEach((t=>{let n=(0,a.z)()[t];if(!n)return;const s={model:"IPHONE 11 PRO",storage:"64GB",network:"Unlocked",price:450,condition:"Grade A - Like New [NO cracks, scratches, scuffs or dents]",deductions:[]};try{n=(0,i.e)(n,s,"Silver",600)}catch(e){console.trace(),console.error(e)}n=`${t}: ${n}\n\n`,e.push(n)})),alert(e.join("")))}},1060:(e,t,n)=>{"use strict";function i(e){const t=localStorage.getItem("input_skipwords_title");if(t){let n=!1;if(t.split(",").map((e=>e.trim())).forEach((t=>{t&&e&&e.match(new RegExp(t,"i"))&&(n=t)})),n)return n}}function a(e){const t=localStorage.getItem("input_skipwords_description");if(t){let n=!1;if(t.split(",").map((e=>e.trim())).forEach((t=>{t&&e&&e.match(new RegExp(t,"i"))&&(n=t)})),n)return n}}n.d(t,{AP:()=>a,KI:()=>i})},7121:(e,t,n)=>{"use strict";function i(e){const t=["#keywords","#title_must_include","#zipcodes","#skipwords_title","#skipwords_description","#openermessage","#offermessage","#acceptmessage","#meetupmessage","#question_1","#question_2","#question_3","#question_4","#followup_1","#followup_2","#followup_3"];for(const n of t){let t=document.querySelector(n);t&&(t.disabled=!e,t.style.opacity=e?"1":"0.8")}}n.d(t,{X:()=>i})},3443:(e,t,n)=>{"use strict";n.r(t),n.d(t,{validateSpintaxes:()=>o});var i=n(3539),a=n(8329);const s=n(6503);function o(){const e=[];return Object.keys((0,a.z)()).forEach((t=>{const n=(0,a.z)(!0)[t];s.validate(n)||e.push(t)})),!e.length||((0,i.CONSOLE_MESSAGE)("custom","Invalid spintax detected."),alert("You have invalid spintax format in "+e.join(", ")),!1)}},3253:(e,t,n)=>{"use strict";function i(e){var t=window.addEventListener?"addEventListener":"attachEvent";(0,window[t])("attachEvent"==t?"onmessage":"message",(function(t){var n=t[t.message?"message":"data"];"login"===n?.event&&"function"==typeof e&&e(n.user)}),!1)}n.r(t),n.d(t,{waitForLogin:()=>i})},9171:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var i=n(2617);function a(){const e=new Date;return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`}var s=n(8329);async function o({offers:e,partners:t,runs:n,streaks:o,KO:r,listings_scraped:l,num_threads:d,new_listings:c,single_listings:u,multi_listings:p}){if(!window.taEmail)return;const m=document.getElementById("roundupdown").value,g=document.querySelector("#switch-skipshippingenabled").checked,h=document.getElementById("streaktimeout").value,f=document.getElementById("streak").value,_=document.querySelector("#switch-deleteaftersend").checked,y=document.querySelector("#skipwords_title").value,w=document.querySelector("#skipwords_description").value,b=document.querySelector("#ta #zipcodes").value,v=document.querySelector("#ta #keywords").value,S=document.getElementById("followup_after").value,x=document.querySelector("#runfrom").value,I=document.querySelector("#rununtil").value,k=function(){const e=new Date;let t=e.getMonth()+1;t<10&&(t=`0${t}`);let n=e.getDate();return n<10&&(n=`0${n}`),`${e.getFullYear()}-${t}-${n}`}(),E=(0,i.getUserEmail)()||window.taEmail,L=document.querySelector("#listing_min_price").value,T=document.querySelector("#listing_max_price").value,A=(0,s.z)().message_1,M=(0,s.z)().message_2,O=(0,s.z)().message_3,F={key:E,partner_email:window.taEmail,date:k,version:window.extension_version};void 0!==e&&(F.offers=e),void 0!==t&&(F.partners=t),void 0!==n&&(F.runs=n),void 0!==o&&(F.streaks=o),void 0!==r&&(F.KO=r),void 0!==x&&(F["run from"]=x),void 0!==I&&(F.until=I),void 0!==m&&(F.rounding=m),void 0!==g&&(F["skip shipping"]=g),void 0!==f&&(F["max streak"]=f),void 0!==h&&(F.timeout=h),void 0!==l&&(F.listings_scraped=l),void 0!==S&&(F.followup_after=S),void 0!==_&&(F["delete after sending"]=_),void 0!==y&&(F.skipwords_title=y),void 0!==w&&(F.skipwords_description=w),void 0!==b&&(F.zipcodes=b),void 0!==v&&(F.keywords=v),void 0!==d&&(F["threads inbox"]=d),void 0!==c&&(F["New Listings"]=c),void 0!==u&&(F["Single Listings"]=u),void 0!==p&&(F["Multi Listings"]=p),void 0!==L&&(F["Price Min"]=L),void 0!==T&&(F["Price Max"]=T),F.template_message_1=A||"",F.template_message_2=M||"",F.template_message_3=O||"",function(){const e=(new Date).getTime();let t=localStorage.getItem("runtimeHits");if(t){t=JSON.parse(t);const i=t[t.length-1];n=i,Date.now()-n>=6e5&&(t.push(e),e-i<12e5&&function(){const e=a();let t=localStorage.getItem("runTimePerDay");t?(t=JSON.parse(t),t[e]||(t={},t[e]=0),t[e]=parseInt(t[e])+1):t={[e]:1},localStorage.setItem("runTimePerDay",JSON.stringify(t))}())}else t=[],t.push(e);var n;localStorage.setItem("runtimeHits",JSON.stringify(t))}(),F.runtime_points=function(){let e=localStorage.getItem("runTimePerDay");if(e){const t=a();return e=JSON.parse(e),e[t]?e[t]:0}return 0}(),window.writeQueue||(window.writeQueue=[]),window.writeQueue.push(F)}},6503:(e,t,n)=>{e.exports=n(9819)},9819:(e,t)=>{!function(e){e.isSpintax=function(e){return null!==e.match(/\{[^}]*\|*[^}]*\}/)},e.findSpintax=function(e){return e.match(/\{([^{}]+?)\}/)},e.unspin=function(t,n){for(var i,a,s,o=t,r=0;e.isSpintax(t);){if(r>=1e3)throw new Error("Unable unspin text after 1000 iterations ("+o+")");s=(a=(i=e.findSpintax(t))[1].split("|"))[Math.floor((n||Math.random)()*a.length)],t=t.replace(i[0],s),r++}return t},e.count=function(t){for(var n,i,a,s,o,r=0,l=/%%%\d+%%%/g,d=/%%%(\d+)%%%/,c=t,u=0;e.isSpintax(t);){if(u>=1e3)throw new Error("Unable unspin text after 1000 iterations ("+c+")");for(i=(n=e.findSpintax(t))[1].split("|"),a=0,o=0;o<i.length;o++)i[o].match(l)?a+=parseInt(i[o].match(d)[1])||1:a+=1;t=t.replace(n[0],"%%%N%%%".replace("N",a.toString())),u++}if(t.match(l))for(s=t.match(l),r=1,o=0;o<s.length;o++)r*=parseInt(s[o].match(d)[1])||1;return r},e.validate=function(t){return null===(t=e.unspin(t)).match(/(\{[^}]*\|)|(\|[^{]*\})/)}}(t)},127:(e,t)=>{t.viewModeCheck=function(){window.location.href.match("/inbox|inbox/message")&&(window.viewermode=!0)}},4147:e=>{"use strict";e.exports=JSON.parse('{"name":"offerup-bot","version":"24.1127.737","description":"","main":"contentscript.js","dependencies":{"acorn":"^8.8.1","graceful-fs":"^4.2.10","javascript-obfuscator":"^4.0.0","mel-spintax":"^1.0.4","path":"^0.12.7","webpack-cli":"^4.9.2"},"scripts":{"build":"npm run version_update && webpack && node ./generateScript.js","version_update_old":"npm version patch --no-git-tag-version","version_update":"node ./version_updater.js","debug":"node debugger.js","test":"echo \\"Error: no test specified\\" && exit 1","lint":"eslint --init","deploy-traderonly":"surge dist/"},"repository":{"type":"git","url":"git+ssh://git@bitbucket.org/hopla-tools/offerupbot.git"},"author":"Silver Serate","license":"ISC","homepage":"https://bitbucket.org/hopla-tools/offerupbot#readme","devDependencies":{"eslint":"^7.32.0","source-map":"^0.7.4","webpack":"^5.74.0","webpack-obfuscator":"^3.5.1"}}')}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{if(window.isAlreadyInjected)throw new Error("Marketplace Bot is already injected to this page.");window.isAlreadyInjected=!0;const{addAllUserListingsToSkipList:e}=n(9088),{apiOfferUp:t}=n(9217),{attachEvents:i}=n(8809),{showAlerts:a}=n(1203),{fetchListingDetail:s}=n(4347),{generateId:o}=n(3372),{getConsoleMessages:r,CONSOLE_MESSAGE:l}=n(3539),{getPartnerDetails:d}=n(8414),{getQuote:c}=n(2646),{getVariant:u}=n(5458),{default:p}=n(3119),{handleFetchErrors:m}=n(2287),{injectHoplaLogin:g}=n(6722),{injectLogger:h}=n(7731),{injectMdl:f}=n(4559),{injectMoment:_}=n(3695),{injectStyle:y}=n(5729),{injectTrackjs:w}=n(7933),{insertUI:b}=n(642),{isInjectedToOtherTab:v}=n(5779),{isShippingEnabled:S}=n(9632),{loadInputs:x}=n(5489),{loadStats:I}=n(4219),{logout:k}=n(1992),{onSessionReady:E,login_callback:L}=n(2425),{prefix:T}=n(7850),{processKeyword:A}=n(4227),{processWriteQueue:M}=n(4053),{restoreDefaults:O}=n(1063),{retryDelayWithMessage:F}=n(425),{showLoading:N}=n(1023),{skips:C}=n(3613),{sleep:D}=n(4246),{start:j}=n(2572),{stats:q}=n(7367),{testTemplates:R}=n(803),{_apiSendBug:$}=n(4484),{viewModeCheck:P}=n(127),{sendMessage:U}=n(7164),{getUserEmail:B}=n(2617),{searchCategory:G}=n(4252),{followup:H}=n(6198),{validateSpintaxes:W}=n(3443),{randomIntFromInterval:X}=n(3177),{setupGlobalErrorHandlers:J}=n(2497),{waitForLogin:z}=n(3253),{version:V}=n(4147),{isStopAfterXMessagesReached:Z,stopAfterXMessages:K}=n(8944),{getOpenAIApiKey:Q}=n(9309);window.sleep=D,unsafeWindow.getUserEmail=B,unsafeWindow.searchCategory=G,unsafeWindow.fetchListingDetail=s,unsafeWindow.followup=H,unsafeWindow.validateSpintaxes=W,unsafeWindow.randomIntFromInterval=X,unsafeWindow.isStopAfterXMessagesReached=Z,unsafeWindow.stopAfterXMessages=K,(async()=>{window.extension_version=V,window.messagesSent=0,window.iStreaks=0,window.isRun=0,window.isViewMode=!0,window.tabId=Math.round(1e4*Math.random()),window.textMatchIndex={},window.isEnterprise=!1,window.bugReport={},window.isKO=!1,window.storeFirebaseLog=async function(e,t){return async function n(i){return fetch("https://us-central1-trade-apples.cloudfunctions.net/sendlog",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({logType:"offerup",ts:t||"",log:e})}).then((async e=>m(e))).then((e=>e.text())).catch((async e=>(console.error("Fetch Failed (storeFirebaseLog)",e,i),i&&i>6?"":(await D(1e4),i||(i=0),n(i+=1)))))}().catch((e=>(console.error("Fetch Failed (storeFirebaseLog)",e),"")))},window.testTemplates=R,window.restoreDefaults=O,window.prefix=T,unsafeWindow.apiOfferUp=t,window.skips=C,window.fetchListingDetail=s,window.processKeyword=A,window.addAllUserListingsToSkipList=e,window.CONSOLE_MESSAGE=l,window.getConsoleMessages=r,window.getVariant=u,window.getQuote=c,window.showLoading=N,window.login_callback=L,window.getPartnerDetails=d,window.hopla_logout=k,window.isShippingEnabled=S,window.sendMessage=U,unsafeWindow.apiOfferUp=t,unsafeWindow.getUserEmail=B,window.tester=function(){};let n=!1;if(await v())return console.error("Offerup Bot is already inject in another tab."),void alert("Offerup Bot is already inject in another tab.");console.log(`Marketplace Bot Version ${window.extension_version}`);try{!function(){"use strict";a&&alert("Offerup Bot has been injected!"),window.addEventListener("online",(()=>{n=!1,console.log("You are back online!"),setTimeout((()=>{if(document.querySelector("#statustext"),document.querySelector("#switch-rununtil")&&document.querySelector("#switch-rununtil").checked){console.log("Will restart bot.");const e=o();window.runningInstanceId=e,j(e)}}),1e4)})),window.addEventListener("offline",(async()=>{for(n=!0,console.log("You are offline.");n;)await t(1e3)}));try{e()}catch(e){console.error("Bot crashed. offline",e),$({error:"Found error in the bot.",info:e.toString()})}async function e(){J(),y(),_(),w(),await r(),b(),Q(),f(),x(),z(E)}function t(e){return new Promise((t=>setTimeout(t,e)))}window.main=e,window.start=j}()}catch(e){console.trace(),console.error("caught error",e),console.log("Caught error. Will restart bot."),$({error:"Found error in the bot.",info:e.toString()})}})()})()})();



})();